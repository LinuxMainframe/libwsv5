\hypertarget{library_8c}{}\doxysection{library.\+c File Reference}
\label{library_8c}\index{library.c@{library.c}}
{\ttfamily \#include \char`\"{}library.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include $<$pthread.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$stdarg.\+h$>$}\newline
{\ttfamily \#include $<$sys/socket.\+h$>$}\newline
{\ttfamily \#include $<$sys/select.\+h$>$}\newline
{\ttfamily \#include $<$netinet/in.\+h$>$}\newline
{\ttfamily \#include $<$arpa/inet.\+h$>$}\newline
{\ttfamily \#include $<$netdb.\+h$>$}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$poll.\+h$>$}\newline
{\ttfamily \#include $<$libwebsockets.\+h$>$}\newline
{\ttfamily \#include $<$openssl/sha.\+h$>$}\newline
{\ttfamily \#include $<$openssl/evp.\+h$>$}\newline
{\ttfamily \#include $<$openssl/bio.\+h$>$}\newline
{\ttfamily \#include $<$openssl/buffer.\+h$>$}\newline
{\ttfamily \#include $<$cjson/c\+JSON.\+h$>$}\newline
Include dependency graph for library.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/da8/library_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structpending__request}{pending\+\_\+request}}
\item 
struct \mbox{\hyperlink{structobsws__connection}{obsws\+\_\+connection}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{library_8c_a3024ccd4a9af5109d24e6c57565d74a1}{\+\_\+\+POSIX\+\_\+\+C\+\_\+\+SOURCE}}~200809L
\item 
\#define \mbox{\hyperlink{library_8c_ad27c3919151c76f6e69c502c7ece4065}{OBSWS\+\_\+\+VERSION}}~\char`\"{}1.\+0.\+0\char`\"{}                   /$\ast$ Library version string $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_af132d6e679351e32e25e03f0446b9a79}{OBSWS\+\_\+\+PROTOCOL\+\_\+\+VERSION}}~1                /$\ast$ OBS Web\+Socket protocol version (v5 uses RPC version 1) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a665c5272405e81329a26d2db1a7d5d97}{OBSWS\+\_\+\+DEFAULT\+\_\+\+BUFFER\+\_\+\+SIZE}}~65536         /$\ast$ 64KB buffer for Web\+Socket messages $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_ad466175cd00abd451ceb9a2c4c82a355}{OBSWS\+\_\+\+MAX\+\_\+\+PENDING\+\_\+\+REQUESTS}}~256
\item 
\#define \mbox{\hyperlink{library_8c_a25b13264018fd1dc7b1f2bbd93bdc7cc}{OBSWS\+\_\+\+UUID\+\_\+\+LENGTH}}~37
\item 
\#define \mbox{\hyperlink{library_8c_a28228f50fc25972b87ebb3c5ca36104a}{OBSWS\+\_\+\+OPCODE\+\_\+\+HELLO}}~0                    /$\ast$ Server\+: Initial greeting with auth info $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a9ac9adf7323ec0e886fa7294ef8c387c}{OBSWS\+\_\+\+OPCODE\+\_\+\+IDENTIFY}}~1                 /$\ast$ Client\+: Authentication and protocol agreement $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a35815ef87e52f4956dcc02be7a3a7d95}{OBSWS\+\_\+\+OPCODE\+\_\+\+IDENTIFIED}}~2               /$\ast$ Server\+: Auth successful, ready for commands $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_aca6d50cc88d56174d2cd1ba02b98a02e}{OBSWS\+\_\+\+OPCODE\+\_\+\+REIDENTIFY}}~3               /$\ast$ Client\+: Re-\/authenticate after reconnect $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a60741575bd0daca62cfc088a7d3908c6}{OBSWS\+\_\+\+OPCODE\+\_\+\+EVENT}}~5                    /$\ast$ Server\+: Something happened in OBS $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a6c2c324c3b2c49b7febe0b376d6c1045}{OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST}}~6                  /$\ast$ Client\+: Execute an operation in OBS $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_ae6ce9e236045c545c7786292abb8bed2}{OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST\+\_\+\+RESPONSE}}~7         /$\ast$ Server\+: Result of a client request $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_ae139b9522240dea875467adad42804ed}{OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST\+\_\+\+BATCH}}~8            /$\ast$ Client\+: Multiple requests at once (unused) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a4d2cda5fb13a230acc6a977ec4f1b99c}{OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST\+\_\+\+BATCH\+\_\+\+RESPONSE}}~9   /$\ast$ Server\+: Responses to batch (unused) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_af3122cbbc4a26632925db9b9ed14de9d}{OBSWS\+\_\+\+EVENT\+\_\+\+GENERAL}}~(1 $<$$<$ 0)        /$\ast$ General OBS events (startup, shutdown) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_ac8ac38fd80c288fe304251a707957d43}{OBSWS\+\_\+\+EVENT\+\_\+\+CONFIG}}~(1 $<$$<$ 1)         /$\ast$ Configuration change events $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_abcabd4a44ea5f015970b39563cb2f5d9}{OBSWS\+\_\+\+EVENT\+\_\+\+SCENES}}~(1 $<$$<$ 2)         /$\ast$ Scene-\/related events (scene switched, etc) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a34d42f737fdba0a16d9db361107d4ccf}{OBSWS\+\_\+\+EVENT\+\_\+\+INPUTS}}~(1 $<$$<$ 3)         /$\ast$ Input source events (muted, volume changed) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a6bb991cf70fbb060bbf2577c00a1e525}{OBSWS\+\_\+\+EVENT\+\_\+\+TRANSITIONS}}~(1 $<$$<$ 4)    /$\ast$ Transition events (transition started) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a845a57bdbd1f3308da42b51d1e0cc074}{OBSWS\+\_\+\+EVENT\+\_\+\+FILTERS}}~(1 $<$$<$ 5)        /$\ast$ Filter events (filter added, removed) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a4e2ef7f5c168273a4af4fc255189d007}{OBSWS\+\_\+\+EVENT\+\_\+\+OUTPUTS}}~(1 $<$$<$ 6)        /$\ast$ Output events (recording started, streaming stopped) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a968abe18bf7a7df97110b636dab78710}{OBSWS\+\_\+\+EVENT\+\_\+\+SCENE\+\_\+\+ITEMS}}~(1 $<$$<$ 7)    /$\ast$ Scene item events (source added to scene) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a9dd53c6b169bf03951321c0635a865a8}{OBSWS\+\_\+\+EVENT\+\_\+\+MEDIA\+\_\+\+INPUTS}}~(1 $<$$<$ 8)   /$\ast$ Media playback events (media finished) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_af20dd880c769d5a295f408d7ba3a4878}{OBSWS\+\_\+\+EVENT\+\_\+\+VENDORS}}~(1 $<$$<$ 9)        /$\ast$ Vendor-\/specific extensions $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a269a8756f372f31aab63847a67a1f448}{OBSWS\+\_\+\+EVENT\+\_\+\+UI}}~(1 $<$$<$ 10)            /$\ast$ UI events (Studio Mode toggled) $\ast$/
\item 
\#define \mbox{\hyperlink{library_8c_a22c0214b5dafa0c23d7c7fe4c0686f7c}{OBSWS\+\_\+\+EVENT\+\_\+\+ALL}}~0x7\+FF               /$\ast$ Subscribe to all event types $\ast$/
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structpending__request}{pending\+\_\+request}} \mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\+\_\+log}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9}{obsws\+\_\+log\+\_\+level\+\_\+t}} level, const char $\ast$format,...)
\item 
static void \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\+\_\+debug}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}} min\+\_\+level, const char $\ast$format,...)
\item 
static void \mbox{\hyperlink{library_8c_af79be0fed07182761c923170f4211089}{generate\+\_\+uuid}} (char $\ast$uuid\+\_\+out)
\item 
static char $\ast$ \mbox{\hyperlink{library_8c_aab5c2995d6518ef254538795c00afdbb}{base64\+\_\+encode}} (const unsigned char $\ast$input, size\+\_\+t length)
\item 
static void \mbox{\hyperlink{library_8c_aaaa872a3d93d0ce3d5d4346f4b1c763e}{sha256\+\_\+hash}} (const char $\ast$input, unsigned char $\ast$output)
\item 
static char $\ast$ \mbox{\hyperlink{library_8c_acab761db577bf6b074b4e9be8be845b5}{generate\+\_\+auth\+\_\+response}} (const char $\ast$password, const char $\ast$salt, const char $\ast$challenge)
\item 
static void \mbox{\hyperlink{library_8c_a2f13308e49322d01e479cbe14da7b575}{set\+\_\+connection\+\_\+state}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\+\_\+state\+\_\+t}} new\+\_\+state)
\item 
static \mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}} $\ast$ \mbox{\hyperlink{library_8c_aafc3d1ce3debddcb8e3888c9806e044a}{create\+\_\+pending\+\_\+request}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, const char $\ast$request\+\_\+id)
\item 
static \mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}} $\ast$ \mbox{\hyperlink{library_8c_a6f7f5f47389b537c9dce9f1b328b7f06}{find\+\_\+pending\+\_\+request}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, const char $\ast$request\+\_\+id)
\item 
static void \mbox{\hyperlink{library_8c_a700c8a9baa87a3827b399776e811f328}{remove\+\_\+pending\+\_\+request}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}} $\ast$target)
\item 
static void \mbox{\hyperlink{library_8c_a885f22656ee8ca3170a50df0e0d85a4d}{cleanup\+\_\+old\+\_\+requests}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn)
\item 
static int \mbox{\hyperlink{library_8c_af183411517ec69b1d59f875fbb0245bd}{handle\+\_\+hello\+\_\+message}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, c\+JSON $\ast$data)
\begin{DoxyCompactList}\small\item\em Handle the initial HELLO handshake message from OBS. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{library_8c_aad4174fe2c4665d21ae49896fc25be9e}{handle\+\_\+identified\+\_\+message}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, c\+JSON $\ast$data)
\begin{DoxyCompactList}\small\item\em Handle the IDENTIFIED confirmation message from OBS. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{library_8c_ac7c18bfa245d7a8582c6e5536cf46532}{handle\+\_\+event\+\_\+message}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, c\+JSON $\ast$data)
\begin{DoxyCompactList}\small\item\em Handle EVENT messages from OBS (real-\/time notifications). \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{library_8c_a046a86e7ba13a054663021594755d54b}{handle\+\_\+request\+\_\+response\+\_\+message}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, c\+JSON $\ast$data)
\begin{DoxyCompactList}\small\item\em Handle REQUEST\+\_\+\+RESPONSE messages from OBS (responses to our commands). \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{library_8c_a0672da971c7e38224df11c34ef612f02}{handle\+\_\+websocket\+\_\+message}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, const char $\ast$message, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Route incoming Web\+Socket messages to appropriate handlers based on opcode. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{library_8c_ac5c31c457dc3042f85a620d7998ebeee}{lws\+\_\+callback}} (struct lws $\ast$wsi, enum lws\+\_\+callback\+\_\+reasons reason, void $\ast$user, void $\ast$in, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em libwebsockets callback -\/ routes Web\+Socket events to our handlers. \end{DoxyCompactList}\item 
static void $\ast$ \mbox{\hyperlink{library_8c_a27739efcea1287611c82ff3e8c88d7b7}{event\+\_\+thread\+\_\+func}} (void $\ast$arg)
\begin{DoxyCompactList}\small\item\em Background thread function that continuously processes Web\+Socket events. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_aff3d6c035330741df84552800c0d0124}{obsws\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em Initialize the libwsv5 library. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{library_8c_ad3afe1c77e8b8f26a8281186379790a1}{obsws\+\_\+cleanup}} (void)
\begin{DoxyCompactList}\small\item\em Clean up library resources. \end{DoxyCompactList}\item 
const char $\ast$ \mbox{\hyperlink{library_8c_af3afc203f99395c187faf3fba0477bf9}{obsws\+\_\+version}} (void)
\begin{DoxyCompactList}\small\item\em Get the library version string. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{library_8c_a6720460e577d2afe3c0691a2d6e055e9}{obsws\+\_\+set\+\_\+log\+\_\+level}} (\mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9}{obsws\+\_\+log\+\_\+level\+\_\+t}} level)
\begin{DoxyCompactList}\small\item\em Set the global log level threshold. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{library_8c_adde8bcb270d34f560ae99047e0524a1d}{obsws\+\_\+set\+\_\+debug\+\_\+level}} (\mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}} level)
\begin{DoxyCompactList}\small\item\em Set the global debug level. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}} \mbox{\hyperlink{library_8c_a17d68299d8070c22f5cb04e2c4af28a1}{obsws\+\_\+get\+\_\+debug\+\_\+level}} (void)
\begin{DoxyCompactList}\small\item\em Get the current debug level. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{library_8c_a1f1c69172bbf706ac225b718797d30c6}{obsws\+\_\+config\+\_\+init}} (\mbox{\hyperlink{structobsws__config__t}{obsws\+\_\+config\+\_\+t}} $\ast$config)
\begin{DoxyCompactList}\small\item\em Initialize a connection configuration structure with safe defaults. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$ \mbox{\hyperlink{library_8c_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect}} (const \mbox{\hyperlink{structobsws__config__t}{obsws\+\_\+config\+\_\+t}} $\ast$config)
\begin{DoxyCompactList}\small\item\em Establish a connection to OBS. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{library_8c_aa8389ba6731e01a9426bd921180b7195}{obsws\+\_\+disconnect}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn)
\begin{DoxyCompactList}\small\item\em Disconnect from OBS and clean up connection resources. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{library_8c_ad9894e72ee8510f4eaf7d42feaf0cf9a}{obsws\+\_\+is\+\_\+connected}} (const \mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn)
\begin{DoxyCompactList}\small\item\em Check if a connection is actively connected to OBS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\+\_\+state\+\_\+t}} \mbox{\hyperlink{library_8c_a61a10e31041532a9da0c1c1993f84a79}{obsws\+\_\+get\+\_\+state}} (const \mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn)
\begin{DoxyCompactList}\small\item\em Get the current connection state. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_a5cce41cb6c70229eaab8b1b3afba57a9}{obsws\+\_\+get\+\_\+stats}} (const \mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{structobsws__stats__t}{obsws\+\_\+stats\+\_\+t}} $\ast$stats)
\begin{DoxyCompactList}\small\item\em Retrieve performance and connectivity statistics. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, const char $\ast$request\+\_\+type, const char $\ast$request\+\_\+data, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$response, uint32\+\_\+t timeout\+\_\+ms)
\begin{DoxyCompactList}\small\item\em Send a synchronous request to OBS and wait for the response. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_a7cb91bbce42b458f267f79b9a7b293bf}{obsws\+\_\+set\+\_\+current\+\_\+scene}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, const char $\ast$scene\+\_\+name, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$response)
\begin{DoxyCompactList}\small\item\em Switch OBS to a specific scene. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_a91bd5ceb5878431131513cb4624e935a}{obsws\+\_\+get\+\_\+current\+\_\+scene}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, char $\ast$scene\+\_\+name, size\+\_\+t buffer\+\_\+size)
\begin{DoxyCompactList}\small\item\em Query the currently active scene in OBS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_a8643e2027afb1907122ce4d3bfe65c6e}{obsws\+\_\+start\+\_\+recording}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$response)
\begin{DoxyCompactList}\small\item\em Start recording in OBS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_a30001811f4cf8501e006ca46bcb8b329}{obsws\+\_\+stop\+\_\+recording}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$response)
\begin{DoxyCompactList}\small\item\em Stop recording in OBS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_a86a35ee2d7aef7a0569b4111bd663d22}{obsws\+\_\+start\+\_\+streaming}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$response)
\begin{DoxyCompactList}\small\item\em Start streaming in OBS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} \mbox{\hyperlink{library_8c_a2cfe9b46f435aa7986b5e772b99c464e}{obsws\+\_\+stop\+\_\+streaming}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$response)
\begin{DoxyCompactList}\small\item\em Stop streaming in OBS. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free}} (\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$response)
\begin{DoxyCompactList}\small\item\em Free a response object previously allocated by \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}}. \end{DoxyCompactList}\item 
const char $\ast$ \mbox{\hyperlink{library_8c_a39534944f30eaed9a0f2d7de19be0c3e}{obsws\+\_\+error\+\_\+string}} (\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} error)
\begin{DoxyCompactList}\small\item\em Convert an error code to a human-\/readable string. \end{DoxyCompactList}\item 
const char $\ast$ \mbox{\hyperlink{library_8c_a69f8fcc1732533a2ebe573ac65effa04}{obsws\+\_\+state\+\_\+string}} (\mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\+\_\+state\+\_\+t}} state)
\begin{DoxyCompactList}\small\item\em Convert a connection state to a human-\/readable string. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{library_8c_abe53062a781ca1cd537f799c075b3e2e}{obsws\+\_\+process\+\_\+events}} (\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$conn, uint32\+\_\+t timeout\+\_\+ms)
\begin{DoxyCompactList}\small\item\em Process pending Web\+Socket events (compatibility function). \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static bool \mbox{\hyperlink{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}{g\+\_\+library\+\_\+initialized}} = false
\item 
static \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9}{obsws\+\_\+log\+\_\+level\+\_\+t}} \mbox{\hyperlink{library_8c_abaccf3944be55af2f72ebbb713c77706}{g\+\_\+log\+\_\+level}} = \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\+\_\+\+LOG\+\_\+\+INFO}}
\item 
static \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}} \mbox{\hyperlink{library_8c_abf3a9f2c8c4082f1e6b67daddd8a5931}{g\+\_\+debug\+\_\+level}} = \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668a0f96dd454f8efb9a755ebda2e81919aa}{OBSWS\+\_\+\+DEBUG\+\_\+\+NONE}}
\item 
static pthread\+\_\+mutex\+\_\+t \mbox{\hyperlink{library_8c_ad5f633670e2eea3285c1867570a33cbc}{g\+\_\+init\+\_\+mutex}} = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER
\item 
static const struct lws\+\_\+protocols \mbox{\hyperlink{library_8c_ad34f3c7a416fe0d9311efdc5715410e1}{protocols}} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{library_8c_a3024ccd4a9af5109d24e6c57565d74a1}\label{library_8c_a3024ccd4a9af5109d24e6c57565d74a1}} 
\index{library.c@{library.c}!\_POSIX\_C\_SOURCE@{\_POSIX\_C\_SOURCE}}
\index{\_POSIX\_C\_SOURCE@{\_POSIX\_C\_SOURCE}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{\_POSIX\_C\_SOURCE}{\_POSIX\_C\_SOURCE}}
{\footnotesize\ttfamily \#define \+\_\+\+POSIX\+\_\+\+C\+\_\+\+SOURCE~200809L}



Definition at line \mbox{\hyperlink{library_8c_source_l00001}{1}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a665c5272405e81329a26d2db1a7d5d97}\label{library_8c_a665c5272405e81329a26d2db1a7d5d97}} 
\index{library.c@{library.c}!OBSWS\_DEFAULT\_BUFFER\_SIZE@{OBSWS\_DEFAULT\_BUFFER\_SIZE}}
\index{OBSWS\_DEFAULT\_BUFFER\_SIZE@{OBSWS\_DEFAULT\_BUFFER\_SIZE}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_DEFAULT\_BUFFER\_SIZE}{OBSWS\_DEFAULT\_BUFFER\_SIZE}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+DEFAULT\+\_\+\+BUFFER\+\_\+\+SIZE~65536         /$\ast$ 64KB buffer for Web\+Socket messages $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00039}{39}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a22c0214b5dafa0c23d7c7fe4c0686f7c}\label{library_8c_a22c0214b5dafa0c23d7c7fe4c0686f7c}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_ALL@{OBSWS\_EVENT\_ALL}}
\index{OBSWS\_EVENT\_ALL@{OBSWS\_EVENT\_ALL}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_ALL}{OBSWS\_EVENT\_ALL}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+ALL~0x7\+FF               /$\ast$ Subscribe to all event types $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00101}{101}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_ac8ac38fd80c288fe304251a707957d43}\label{library_8c_ac8ac38fd80c288fe304251a707957d43}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_CONFIG@{OBSWS\_EVENT\_CONFIG}}
\index{OBSWS\_EVENT\_CONFIG@{OBSWS\_EVENT\_CONFIG}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_CONFIG}{OBSWS\_EVENT\_CONFIG}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+CONFIG~(1 $<$$<$ 1)         /$\ast$ Configuration change events $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00091}{91}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a845a57bdbd1f3308da42b51d1e0cc074}\label{library_8c_a845a57bdbd1f3308da42b51d1e0cc074}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_FILTERS@{OBSWS\_EVENT\_FILTERS}}
\index{OBSWS\_EVENT\_FILTERS@{OBSWS\_EVENT\_FILTERS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_FILTERS}{OBSWS\_EVENT\_FILTERS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+FILTERS~(1 $<$$<$ 5)        /$\ast$ Filter events (filter added, removed) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00095}{95}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_af3122cbbc4a26632925db9b9ed14de9d}\label{library_8c_af3122cbbc4a26632925db9b9ed14de9d}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_GENERAL@{OBSWS\_EVENT\_GENERAL}}
\index{OBSWS\_EVENT\_GENERAL@{OBSWS\_EVENT\_GENERAL}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_GENERAL}{OBSWS\_EVENT\_GENERAL}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+GENERAL~(1 $<$$<$ 0)        /$\ast$ General OBS events (startup, shutdown) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00090}{90}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a34d42f737fdba0a16d9db361107d4ccf}\label{library_8c_a34d42f737fdba0a16d9db361107d4ccf}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_INPUTS@{OBSWS\_EVENT\_INPUTS}}
\index{OBSWS\_EVENT\_INPUTS@{OBSWS\_EVENT\_INPUTS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_INPUTS}{OBSWS\_EVENT\_INPUTS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+INPUTS~(1 $<$$<$ 3)         /$\ast$ Input source events (muted, volume changed) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00093}{93}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a9dd53c6b169bf03951321c0635a865a8}\label{library_8c_a9dd53c6b169bf03951321c0635a865a8}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_MEDIA\_INPUTS@{OBSWS\_EVENT\_MEDIA\_INPUTS}}
\index{OBSWS\_EVENT\_MEDIA\_INPUTS@{OBSWS\_EVENT\_MEDIA\_INPUTS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_MEDIA\_INPUTS}{OBSWS\_EVENT\_MEDIA\_INPUTS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+MEDIA\+\_\+\+INPUTS~(1 $<$$<$ 8)   /$\ast$ Media playback events (media finished) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00098}{98}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a4e2ef7f5c168273a4af4fc255189d007}\label{library_8c_a4e2ef7f5c168273a4af4fc255189d007}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_OUTPUTS@{OBSWS\_EVENT\_OUTPUTS}}
\index{OBSWS\_EVENT\_OUTPUTS@{OBSWS\_EVENT\_OUTPUTS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_OUTPUTS}{OBSWS\_EVENT\_OUTPUTS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+OUTPUTS~(1 $<$$<$ 6)        /$\ast$ Output events (recording started, streaming stopped) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00096}{96}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a968abe18bf7a7df97110b636dab78710}\label{library_8c_a968abe18bf7a7df97110b636dab78710}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_SCENE\_ITEMS@{OBSWS\_EVENT\_SCENE\_ITEMS}}
\index{OBSWS\_EVENT\_SCENE\_ITEMS@{OBSWS\_EVENT\_SCENE\_ITEMS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_SCENE\_ITEMS}{OBSWS\_EVENT\_SCENE\_ITEMS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+SCENE\+\_\+\+ITEMS~(1 $<$$<$ 7)    /$\ast$ Scene item events (source added to scene) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00097}{97}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_abcabd4a44ea5f015970b39563cb2f5d9}\label{library_8c_abcabd4a44ea5f015970b39563cb2f5d9}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_SCENES@{OBSWS\_EVENT\_SCENES}}
\index{OBSWS\_EVENT\_SCENES@{OBSWS\_EVENT\_SCENES}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_SCENES}{OBSWS\_EVENT\_SCENES}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+SCENES~(1 $<$$<$ 2)         /$\ast$ Scene-\/related events (scene switched, etc) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00092}{92}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a6bb991cf70fbb060bbf2577c00a1e525}\label{library_8c_a6bb991cf70fbb060bbf2577c00a1e525}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_TRANSITIONS@{OBSWS\_EVENT\_TRANSITIONS}}
\index{OBSWS\_EVENT\_TRANSITIONS@{OBSWS\_EVENT\_TRANSITIONS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_TRANSITIONS}{OBSWS\_EVENT\_TRANSITIONS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+TRANSITIONS~(1 $<$$<$ 4)    /$\ast$ Transition events (transition started) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00094}{94}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a269a8756f372f31aab63847a67a1f448}\label{library_8c_a269a8756f372f31aab63847a67a1f448}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_UI@{OBSWS\_EVENT\_UI}}
\index{OBSWS\_EVENT\_UI@{OBSWS\_EVENT\_UI}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_UI}{OBSWS\_EVENT\_UI}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+UI~(1 $<$$<$ 10)            /$\ast$ UI events (Studio Mode toggled) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00100}{100}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_af20dd880c769d5a295f408d7ba3a4878}\label{library_8c_af20dd880c769d5a295f408d7ba3a4878}} 
\index{library.c@{library.c}!OBSWS\_EVENT\_VENDORS@{OBSWS\_EVENT\_VENDORS}}
\index{OBSWS\_EVENT\_VENDORS@{OBSWS\_EVENT\_VENDORS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_EVENT\_VENDORS}{OBSWS\_EVENT\_VENDORS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+EVENT\+\_\+\+VENDORS~(1 $<$$<$ 9)        /$\ast$ Vendor-\/specific extensions $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00099}{99}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_ad466175cd00abd451ceb9a2c4c82a355}\label{library_8c_ad466175cd00abd451ceb9a2c4c82a355}} 
\index{library.c@{library.c}!OBSWS\_MAX\_PENDING\_REQUESTS@{OBSWS\_MAX\_PENDING\_REQUESTS}}
\index{OBSWS\_MAX\_PENDING\_REQUESTS@{OBSWS\_MAX\_PENDING\_REQUESTS}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_MAX\_PENDING\_REQUESTS}{OBSWS\_MAX\_PENDING\_REQUESTS}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+MAX\+\_\+\+PENDING\+\_\+\+REQUESTS~256}



Definition at line \mbox{\hyperlink{library_8c_source_l00045}{45}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a60741575bd0daca62cfc088a7d3908c6}\label{library_8c_a60741575bd0daca62cfc088a7d3908c6}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_EVENT@{OBSWS\_OPCODE\_EVENT}}
\index{OBSWS\_OPCODE\_EVENT@{OBSWS\_OPCODE\_EVENT}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_EVENT}{OBSWS\_OPCODE\_EVENT}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+EVENT~5                    /$\ast$ Server\+: Something happened in OBS $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00072}{72}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a28228f50fc25972b87ebb3c5ca36104a}\label{library_8c_a28228f50fc25972b87ebb3c5ca36104a}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_HELLO@{OBSWS\_OPCODE\_HELLO}}
\index{OBSWS\_OPCODE\_HELLO@{OBSWS\_OPCODE\_HELLO}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_HELLO}{OBSWS\_OPCODE\_HELLO}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+HELLO~0                    /$\ast$ Server\+: Initial greeting with auth info $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00068}{68}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a35815ef87e52f4956dcc02be7a3a7d95}\label{library_8c_a35815ef87e52f4956dcc02be7a3a7d95}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_IDENTIFIED@{OBSWS\_OPCODE\_IDENTIFIED}}
\index{OBSWS\_OPCODE\_IDENTIFIED@{OBSWS\_OPCODE\_IDENTIFIED}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_IDENTIFIED}{OBSWS\_OPCODE\_IDENTIFIED}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+IDENTIFIED~2               /$\ast$ Server\+: Auth successful, ready for commands $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00070}{70}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a9ac9adf7323ec0e886fa7294ef8c387c}\label{library_8c_a9ac9adf7323ec0e886fa7294ef8c387c}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_IDENTIFY@{OBSWS\_OPCODE\_IDENTIFY}}
\index{OBSWS\_OPCODE\_IDENTIFY@{OBSWS\_OPCODE\_IDENTIFY}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_IDENTIFY}{OBSWS\_OPCODE\_IDENTIFY}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+IDENTIFY~1                 /$\ast$ Client\+: Authentication and protocol agreement $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00069}{69}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_aca6d50cc88d56174d2cd1ba02b98a02e}\label{library_8c_aca6d50cc88d56174d2cd1ba02b98a02e}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_REIDENTIFY@{OBSWS\_OPCODE\_REIDENTIFY}}
\index{OBSWS\_OPCODE\_REIDENTIFY@{OBSWS\_OPCODE\_REIDENTIFY}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_REIDENTIFY}{OBSWS\_OPCODE\_REIDENTIFY}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+REIDENTIFY~3               /$\ast$ Client\+: Re-\/authenticate after reconnect $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00071}{71}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a6c2c324c3b2c49b7febe0b376d6c1045}\label{library_8c_a6c2c324c3b2c49b7febe0b376d6c1045}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_REQUEST@{OBSWS\_OPCODE\_REQUEST}}
\index{OBSWS\_OPCODE\_REQUEST@{OBSWS\_OPCODE\_REQUEST}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_REQUEST}{OBSWS\_OPCODE\_REQUEST}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST~6                  /$\ast$ Client\+: Execute an operation in OBS $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00073}{73}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_ae139b9522240dea875467adad42804ed}\label{library_8c_ae139b9522240dea875467adad42804ed}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_REQUEST\_BATCH@{OBSWS\_OPCODE\_REQUEST\_BATCH}}
\index{OBSWS\_OPCODE\_REQUEST\_BATCH@{OBSWS\_OPCODE\_REQUEST\_BATCH}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_REQUEST\_BATCH}{OBSWS\_OPCODE\_REQUEST\_BATCH}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST\+\_\+\+BATCH~8            /$\ast$ Client\+: Multiple requests at once (unused) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00075}{75}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a4d2cda5fb13a230acc6a977ec4f1b99c}\label{library_8c_a4d2cda5fb13a230acc6a977ec4f1b99c}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_REQUEST\_BATCH\_RESPONSE@{OBSWS\_OPCODE\_REQUEST\_BATCH\_RESPONSE}}
\index{OBSWS\_OPCODE\_REQUEST\_BATCH\_RESPONSE@{OBSWS\_OPCODE\_REQUEST\_BATCH\_RESPONSE}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_REQUEST\_BATCH\_RESPONSE}{OBSWS\_OPCODE\_REQUEST\_BATCH\_RESPONSE}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST\+\_\+\+BATCH\+\_\+\+RESPONSE~9   /$\ast$ Server\+: Responses to batch (unused) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00076}{76}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_ae6ce9e236045c545c7786292abb8bed2}\label{library_8c_ae6ce9e236045c545c7786292abb8bed2}} 
\index{library.c@{library.c}!OBSWS\_OPCODE\_REQUEST\_RESPONSE@{OBSWS\_OPCODE\_REQUEST\_RESPONSE}}
\index{OBSWS\_OPCODE\_REQUEST\_RESPONSE@{OBSWS\_OPCODE\_REQUEST\_RESPONSE}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_OPCODE\_REQUEST\_RESPONSE}{OBSWS\_OPCODE\_REQUEST\_RESPONSE}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+OPCODE\+\_\+\+REQUEST\+\_\+\+RESPONSE~7         /$\ast$ Server\+: Result of a client request $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00074}{74}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_af132d6e679351e32e25e03f0446b9a79}\label{library_8c_af132d6e679351e32e25e03f0446b9a79}} 
\index{library.c@{library.c}!OBSWS\_PROTOCOL\_VERSION@{OBSWS\_PROTOCOL\_VERSION}}
\index{OBSWS\_PROTOCOL\_VERSION@{OBSWS\_PROTOCOL\_VERSION}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_PROTOCOL\_VERSION}{OBSWS\_PROTOCOL\_VERSION}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+PROTOCOL\+\_\+\+VERSION~1                /$\ast$ OBS Web\+Socket protocol version (v5 uses RPC version 1) $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00033}{33}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a25b13264018fd1dc7b1f2bbd93bdc7cc}\label{library_8c_a25b13264018fd1dc7b1f2bbd93bdc7cc}} 
\index{library.c@{library.c}!OBSWS\_UUID\_LENGTH@{OBSWS\_UUID\_LENGTH}}
\index{OBSWS\_UUID\_LENGTH@{OBSWS\_UUID\_LENGTH}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_UUID\_LENGTH}{OBSWS\_UUID\_LENGTH}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+UUID\+\_\+\+LENGTH~37}



Definition at line \mbox{\hyperlink{library_8c_source_l00049}{49}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_ad27c3919151c76f6e69c502c7ece4065}\label{library_8c_ad27c3919151c76f6e69c502c7ece4065}} 
\index{library.c@{library.c}!OBSWS\_VERSION@{OBSWS\_VERSION}}
\index{OBSWS\_VERSION@{OBSWS\_VERSION}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{OBSWS\_VERSION}{OBSWS\_VERSION}}
{\footnotesize\ttfamily \#define OBSWS\+\_\+\+VERSION~\char`\"{}1.\+0.\+0\char`\"{}                   /$\ast$ Library version string $\ast$/}



Definition at line \mbox{\hyperlink{library_8c_source_l00032}{32}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.



\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}\label{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}} 
\index{library.c@{library.c}!pending\_request\_t@{pending\_request\_t}}
\index{pending\_request\_t@{pending\_request\_t}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{pending\_request\_t}{pending\_request\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structpending__request}{pending\+\_\+request}} \mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}}}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{library_8c_aab5c2995d6518ef254538795c00afdbb}\label{library_8c_aab5c2995d6518ef254538795c00afdbb}} 
\index{library.c@{library.c}!base64\_encode@{base64\_encode}}
\index{base64\_encode@{base64\_encode}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{base64\_encode()}{base64\_encode()}}
{\footnotesize\ttfamily static char $\ast$ base64\+\_\+encode (\begin{DoxyParamCaption}\item[{const unsigned char $\ast$}]{input,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00369}{369}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00369                                                                       \{}
\DoxyCodeLine{00370     BIO *bio, *b64;}
\DoxyCodeLine{00371     BUF\_MEM *buffer\_ptr;}
\DoxyCodeLine{00372     }
\DoxyCodeLine{00373     \textcolor{comment}{/* Set up OpenSSL base64 encoder: b64 filter pushing to memory buffer */}}
\DoxyCodeLine{00374     b64 = BIO\_new(BIO\_f\_base64());}
\DoxyCodeLine{00375     bio = BIO\_new(BIO\_s\_mem());}
\DoxyCodeLine{00376     bio = BIO\_push(b64, bio);}
\DoxyCodeLine{00377     }
\DoxyCodeLine{00378     \textcolor{comment}{/* Disable newlines in output (OpenSSL adds them by default for readability) */}}
\DoxyCodeLine{00379     BIO\_set\_flags(bio, BIO\_FLAGS\_BASE64\_NO\_NL);}
\DoxyCodeLine{00380     }
\DoxyCodeLine{00381     \textcolor{comment}{/* Encode the data */}}
\DoxyCodeLine{00382     BIO\_write(bio, input, length);}
\DoxyCodeLine{00383     BIO\_flush(bio);}
\DoxyCodeLine{00384     BIO\_get\_mem\_ptr(bio, \&buffer\_ptr);}
\DoxyCodeLine{00385     }
\DoxyCodeLine{00386     \textcolor{comment}{/* Copy result to our own allocated buffer and null-\/terminate */}}
\DoxyCodeLine{00387     \textcolor{keywordtype}{char} *result = malloc(buffer\_ptr-\/>length + 1);}
\DoxyCodeLine{00388     memcpy(result, buffer\_ptr-\/>data, buffer\_ptr-\/>length);}
\DoxyCodeLine{00389     result[buffer\_ptr-\/>length] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00390     }
\DoxyCodeLine{00391     BIO\_free\_all(bio);}
\DoxyCodeLine{00392     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{00393 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_aab5c2995d6518ef254538795c00afdbb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a885f22656ee8ca3170a50df0e0d85a4d}\label{library_8c_a885f22656ee8ca3170a50df0e0d85a4d}} 
\index{library.c@{library.c}!cleanup\_old\_requests@{cleanup\_old\_requests}}
\index{cleanup\_old\_requests@{cleanup\_old\_requests}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{cleanup\_old\_requests()}{cleanup\_old\_requests()}}
{\footnotesize\ttfamily static void cleanup\+\_\+old\+\_\+requests (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00572}{572}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00572                                                            \{}
\DoxyCodeLine{00573     time\_t now = time(NULL);}
\DoxyCodeLine{00574     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00575     }
\DoxyCodeLine{00576     \mbox{\hyperlink{structpending__request}{pending\_request\_t}} **req = \&conn-\/>\mbox{\hyperlink{structobsws__connection_acc0664cafa773ffe211ffe993c6ac8af}{pending\_requests}};}
\DoxyCodeLine{00577     \textcolor{keywordflow}{while} (*req) \{}
\DoxyCodeLine{00578         \textcolor{comment}{/* Check if request has timed out (30 seconds) */}}
\DoxyCodeLine{00579         \textcolor{keywordflow}{if} (now -\/ (*req)-\/>timestamp > 30) \{}
\DoxyCodeLine{00580             \mbox{\hyperlink{structpending__request}{pending\_request\_t}} *old = *req;}
\DoxyCodeLine{00581             *req = old-\/>\mbox{\hyperlink{structpending__request_a49161e43ef29129c11fe643e85338df2}{next}};}
\DoxyCodeLine{00582             }
\DoxyCodeLine{00583             \textcolor{comment}{/* Mark as completed with timeout error */}}
\DoxyCodeLine{00584             pthread\_mutex\_lock(\&old-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{00585             old-\/>\mbox{\hyperlink{structpending__request_af74dd3c97a064175b9dcf3dbfe3665cc}{completed}} = \textcolor{keyword}{true};}
\DoxyCodeLine{00586             old-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}}-\/>\mbox{\hyperlink{structobsws__response__t_abbf2e99faa8fdef1c94bbd174470c821}{success}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00587             old-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}}-\/>\mbox{\hyperlink{structobsws__response__t_ab2b3055a84989889d3de28c2ccfd0dac}{error\_message}} = strdup(\textcolor{stringliteral}{"{}Request timeout"{}});}
\DoxyCodeLine{00588             pthread\_cond\_broadcast(\&old-\/>\mbox{\hyperlink{structpending__request_a619500d05293ec1f654ea803139941de}{cond}});  \textcolor{comment}{/* Wake waiting threads */}}
\DoxyCodeLine{00589             pthread\_mutex\_unlock(\&old-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{00590         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00591             req = \&(*req)-\/>\mbox{\hyperlink{structpending__request_a49161e43ef29129c11fe643e85338df2}{next}};}
\DoxyCodeLine{00592         \}}
\DoxyCodeLine{00593     \}}
\DoxyCodeLine{00594     }
\DoxyCodeLine{00595     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00596 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a885f22656ee8ca3170a50df0e0d85a4d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_aafc3d1ce3debddcb8e3888c9806e044a}\label{library_8c_aafc3d1ce3debddcb8e3888c9806e044a}} 
\index{library.c@{library.c}!create\_pending\_request@{create\_pending\_request}}
\index{create\_pending\_request@{create\_pending\_request}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{create\_pending\_request()}{create\_pending\_request()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}} $\ast$ create\+\_\+pending\+\_\+request (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{const char $\ast$}]{request\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00506}{506}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00506                                                                                                    \{}
\DoxyCodeLine{00507     \mbox{\hyperlink{structpending__request}{pending\_request\_t}} *req = calloc(1, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structpending__request}{pending\_request\_t}}));}
\DoxyCodeLine{00508     \textcolor{keywordflow}{if} (!req) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00509     }
\DoxyCodeLine{00510     \textcolor{comment}{/* Copy request ID and ensure null termination */}}
\DoxyCodeLine{00511     strncpy(req-\/>\mbox{\hyperlink{structpending__request_ae33cc3402bf8463415de7e57eac346af}{request\_id}}, request\_id, \mbox{\hyperlink{library_8c_a25b13264018fd1dc7b1f2bbd93bdc7cc}{OBSWS\_UUID\_LENGTH}} -\/ 1);}
\DoxyCodeLine{00512     req-\/>\mbox{\hyperlink{structpending__request_ae33cc3402bf8463415de7e57eac346af}{request\_id}}[\mbox{\hyperlink{library_8c_a25b13264018fd1dc7b1f2bbd93bdc7cc}{OBSWS\_UUID\_LENGTH}} -\/ 1] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00513     }
\DoxyCodeLine{00514     \textcolor{comment}{/* Initialize request structure */}}
\DoxyCodeLine{00515     req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}} = calloc(1, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}}));}
\DoxyCodeLine{00516     req-\/>\mbox{\hyperlink{structpending__request_af74dd3c97a064175b9dcf3dbfe3665cc}{completed}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00517     req-\/>\mbox{\hyperlink{structpending__request_a0fab8de980618cc4e6cea21fbed2eef4}{timestamp}} = time(NULL);}
\DoxyCodeLine{00518     pthread\_mutex\_init(\&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}}, NULL);}
\DoxyCodeLine{00519     pthread\_cond\_init(\&req-\/>\mbox{\hyperlink{structpending__request_a619500d05293ec1f654ea803139941de}{cond}}, NULL);}
\DoxyCodeLine{00520     }
\DoxyCodeLine{00521     \textcolor{comment}{/* Add to linked list of pending requests */}}
\DoxyCodeLine{00522     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00523     req-\/>\mbox{\hyperlink{structpending__request_a49161e43ef29129c11fe643e85338df2}{next}} = conn-\/>\mbox{\hyperlink{structobsws__connection_acc0664cafa773ffe211ffe993c6ac8af}{pending\_requests}};}
\DoxyCodeLine{00524     conn-\/>\mbox{\hyperlink{structobsws__connection_acc0664cafa773ffe211ffe993c6ac8af}{pending\_requests}} = req;}
\DoxyCodeLine{00525     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00526     }
\DoxyCodeLine{00527     \textcolor{keywordflow}{return} req;}
\DoxyCodeLine{00528 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_aafc3d1ce3debddcb8e3888c9806e044a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a27739efcea1287611c82ff3e8c88d7b7}\label{library_8c_a27739efcea1287611c82ff3e8c88d7b7}} 
\index{library.c@{library.c}!event\_thread\_func@{event\_thread\_func}}
\index{event\_thread\_func@{event\_thread\_func}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{event\_thread\_func()}{event\_thread\_func()}}
{\footnotesize\ttfamily static void $\ast$ event\+\_\+thread\+\_\+func (\begin{DoxyParamCaption}\item[{void $\ast$}]{arg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Background thread function that continuously processes Web\+Socket events. 

Each connection has one background thread dedicated to processing Web\+Socket messages and timers. The main application thread remains free to make requests and do application work without blocking.

This thread\+:
\begin{DoxyEnumerate}
\item Calls lws\+\_\+service() to pump the libwebsockets event loop (typically blocks for 50ms waiting for events, then processes them and returns)
\item Periodically cleans up old/timed-\/out requests
\item Sends keep-\/alive pings if configured (to detect dead connections)
\item Exits gracefully when should\+\_\+exit flag is set
\end{DoxyEnumerate}

Lifetime\+: This thread is created in \mbox{\hyperlink{library_8c_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect()}} and destroyed in \mbox{\hyperlink{library_8c_aa8389ba6731e01a9426bd921180b7195}{obsws\+\_\+disconnect()}} using pthread\+\_\+join(). The should\+\_\+exit flag is used to signal the thread to stop, which it checks at the start of each loop.

The lws\+\_\+service() call is the core of this loop. It\+:
\begin{DoxyItemize}
\item Waits up to 50ms for data from the network using select/poll
\item If data arrives, invokes lws\+\_\+callback to notify us
\item Returns after $\sim$50ms even if no data (so we stay responsive to should\+\_\+exit)
\end{DoxyItemize}

This asynchronous design has several advantages\+:
\begin{DoxyItemize}
\item App thread isn\textquotesingle{}t blocked waiting for responses
\item Multiple requests can be in-\/flight simultaneously
\item Events can be delivered to callbacks instantly (no polling delay)
\item Automatic keep-\/alive pings keep the connection alive through firewalls
\end{DoxyItemize}

Memory note\+: Callbacks invoked from this thread have access to the same connection object as the main thread, hence all the mutexes protecting critical sections. The pending\+\_\+request\+\_\+t condition variables synchronize request responses between this thread and application threads.


\begin{DoxyParams}{Parameters}
{\em arg} & The obsws\+\_\+connection\+\_\+t$\ast$ that this thread services \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always NULL (threads don\textquotesingle{}t return values)
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l01131}{1131}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01131                                           \{}
\DoxyCodeLine{01132     \mbox{\hyperlink{structobsws__connection}{obsws\_connection\_t}} *conn = (\mbox{\hyperlink{structobsws__connection}{obsws\_connection\_t}} *)arg;}
\DoxyCodeLine{01133     }
\DoxyCodeLine{01134     \textcolor{keywordtype}{bool} should\_continue = \textcolor{keyword}{true};}
\DoxyCodeLine{01135     \textcolor{keywordflow}{while} (should\_continue) \{}
\DoxyCodeLine{01136         \textcolor{comment}{/* Check exit flag with mutex protection */}}
\DoxyCodeLine{01137         pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01138         should\_continue = !conn-\/>\mbox{\hyperlink{structobsws__connection_a6aa5a0ce7b42fc1cd72385181ca43454}{should\_exit}};}
\DoxyCodeLine{01139         pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01140         }
\DoxyCodeLine{01141         \textcolor{keywordflow}{if} (!should\_continue) \textcolor{keywordflow}{break};}
\DoxyCodeLine{01142         }
\DoxyCodeLine{01143         \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}}) \{}
\DoxyCodeLine{01144             lws\_service(conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}}, 50);}
\DoxyCodeLine{01145             }
\DoxyCodeLine{01146             \textcolor{comment}{/* Cleanup old requests periodically */}}
\DoxyCodeLine{01147             \mbox{\hyperlink{library_8c_a885f22656ee8ca3170a50df0e0d85a4d}{cleanup\_old\_requests}}(conn);}
\DoxyCodeLine{01148             }
\DoxyCodeLine{01149             \textcolor{comment}{/* Handle keep-\/alive pings */}}
\DoxyCodeLine{01150             \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a74ee702373489ff1ea1289e87d50e469}{ping\_interval\_ms}} > 0 \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}} == \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991adbaae08035175b470fb9f543414672b8}{OBSWS\_STATE\_CONNECTED}}) \{}
\DoxyCodeLine{01151                 time\_t now = time(NULL);}
\DoxyCodeLine{01152                 \textcolor{keywordflow}{if} (now -\/ conn-\/>\mbox{\hyperlink{structobsws__connection_a940373a69db859ebc424eb555c86a24c}{last\_ping\_sent}} >= conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a74ee702373489ff1ea1289e87d50e469}{ping\_interval\_ms}} / 1000) \{}
\DoxyCodeLine{01153                     \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}}) \{}
\DoxyCodeLine{01154                         lws\_callback\_on\_writable(conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}});}
\DoxyCodeLine{01155                     \}}
\DoxyCodeLine{01156                     conn-\/>\mbox{\hyperlink{structobsws__connection_a940373a69db859ebc424eb555c86a24c}{last\_ping\_sent}} = now;}
\DoxyCodeLine{01157                 \}}
\DoxyCodeLine{01158             \}}
\DoxyCodeLine{01159         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01160             \textcolor{keyword}{struct }timespec ts = \{0, 50000000\};  \textcolor{comment}{/* 50ms = 50,000,000 nanoseconds */}}
\DoxyCodeLine{01161             nanosleep(\&ts, NULL);}
\DoxyCodeLine{01162         \}}
\DoxyCodeLine{01163     \}}
\DoxyCodeLine{01164     }
\DoxyCodeLine{01165     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{01166 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{d5/d27/library_8c_a27739efcea1287611c82ff3e8c88d7b7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{d5/d27/library_8c_a27739efcea1287611c82ff3e8c88d7b7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a6f7f5f47389b537c9dce9f1b328b7f06}\label{library_8c_a6f7f5f47389b537c9dce9f1b328b7f06}} 
\index{library.c@{library.c}!find\_pending\_request@{find\_pending\_request}}
\index{find\_pending\_request@{find\_pending\_request}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{find\_pending\_request()}{find\_pending\_request()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}} $\ast$ find\+\_\+pending\+\_\+request (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{const char $\ast$}]{request\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00531}{531}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00531                                                                                                  \{}
\DoxyCodeLine{00532     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00533     \mbox{\hyperlink{structpending__request}{pending\_request\_t}} *req = conn-\/>\mbox{\hyperlink{structobsws__connection_acc0664cafa773ffe211ffe993c6ac8af}{pending\_requests}};}
\DoxyCodeLine{00534     }
\DoxyCodeLine{00535     \textcolor{comment}{/* Search linked list for matching request ID */}}
\DoxyCodeLine{00536     \textcolor{keywordflow}{while} (req) \{}
\DoxyCodeLine{00537         \textcolor{keywordflow}{if} (strcmp(req-\/>\mbox{\hyperlink{structpending__request_ae33cc3402bf8463415de7e57eac346af}{request\_id}}, request\_id) == 0) \{}
\DoxyCodeLine{00538             pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00539             \textcolor{keywordflow}{return} req;}
\DoxyCodeLine{00540         \}}
\DoxyCodeLine{00541         req = req-\/>\mbox{\hyperlink{structpending__request_a49161e43ef29129c11fe643e85338df2}{next}};}
\DoxyCodeLine{00542     \}}
\DoxyCodeLine{00543     }
\DoxyCodeLine{00544     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00545     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00546 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a6f7f5f47389b537c9dce9f1b328b7f06_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_acab761db577bf6b074b4e9be8be845b5}\label{library_8c_acab761db577bf6b074b4e9be8be845b5}} 
\index{library.c@{library.c}!generate\_auth\_response@{generate\_auth\_response}}
\index{generate\_auth\_response@{generate\_auth\_response}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{generate\_auth\_response()}{generate\_auth\_response()}}
{\footnotesize\ttfamily static char $\ast$ generate\+\_\+auth\+\_\+response (\begin{DoxyParamCaption}\item[{const char $\ast$}]{password,  }\item[{const char $\ast$}]{salt,  }\item[{const char $\ast$}]{challenge }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00437}{437}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00437                                                                                                    \{}
\DoxyCodeLine{00438     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} secret\_hash[SHA256\_DIGEST\_LENGTH];}
\DoxyCodeLine{00439     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} auth\_hash[SHA256\_DIGEST\_LENGTH];}
\DoxyCodeLine{00440     }
\DoxyCodeLine{00441     \textcolor{comment}{/* Step 1: Compute secret = base64(sha256(password + salt)) */}}
\DoxyCodeLine{00442     \textcolor{keywordtype}{char} *password\_salt = malloc(strlen(password) + strlen(salt) + 1);}
\DoxyCodeLine{00443     sprintf(password\_salt, \textcolor{stringliteral}{"{}\%s\%s"{}}, password, salt);}
\DoxyCodeLine{00444     \mbox{\hyperlink{library_8c_aaaa872a3d93d0ce3d5d4346f4b1c763e}{sha256\_hash}}(password\_salt, secret\_hash);}
\DoxyCodeLine{00445     free(password\_salt);}
\DoxyCodeLine{00446     }
\DoxyCodeLine{00447     \textcolor{keywordtype}{char} *secret = \mbox{\hyperlink{library_8c_aab5c2995d6518ef254538795c00afdbb}{base64\_encode}}(secret\_hash, SHA256\_DIGEST\_LENGTH);}
\DoxyCodeLine{00448     }
\DoxyCodeLine{00449     \textcolor{comment}{/* Step 2: Compute auth response = base64(sha256(secret + challenge)) */}}
\DoxyCodeLine{00450     \textcolor{keywordtype}{char} *secret\_challenge = malloc(strlen(secret) + strlen(challenge) + 1);}
\DoxyCodeLine{00451     sprintf(secret\_challenge, \textcolor{stringliteral}{"{}\%s\%s"{}}, secret, challenge);}
\DoxyCodeLine{00452     \mbox{\hyperlink{library_8c_aaaa872a3d93d0ce3d5d4346f4b1c763e}{sha256\_hash}}(secret\_challenge, auth\_hash);}
\DoxyCodeLine{00453     free(secret\_challenge);}
\DoxyCodeLine{00454     free(secret);}
\DoxyCodeLine{00455     }
\DoxyCodeLine{00456     \textcolor{comment}{/* Return the final response, base64-\/encoded */}}
\DoxyCodeLine{00457     \textcolor{keywordtype}{char} *auth\_response = \mbox{\hyperlink{library_8c_aab5c2995d6518ef254538795c00afdbb}{base64\_encode}}(auth\_hash, SHA256\_DIGEST\_LENGTH);}
\DoxyCodeLine{00458     \textcolor{keywordflow}{return} auth\_response;}
\DoxyCodeLine{00459 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{d5/d27/library_8c_acab761db577bf6b074b4e9be8be845b5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_acab761db577bf6b074b4e9be8be845b5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_af79be0fed07182761c923170f4211089}\label{library_8c_af79be0fed07182761c923170f4211089}} 
\index{library.c@{library.c}!generate\_uuid@{generate\_uuid}}
\index{generate\_uuid@{generate\_uuid}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{generate\_uuid()}{generate\_uuid()}}
{\footnotesize\ttfamily static void generate\+\_\+uuid (\begin{DoxyParamCaption}\item[{char $\ast$}]{uuid\+\_\+out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00344}{344}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00344                                           \{}
\DoxyCodeLine{00345     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} r1 = rand();}
\DoxyCodeLine{00346     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} r2 = rand();}
\DoxyCodeLine{00347     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} r3 = rand();}
\DoxyCodeLine{00348     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} r4 = rand();}
\DoxyCodeLine{00349     }
\DoxyCodeLine{00350     sprintf(uuid\_out, \textcolor{stringliteral}{"{}\%08x-\/\%04x-\/\%04x-\/\%04x-\/\%04x\%08x"{}},}
\DoxyCodeLine{00351             r1,                          \textcolor{comment}{/* 8 hex digits */}}
\DoxyCodeLine{00352             r2 \& 0xFFFF,                \textcolor{comment}{/* 4 hex digits */}}
\DoxyCodeLine{00353             (r3 \& 0x0FFF) | 0x4000,     \textcolor{comment}{/* 4 hex digits (set version 4) */}}
\DoxyCodeLine{00354             (r4 \& 0x3FFF) | 0x8000,     \textcolor{comment}{/* 4 hex digits (set variant bits) */}}
\DoxyCodeLine{00355             rand() \& 0xFFFF,            \textcolor{comment}{/* 4 hex digits */}}
\DoxyCodeLine{00356             (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})rand());       \textcolor{comment}{/* 8 hex digits */}}
\DoxyCodeLine{00357 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_af79be0fed07182761c923170f4211089_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_ac7c18bfa245d7a8582c6e5536cf46532}\label{library_8c_ac7c18bfa245d7a8582c6e5536cf46532}} 
\index{library.c@{library.c}!handle\_event\_message@{handle\_event\_message}}
\index{handle\_event\_message@{handle\_event\_message}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{handle\_event\_message()}{handle\_event\_message()}}
{\footnotesize\ttfamily static int handle\+\_\+event\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{c\+JSON $\ast$}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Handle EVENT messages from OBS (real-\/time notifications). 

OBS continuously sends EVENT messages whenever something happens in the application (scene changes, source muted/unmuted, recording started, etc.). These events are only delivered if we subscribed to them in the IDENTIFY message using the event\+Subscriptions bitmask.

This function\+:
\begin{DoxyEnumerate}
\item Extracts the event type and event data from the JSON
\item Calls the user\textquotesingle{}s event\+\_\+callback if one was configured (async event loop)
\item Updates internal caches (e.\+g., current scene name on Scene\+Changed)
\end{DoxyEnumerate}

Important threading note\+: This is called from the background event\+\_\+thread, NOT from the main application thread. Therefore\+:
\begin{DoxyItemize}
\item The event\+\_\+callback is executed in the event thread context
\item The callback should not block (keep processing fast)
\item The callback should not make blocking library calls
\item The event\+\_\+data\+\_\+str parameter is temporary and freed after callback returns
\item If the callback needs to keep the data, it must copy it
\end{DoxyItemize}

Scene caching optimization\+: We maintain a cache of the currently active scene name in the connection structure. When we see a Current\+Program\+Scene\+Changed event, we update this cache immediately. This avoids the need for the application to call obsws\+\_\+send\+\_\+request(..., \char`\"{}\+Get\+Current\+Program\+Scene\char`\"{}, ...) repeatedly. The cache is protected by scene\+\_\+mutex for thread safety.


\begin{DoxyParams}{Parameters}
{\em conn} & The connection that received the event \\
\hline
{\em data} & The parsed JSON \char`\"{}d\char`\"{} field containing event\+Type and event\+Data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, -\/1 if the event data is malformed
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l00786}{786}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00786                                                                        \{}
\DoxyCodeLine{00787     cJSON *event\_type = cJSON\_GetObjectItem(data, \textcolor{stringliteral}{"{}eventType"{}});}
\DoxyCodeLine{00788     cJSON *event\_data = cJSON\_GetObjectItem(data, \textcolor{stringliteral}{"{}eventData"{}});}
\DoxyCodeLine{00789     }
\DoxyCodeLine{00790     \textcolor{comment}{/* DEBUG\_MEDIUM: Show event type */}}
\DoxyCodeLine{00791     \textcolor{keywordflow}{if} (event\_type) \{}
\DoxyCodeLine{00792         \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aa6c8d9d070b4d69beeadf605bc03eee1}{OBSWS\_DEBUG\_MEDIUM}}, \textcolor{stringliteral}{"{}Event received: \%s"{}}, event\_type-\/>valuestring);}
\DoxyCodeLine{00793     \}}
\DoxyCodeLine{00794     }
\DoxyCodeLine{00795     \textcolor{keywordflow}{if} (event\_type \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a11caeff695d6174de08bd0ff0e196cd3}{event\_callback}}) \{}
\DoxyCodeLine{00796         \textcolor{keywordtype}{char} *event\_data\_str = event\_data ? cJSON\_PrintUnformatted(event\_data) : NULL;}
\DoxyCodeLine{00797         \textcolor{comment}{/* DEBUG\_HIGH: Show full event data */}}
\DoxyCodeLine{00798         \textcolor{keywordflow}{if} (event\_data\_str) \{}
\DoxyCodeLine{00799             \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aceb0431d743cdecf0848564f388d51bd}{OBSWS\_DEBUG\_HIGH}}, \textcolor{stringliteral}{"{}Event data: \%s"{}}, event\_data\_str);}
\DoxyCodeLine{00800         \}}
\DoxyCodeLine{00801         conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a11caeff695d6174de08bd0ff0e196cd3}{event\_callback}}(conn, event\_type-\/>valuestring, event\_data\_str, conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_af272f38a8f4ca535939766cebacf0b8f}{user\_data}});}
\DoxyCodeLine{00802         \textcolor{keywordflow}{if} (event\_data\_str) free(event\_data\_str);}
\DoxyCodeLine{00803     \}}
\DoxyCodeLine{00804     }
\DoxyCodeLine{00805     \textcolor{comment}{/* Update current scene cache if scene changed */}}
\DoxyCodeLine{00806     \textcolor{keywordflow}{if} (event\_type \&\& strcmp(event\_type-\/>valuestring, \textcolor{stringliteral}{"{}CurrentProgramSceneChanged"{}}) == 0) \{}
\DoxyCodeLine{00807         cJSON *scene\_name = cJSON\_GetObjectItem(event\_data, \textcolor{stringliteral}{"{}sceneName"{}});}
\DoxyCodeLine{00808         \textcolor{keywordflow}{if} (scene\_name) \{}
\DoxyCodeLine{00809             pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{00810             free(conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}});}
\DoxyCodeLine{00811             conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}} = strdup(scene\_name-\/>valuestring);}
\DoxyCodeLine{00812             pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{00813             \textcolor{comment}{/* DEBUG\_LOW: Scene changes are important */}}
\DoxyCodeLine{00814             \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668a50fd66057e634b5bd51441ba3fdeaf50}{OBSWS\_DEBUG\_LOW}}, \textcolor{stringliteral}{"{}Scene changed to: \%s"{}}, scene\_name-\/>valuestring);}
\DoxyCodeLine{00815         \}}
\DoxyCodeLine{00816     \}}
\DoxyCodeLine{00817     }
\DoxyCodeLine{00818     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00819 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{d5/d27/library_8c_ac7c18bfa245d7a8582c6e5536cf46532_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_ac7c18bfa245d7a8582c6e5536cf46532_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_af183411517ec69b1d59f875fbb0245bd}\label{library_8c_af183411517ec69b1d59f875fbb0245bd}} 
\index{library.c@{library.c}!handle\_hello\_message@{handle\_hello\_message}}
\index{handle\_hello\_message@{handle\_hello\_message}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{handle\_hello\_message()}{handle\_hello\_message()}}
{\footnotesize\ttfamily static int handle\+\_\+hello\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{c\+JSON $\ast$}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Handle the initial HELLO handshake message from OBS. 

When we first connect to OBS, the server sends a HELLO message containing protocol version information and, if required, an authentication challenge and salt. This function extracts that information and immediately responds with an IDENTIFY message.

The authentication flow (if enabled) works as follows\+:
\begin{DoxyEnumerate}
\item Server sends HELLO with a random challenge string and a salt
\item We compute\+: secret = base64(SHA256(password + salt))
\item We compute\+: response = base64(SHA256(secret + challenge))
\item We send this response in the IDENTIFY message
\item If it matches what the server computed, auth succeeds
\end{DoxyEnumerate}

This challenge-\/response approach has several advantages over sending the raw password\+:
\begin{DoxyItemize}
\item Password never travels across the network (only the computed response)
\item If someone captures the network traffic, they can\textquotesingle{}t replay the captured response because it\textquotesingle{}s specific to this challenge (which was random)
\item Similar to HTTP Digest Authentication (RFC 2617) but simpler
\end{DoxyItemize}

The function transitions the connection state from CONNECTING to AUTHENTICATING, sends the IDENTIFY message, and logs any authentication requirements.


\begin{DoxyParams}{Parameters}
{\em conn} & The connection structure containing buffers, config, and state \\
\hline
{\em data} & The parsed JSON \char`\"{}d\char`\"{} field from the HELLO message, containing authentication info if auth is required \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, -\/1 on error (though errors are logged and connection continues -\/ failure to authenticate will be detected by the server refusing to transition to IDENTIFIED state)
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l00636}{636}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00636                                                                        \{}
\DoxyCodeLine{00637     \textcolor{comment}{/* DEBUG\_LOW: Basic connection event */}}
\DoxyCodeLine{00638     \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668a50fd66057e634b5bd51441ba3fdeaf50}{OBSWS\_DEBUG\_LOW}}, \textcolor{stringliteral}{"{}Received Hello message from OBS"{}});}
\DoxyCodeLine{00639     }
\DoxyCodeLine{00640     cJSON *auth = cJSON\_GetObjectItem(data, \textcolor{stringliteral}{"{}authentication"{}});}
\DoxyCodeLine{00641     \textcolor{keywordflow}{if} (auth) \{}
\DoxyCodeLine{00642         conn-\/>\mbox{\hyperlink{structobsws__connection_a5ed1411f28d7eb3a4dfaff28096fb2fd}{auth\_required}} = \textcolor{keyword}{true};}
\DoxyCodeLine{00643         }
\DoxyCodeLine{00644         cJSON *challenge = cJSON\_GetObjectItem(auth, \textcolor{stringliteral}{"{}challenge"{}});}
\DoxyCodeLine{00645         cJSON *salt = cJSON\_GetObjectItem(auth, \textcolor{stringliteral}{"{}salt"{}});}
\DoxyCodeLine{00646         }
\DoxyCodeLine{00647         \textcolor{keywordflow}{if} (challenge \&\& salt) \{}
\DoxyCodeLine{00648             conn-\/>\mbox{\hyperlink{structobsws__connection_a99dd8596f842d976297c91a7e101b9f4}{challenge}} = strdup(challenge-\/>valuestring);}
\DoxyCodeLine{00649             conn-\/>\mbox{\hyperlink{structobsws__connection_a172b9304975dc52f9c962e0592f20330}{salt}} = strdup(salt-\/>valuestring);}
\DoxyCodeLine{00650             \textcolor{comment}{/* DEBUG\_MEDIUM: Show auth parameters */}}
\DoxyCodeLine{00651             \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aa6c8d9d070b4d69beeadf605bc03eee1}{OBSWS\_DEBUG\_MEDIUM}}, \textcolor{stringliteral}{"{}Authentication required -\/ salt: \%s, challenge: \%s"{}}, }
\DoxyCodeLine{00652                      conn-\/>\mbox{\hyperlink{structobsws__connection_a172b9304975dc52f9c962e0592f20330}{salt}}, conn-\/>\mbox{\hyperlink{structobsws__connection_a99dd8596f842d976297c91a7e101b9f4}{challenge}});}
\DoxyCodeLine{00653         \}}
\DoxyCodeLine{00654     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00655         conn-\/>\mbox{\hyperlink{structobsws__connection_a5ed1411f28d7eb3a4dfaff28096fb2fd}{auth\_required}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00656         \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668a50fd66057e634b5bd51441ba3fdeaf50}{OBSWS\_DEBUG\_LOW}}, \textcolor{stringliteral}{"{}No authentication required"{}});}
\DoxyCodeLine{00657     \}}
\DoxyCodeLine{00658     }
\DoxyCodeLine{00659     \textcolor{comment}{/* Send Identify message */}}
\DoxyCodeLine{00660     \mbox{\hyperlink{library_8c_a2f13308e49322d01e479cbe14da7b575}{set\_connection\_state}}(conn, \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991ac9c5d9c3aab50d7e6d1d38b1bb7d6d0f}{OBSWS\_STATE\_AUTHENTICATING}});}
\DoxyCodeLine{00661     }
\DoxyCodeLine{00662     cJSON *identify = cJSON\_CreateObject();}
\DoxyCodeLine{00663     cJSON\_AddNumberToObject(identify, \textcolor{stringliteral}{"{}op"{}}, \mbox{\hyperlink{library_8c_a9ac9adf7323ec0e886fa7294ef8c387c}{OBSWS\_OPCODE\_IDENTIFY}});}
\DoxyCodeLine{00664     }
\DoxyCodeLine{00665     cJSON *identify\_data = cJSON\_CreateObject();}
\DoxyCodeLine{00666     cJSON\_AddNumberToObject(identify\_data, \textcolor{stringliteral}{"{}rpcVersion"{}}, \mbox{\hyperlink{library_8c_af132d6e679351e32e25e03f0446b9a79}{OBSWS\_PROTOCOL\_VERSION}});}
\DoxyCodeLine{00667     cJSON\_AddNumberToObject(identify\_data, \textcolor{stringliteral}{"{}eventSubscriptions"{}}, \mbox{\hyperlink{library_8c_a22c0214b5dafa0c23d7c7fe4c0686f7c}{OBSWS\_EVENT\_ALL}});}
\DoxyCodeLine{00668     }
\DoxyCodeLine{00669     \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_a5ed1411f28d7eb3a4dfaff28096fb2fd}{auth\_required}} \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a53ed762a113bb2a27b3ffab06a5c02ee}{password}}) \{}
\DoxyCodeLine{00670         \textcolor{comment}{/* DEBUG\_HIGH: Show password being used */}}
\DoxyCodeLine{00671         \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aceb0431d743cdecf0848564f388d51bd}{OBSWS\_DEBUG\_HIGH}}, \textcolor{stringliteral}{"{}Generating auth response with password: '\%s'"{}}, conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a53ed762a113bb2a27b3ffab06a5c02ee}{password}});}
\DoxyCodeLine{00672         \textcolor{keywordtype}{char} *auth\_response = \mbox{\hyperlink{library_8c_acab761db577bf6b074b4e9be8be845b5}{generate\_auth\_response}}(conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a53ed762a113bb2a27b3ffab06a5c02ee}{password}}, conn-\/>\mbox{\hyperlink{structobsws__connection_a172b9304975dc52f9c962e0592f20330}{salt}}, conn-\/>\mbox{\hyperlink{structobsws__connection_a99dd8596f842d976297c91a7e101b9f4}{challenge}});}
\DoxyCodeLine{00673         \textcolor{comment}{/* DEBUG\_MEDIUM: Show generated auth string */}}
\DoxyCodeLine{00674         \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aa6c8d9d070b4d69beeadf605bc03eee1}{OBSWS\_DEBUG\_MEDIUM}}, \textcolor{stringliteral}{"{}Generated auth response: '\%s'"{}}, auth\_response);}
\DoxyCodeLine{00675         cJSON\_AddStringToObject(identify\_data, \textcolor{stringliteral}{"{}authentication"{}}, auth\_response);}
\DoxyCodeLine{00676         free(auth\_response);}
\DoxyCodeLine{00677     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00678         \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_a5ed1411f28d7eb3a4dfaff28096fb2fd}{auth\_required}}) \{}
\DoxyCodeLine{00679             \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Authentication required but no password provided!"{}});}
\DoxyCodeLine{00680         \}}
\DoxyCodeLine{00681     \}}
\DoxyCodeLine{00682     }
\DoxyCodeLine{00683     cJSON\_AddItemToObject(identify, \textcolor{stringliteral}{"{}d"{}}, identify\_data);}
\DoxyCodeLine{00684     }
\DoxyCodeLine{00685     \textcolor{keywordtype}{char} *message = cJSON\_PrintUnformatted(identify);}
\DoxyCodeLine{00686     cJSON\_Delete(identify);}
\DoxyCodeLine{00687     }
\DoxyCodeLine{00688     \textcolor{comment}{/* DEBUG\_HIGH: Show full Identify message */}}
\DoxyCodeLine{00689     \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aceb0431d743cdecf0848564f388d51bd}{OBSWS\_DEBUG\_HIGH}}, \textcolor{stringliteral}{"{}Sending Identify message: \%s"{}}, message);}
\DoxyCodeLine{00690     }
\DoxyCodeLine{00691     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_afc665d5d6864f038f551e4e7d4aae679}{send\_mutex}});}
\DoxyCodeLine{00692     \textcolor{keywordtype}{size\_t} len = strlen(message);}
\DoxyCodeLine{00693     \textcolor{keywordflow}{if} (len < conn-\/>send\_buffer\_size -\/ LWS\_PRE) \{}
\DoxyCodeLine{00694         memcpy(conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}} + LWS\_PRE, message, len);}
\DoxyCodeLine{00695         \textcolor{keywordtype}{int} written = lws\_write(conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}}, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)(conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}} + LWS\_PRE), len, LWS\_WRITE\_TEXT);}
\DoxyCodeLine{00696         \textcolor{comment}{/* DEBUG\_HIGH: Show bytes sent */}}
\DoxyCodeLine{00697         \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aceb0431d743cdecf0848564f388d51bd}{OBSWS\_DEBUG\_HIGH}}, \textcolor{stringliteral}{"{}Sent \%d bytes (requested \%zu)"{}}, written, len);}
\DoxyCodeLine{00698     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00699         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Message too large for send buffer: \%zu bytes"{}}, len);}
\DoxyCodeLine{00700     \}}
\DoxyCodeLine{00701     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_afc665d5d6864f038f551e4e7d4aae679}{send\_mutex}});}
\DoxyCodeLine{00702     }
\DoxyCodeLine{00703     free(message);}
\DoxyCodeLine{00704     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00705 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_af183411517ec69b1d59f875fbb0245bd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_af183411517ec69b1d59f875fbb0245bd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_aad4174fe2c4665d21ae49896fc25be9e}\label{library_8c_aad4174fe2c4665d21ae49896fc25be9e}} 
\index{library.c@{library.c}!handle\_identified\_message@{handle\_identified\_message}}
\index{handle\_identified\_message@{handle\_identified\_message}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{handle\_identified\_message()}{handle\_identified\_message()}}
{\footnotesize\ttfamily static int handle\+\_\+identified\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{c\+JSON $\ast$}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Handle the IDENTIFIED confirmation message from OBS. 

After we send an IDENTIFY message with authentication (or without if auth isn\textquotesingle{}t required), OBS responds with an IDENTIFIED message to confirm that the connection is established and ready for commands. This function marks the connection as fully established, records connection statistics, and resets the reconnection state.

Receiving this message means\+:
\begin{DoxyItemize}
\item Authentication succeeded (if it was required)
\item The server has accepted our protocol version
\item We can now send REQUEST messages and receive EVENT messages
\item The connection is in a healthy state
\end{DoxyItemize}

We take this opportunity to\+:
\begin{DoxyEnumerate}
\item Log successful authentication
\item Transition state to CONNECTED (the only valid way to enter this state)
\item Record the timestamp of successful connection (for statistics)
\item Reset the reconnection attempt counter and delay (we\textquotesingle{}re connected!)
\end{DoxyEnumerate}


\begin{DoxyParams}{Parameters}
{\em conn} & The connection structure to mark as identified \\
\hline
{\em data} & Unused (the IDENTIFIED message typically has no data payload) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always 0 (this message type should never fail)
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l00734}{734}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00734                                                                             \{}
\DoxyCodeLine{00735     (void)data;  \textcolor{comment}{/* Unused parameter */}}
\DoxyCodeLine{00736     \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}Successfully authenticated with OBS"{}});}
\DoxyCodeLine{00737     \textcolor{comment}{/* DEBUG\_LOW: Authentication success */}}
\DoxyCodeLine{00738     \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668a50fd66057e634b5bd51441ba3fdeaf50}{OBSWS\_DEBUG\_LOW}}, \textcolor{stringliteral}{"{}Identified message received -\/ authentication successful"{}});}
\DoxyCodeLine{00739     \mbox{\hyperlink{library_8c_a2f13308e49322d01e479cbe14da7b575}{set\_connection\_state}}(conn, \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991adbaae08035175b470fb9f543414672b8}{OBSWS\_STATE\_CONNECTED}});}
\DoxyCodeLine{00740     }
\DoxyCodeLine{00741     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{00742     conn-\/>\mbox{\hyperlink{structobsws__connection_a10b9da03b3a1cb3a6ee0e72387915740}{stats}}.\mbox{\hyperlink{structobsws__stats__t_a7beeb77349c34e8aee20d09df550f8fb}{connected\_since}} = time(NULL);}
\DoxyCodeLine{00743     conn-\/>\mbox{\hyperlink{structobsws__connection_a10b9da03b3a1cb3a6ee0e72387915740}{stats}}.\mbox{\hyperlink{structobsws__stats__t_a156bc64dad480c853539be79f2276654}{reconnect\_count}} = conn-\/>\mbox{\hyperlink{structobsws__connection_a3a5cd4d0f5a72d53df87306e5c697377}{reconnect\_attempts}};}
\DoxyCodeLine{00744     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{00745     }
\DoxyCodeLine{00746     conn-\/>\mbox{\hyperlink{structobsws__connection_a3a5cd4d0f5a72d53df87306e5c697377}{reconnect\_attempts}} = 0;}
\DoxyCodeLine{00747     conn-\/>\mbox{\hyperlink{structobsws__connection_a32b971d76cdd4c2b166ff19135601776}{current\_reconnect\_delay}} = conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a5ccd3a828a3fcad6d6ebedc0324c4aee}{reconnect\_delay\_ms}};}
\DoxyCodeLine{00748     }
\DoxyCodeLine{00749     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00750 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_aad4174fe2c4665d21ae49896fc25be9e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_aad4174fe2c4665d21ae49896fc25be9e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a046a86e7ba13a054663021594755d54b}\label{library_8c_a046a86e7ba13a054663021594755d54b}} 
\index{library.c@{library.c}!handle\_request\_response\_message@{handle\_request\_response\_message}}
\index{handle\_request\_response\_message@{handle\_request\_response\_message}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{handle\_request\_response\_message()}{handle\_request\_response\_message()}}
{\footnotesize\ttfamily static int handle\+\_\+request\+\_\+response\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{c\+JSON $\ast$}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Handle REQUEST\+\_\+\+RESPONSE messages from OBS (responses to our commands). 

When we send a REQUEST message (via obsws\+\_\+send\+\_\+request), OBS processes it and sends back a REQUEST\+\_\+\+RESPONSE message with the same request\+Id that we used. This function matches the response to the pending request, populates the response data, and wakes up the waiting thread.

The async request/response pattern allows the application to send multiple requests without waiting for each response. The flow is\+:
\begin{DoxyEnumerate}
\item Application calls obsws\+\_\+send\+\_\+request(\char`\"{}\+Get\+Scenes\char`\"{}, ...) -\/\texorpdfstring{$>$}{>} returns immediately
\item The request is created with a unique UUID and added to pending\+\_\+requests list
\item Background thread sends the request to OBS
\item Background thread waits for response (on condition variable, not busy-\/polling)
\item OBS responds with REQUEST\+\_\+\+RESPONSE containing the request\+Id
\item This function matches it to the pending request
\item Function sets response-\/\texorpdfstring{$>$}{>}success, response-\/\texorpdfstring{$>$}{>}status\+\_\+code, response-\/\texorpdfstring{$>$}{>}response\+\_\+data
\item Function signals the condition variable to wake the waiting thread
\item Application thread wakes up with the response ready
\end{DoxyEnumerate}

This is far more efficient than synchronous request/response because\+:
\begin{DoxyItemize}
\item No blocking wait in the background thread
\item Multiple requests can be in-\/flight simultaneously
\item Doesn\textquotesingle{}t freeze the application while waiting for OBS
\item Condition variables are more efficient than polling
\end{DoxyItemize}

Response structure contains\+:
\begin{DoxyItemize}
\item success\+: Did the operation succeed? (not the HTTP status, but \char`\"{}was it valid?\char`\"{})
\item status\+\_\+code\+: The OBS response code (0 = success, \texorpdfstring{$>$}{>}0 = error)
\item response\+\_\+data\+: JSON string with the actual result (e.\+g., scene list)
\item error\+\_\+message\+: If something failed, what was the reason?
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em conn} & The connection that received the response \\
\hline
{\em data} & The parsed JSON \char`\"{}d\char`\"{} field containing request\+Id, request\+Status, etc. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, -\/1 if the response is malformed (e.\+g., missing request\+Id)
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l00859}{859}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00859                                                                                   \{}
\DoxyCodeLine{00860     cJSON *request\_id = cJSON\_GetObjectItem(data, \textcolor{stringliteral}{"{}requestId"{}});}
\DoxyCodeLine{00861     \textcolor{keywordflow}{if} (!request\_id) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00862     }
\DoxyCodeLine{00863     \textcolor{comment}{/* DEBUG\_MEDIUM: Show request ID being processed */}}
\DoxyCodeLine{00864     \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aa6c8d9d070b4d69beeadf605bc03eee1}{OBSWS\_DEBUG\_MEDIUM}}, \textcolor{stringliteral}{"{}Response received for request: \%s"{}}, request\_id-\/>valuestring);}
\DoxyCodeLine{00865     }
\DoxyCodeLine{00866     \mbox{\hyperlink{structpending__request}{pending\_request\_t}} *req = \mbox{\hyperlink{library_8c_a6f7f5f47389b537c9dce9f1b328b7f06}{find\_pending\_request}}(conn, request\_id-\/>valuestring);}
\DoxyCodeLine{00867     \textcolor{keywordflow}{if} (!req) \{}
\DoxyCodeLine{00868         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a7db7d387859c4786d8eb303e5bbafef7}{OBSWS\_LOG\_WARNING}}, \textcolor{stringliteral}{"{}Received response for unknown request: \%s"{}}, request\_id-\/>valuestring);}
\DoxyCodeLine{00869         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00870     \}}
\DoxyCodeLine{00871     }
\DoxyCodeLine{00872     pthread\_mutex\_lock(\&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{00873     }
\DoxyCodeLine{00874     cJSON *request\_status = cJSON\_GetObjectItem(data, \textcolor{stringliteral}{"{}requestStatus"{}});}
\DoxyCodeLine{00875     \textcolor{keywordflow}{if} (request\_status) \{}
\DoxyCodeLine{00876         cJSON *result = cJSON\_GetObjectItem(request\_status, \textcolor{stringliteral}{"{}result"{}});}
\DoxyCodeLine{00877         cJSON *code = cJSON\_GetObjectItem(request\_status, \textcolor{stringliteral}{"{}code"{}});}
\DoxyCodeLine{00878         cJSON *comment = cJSON\_GetObjectItem(request\_status, \textcolor{stringliteral}{"{}comment"{}});}
\DoxyCodeLine{00879         }
\DoxyCodeLine{00880         req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}}-\/>\mbox{\hyperlink{structobsws__response__t_abbf2e99faa8fdef1c94bbd174470c821}{success}} = result ? result-\/>valueint : \textcolor{keyword}{false};}
\DoxyCodeLine{00881         req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}}-\/>\mbox{\hyperlink{structobsws__response__t_a1221f1002dd30535f6d4fdda1ba6abd0}{status\_code}} = code ? code-\/>valueint : -\/1;}
\DoxyCodeLine{00882         }
\DoxyCodeLine{00883         \textcolor{keywordflow}{if} (comment) \{}
\DoxyCodeLine{00884             req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}}-\/>\mbox{\hyperlink{structobsws__response__t_ab2b3055a84989889d3de28c2ccfd0dac}{error\_message}} = strdup(comment-\/>valuestring);}
\DoxyCodeLine{00885         \}}
\DoxyCodeLine{00886     \}}
\DoxyCodeLine{00887     }
\DoxyCodeLine{00888     cJSON *response\_data = cJSON\_GetObjectItem(data, \textcolor{stringliteral}{"{}responseData"{}});}
\DoxyCodeLine{00889     \textcolor{keywordflow}{if} (response\_data) \{}
\DoxyCodeLine{00890         req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}}-\/>\mbox{\hyperlink{structobsws__response__t_a696a1179e1d40c6c31136999846d5902}{response\_data}} = cJSON\_PrintUnformatted(response\_data);}
\DoxyCodeLine{00891     \}}
\DoxyCodeLine{00892     }
\DoxyCodeLine{00893     req-\/>\mbox{\hyperlink{structpending__request_af74dd3c97a064175b9dcf3dbfe3665cc}{completed}} = \textcolor{keyword}{true};}
\DoxyCodeLine{00894     pthread\_cond\_broadcast(\&req-\/>\mbox{\hyperlink{structpending__request_a619500d05293ec1f654ea803139941de}{cond}});}
\DoxyCodeLine{00895     pthread\_mutex\_unlock(\&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{00896     }
\DoxyCodeLine{00897     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00898 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a046a86e7ba13a054663021594755d54b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a046a86e7ba13a054663021594755d54b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a0672da971c7e38224df11c34ef612f02}\label{library_8c_a0672da971c7e38224df11c34ef612f02}} 
\index{library.c@{library.c}!handle\_websocket\_message@{handle\_websocket\_message}}
\index{handle\_websocket\_message@{handle\_websocket\_message}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{handle\_websocket\_message()}{handle\_websocket\_message()}}
{\footnotesize\ttfamily static int handle\+\_\+websocket\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{const char $\ast$}]{message,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Route incoming Web\+Socket messages to appropriate handlers based on opcode. 

Every message from OBS contains an \char`\"{}op\char`\"{} field (opcode) that identifies the message type. This function\+:
\begin{DoxyEnumerate}
\item Parses the JSON to extract the opcode and data
\item Routes to the appropriate handler function based on the opcode
\item Updates statistics (messages\+\_\+received, bytes\+\_\+received)
\end{DoxyEnumerate}

The OBS Web\+Socket protocol uses these opcodes\+:
\begin{DoxyItemize}
\item HELLO (0)\+: Server greeting with auth info -\/ handled by handle\+\_\+hello\+\_\+message
\item IDENTIFY (1)\+: Client auth -\/ we send this, don\textquotesingle{}t receive it
\item IDENTIFIED (2)\+: Auth success -\/ handled by handle\+\_\+identified\+\_\+message
\item EVENT (5)\+: Real-\/time notifications -\/ handled by handle\+\_\+event\+\_\+message
\item REQUEST\+\_\+\+RESPONSE (7)\+: Command responses -\/ handled by handle\+\_\+request\+\_\+response\+\_\+message
\item Other opcodes like REIDENTIFY, batch operations\+: not currently handled
\end{DoxyItemize}

This is one of the most critical functions in the library because it\textquotesingle{}s in the hot path of message processing. Performance matters here. We keep it lightweight and defer heavy processing to the specific handlers.

Error handling is conservative\+: malformed JSON or missing opcode doesn\textquotesingle{}t crash the connection, it just logs and continues. This allows us to be resilient to protocol variations or corruption.


\begin{DoxyParams}{Parameters}
{\em conn} & The connection that received the message \\
\hline
{\em message} & Pointer to the raw message data (not null-\/terminated) \\
\hline
{\em len} & Number of bytes in the message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, -\/1 on parse error (does not disconnect)
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l00932}{932}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00932                                                                                                \{}
\DoxyCodeLine{00933     \textcolor{comment}{/* DEBUG\_HIGH: Show full message content */}}
\DoxyCodeLine{00934     \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aceb0431d743cdecf0848564f388d51bd}{OBSWS\_DEBUG\_HIGH}}, \textcolor{stringliteral}{"{}Received message (\%zu bytes): \%.*s"{}}, len, (\textcolor{keywordtype}{int})len, message);}
\DoxyCodeLine{00935     }
\DoxyCodeLine{00936     cJSON *json = cJSON\_ParseWithLength(message, len);}
\DoxyCodeLine{00937     \textcolor{keywordflow}{if} (!json) \{}
\DoxyCodeLine{00938         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Failed to parse JSON message"{}});}
\DoxyCodeLine{00939         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00940     \}}
\DoxyCodeLine{00941     }
\DoxyCodeLine{00942     cJSON *op = cJSON\_GetObjectItem(json, \textcolor{stringliteral}{"{}op"{}});}
\DoxyCodeLine{00943     cJSON *data = cJSON\_GetObjectItem(json, \textcolor{stringliteral}{"{}d"{}});}
\DoxyCodeLine{00944     }
\DoxyCodeLine{00945     \textcolor{keywordflow}{if} (!op) \{}
\DoxyCodeLine{00946         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Message missing 'op' field"{}});}
\DoxyCodeLine{00947         cJSON\_Delete(json);}
\DoxyCodeLine{00948         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00949     \}}
\DoxyCodeLine{00950     }
\DoxyCodeLine{00951     \textcolor{comment}{/* DEBUG\_MEDIUM: Show opcode being processed */}}
\DoxyCodeLine{00952     \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aa6c8d9d070b4d69beeadf605bc03eee1}{OBSWS\_DEBUG\_MEDIUM}}, \textcolor{stringliteral}{"{}Processing opcode: \%d"{}}, op-\/>valueint);}
\DoxyCodeLine{00953     }
\DoxyCodeLine{00954     \textcolor{keywordtype}{int} result = 0;}
\DoxyCodeLine{00955     \textcolor{keywordflow}{switch} (op-\/>valueint) \{}
\DoxyCodeLine{00956         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8c_a28228f50fc25972b87ebb3c5ca36104a}{OBSWS\_OPCODE\_HELLO}}:}
\DoxyCodeLine{00957             result = \mbox{\hyperlink{library_8c_af183411517ec69b1d59f875fbb0245bd}{handle\_hello\_message}}(conn, data);}
\DoxyCodeLine{00958             \textcolor{keywordflow}{break};}
\DoxyCodeLine{00959         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8c_a35815ef87e52f4956dcc02be7a3a7d95}{OBSWS\_OPCODE\_IDENTIFIED}}:}
\DoxyCodeLine{00960             result = \mbox{\hyperlink{library_8c_aad4174fe2c4665d21ae49896fc25be9e}{handle\_identified\_message}}(conn, data);}
\DoxyCodeLine{00961             \textcolor{keywordflow}{break};}
\DoxyCodeLine{00962         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8c_a60741575bd0daca62cfc088a7d3908c6}{OBSWS\_OPCODE\_EVENT}}:}
\DoxyCodeLine{00963             result = \mbox{\hyperlink{library_8c_ac7c18bfa245d7a8582c6e5536cf46532}{handle\_event\_message}}(conn, data);}
\DoxyCodeLine{00964             \textcolor{keywordflow}{break};}
\DoxyCodeLine{00965         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8c_ae6ce9e236045c545c7786292abb8bed2}{OBSWS\_OPCODE\_REQUEST\_RESPONSE}}:}
\DoxyCodeLine{00966             result = \mbox{\hyperlink{library_8c_a046a86e7ba13a054663021594755d54b}{handle\_request\_response\_message}}(conn, data);}
\DoxyCodeLine{00967             \textcolor{keywordflow}{break};}
\DoxyCodeLine{00968         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00969             \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9aa69cfac4b3acbd5968bfab9ef5759cd2}{OBSWS\_LOG\_DEBUG}}, \textcolor{stringliteral}{"{}Unhandled opcode: \%d"{}}, op-\/>valueint);}
\DoxyCodeLine{00970             \textcolor{keywordflow}{break};}
\DoxyCodeLine{00971     \}}
\DoxyCodeLine{00972     }
\DoxyCodeLine{00973     cJSON\_Delete(json);}
\DoxyCodeLine{00974     }
\DoxyCodeLine{00975     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{00976     conn-\/>\mbox{\hyperlink{structobsws__connection_a10b9da03b3a1cb3a6ee0e72387915740}{stats}}.\mbox{\hyperlink{structobsws__stats__t_acbd2023849f8049c705c4cbff567119b}{messages\_received}}++;}
\DoxyCodeLine{00977     conn-\/>\mbox{\hyperlink{structobsws__connection_a10b9da03b3a1cb3a6ee0e72387915740}{stats}}.\mbox{\hyperlink{structobsws__stats__t_ae29f4f06b24960c6802aefd3f1627b4f}{bytes\_received}} += len;}
\DoxyCodeLine{00978     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{00979     }
\DoxyCodeLine{00980     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{00981 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a0672da971c7e38224df11c34ef612f02_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a0672da971c7e38224df11c34ef612f02_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_ac5c31c457dc3042f85a620d7998ebeee}\label{library_8c_ac5c31c457dc3042f85a620d7998ebeee}} 
\index{library.c@{library.c}!lws\_callback@{lws\_callback}}
\index{lws\_callback@{lws\_callback}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{lws\_callback()}{lws\_callback()}}
{\footnotesize\ttfamily static int lws\+\_\+callback (\begin{DoxyParamCaption}\item[{struct lws $\ast$}]{wsi,  }\item[{enum lws\+\_\+callback\+\_\+reasons}]{reason,  }\item[{void $\ast$}]{user,  }\item[{void $\ast$}]{in,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



libwebsockets callback -\/ routes Web\+Socket events to our handlers. 

libwebsockets is an event-\/driven Web\+Socket library. It calls this callback function whenever something happens (connection established, data received, connection closed, etc.). The \char`\"{}reason\char`\"{} parameter identifies what happened.

We handle these key reasons\+:
\begin{DoxyItemize}
\item LWS\+\_\+\+CALLBACK\+\_\+\+CLIENT\+\_\+\+ESTABLISHED\+: TCP/\+Web\+Socket handshake complete, ready for messages
\item LWS\+\_\+\+CALLBACK\+\_\+\+CLIENT\+\_\+\+RECEIVE\+: Data arrived from OBS
\item LWS\+\_\+\+CALLBACK\+\_\+\+CLIENT\+\_\+\+WRITEABLE\+: Socket is writable (less common with our design)
\item LWS\+\_\+\+CALLBACK\+\_\+\+CLIENT\+\_\+\+CONNECTION\+\_\+\+ERROR\+: Connection failed (network error, bad host, etc.)
\item LWS\+\_\+\+CALLBACK\+\_\+\+CLIENT\+\_\+\+CLOSED\+: Connection closed normally
\item LWS\+\_\+\+CALLBACK\+\_\+\+WSI\+\_\+\+DESTROY\+: Cleanup callback
\end{DoxyItemize}

Important\+: This callback is called from the background event\+\_\+thread, not the main application thread. So it must be thread-\/safe and not block.

Message assembly\+: OBS Web\+Socket messages might arrive fragmented (multiple packets). We accumulate them in recv\+\_\+buffer and check lws\+\_\+is\+\_\+final\+\_\+fragment() to know when a complete message has arrived. Only then do we parse it.

Error handling\+: Connection errors and receive buffer overflows are logged but don\textquotesingle{}t crash. We just transition to ERROR state and let the connection cleanup/reconnection logic handle recovery.


\begin{DoxyParams}{Parameters}
{\em wsi} & The Web\+Socket instance (provided by libwebsockets) \\
\hline
{\em reason} & The callback reason (LWS\+\_\+\+CALLBACK\+\_\+$\ast$) \\
\hline
{\em user} & Our connection pointer (registered at context creation) \\
\hline
{\em in} & Incoming data (for LWS\+\_\+\+CALLBACK\+\_\+\+CLIENT\+\_\+\+RECEIVE) \\
\hline
{\em len} & Size of incoming data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 for success, -\/1 for error (affects connection handling)
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l01022}{1022}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01023                                                          \{}
\DoxyCodeLine{01024     \mbox{\hyperlink{structobsws__connection}{obsws\_connection\_t}} *conn = (\mbox{\hyperlink{structobsws__connection}{obsws\_connection\_t}} *)user;}
\DoxyCodeLine{01025     }
\DoxyCodeLine{01026     \textcolor{keywordflow}{switch} (reason) \{}
\DoxyCodeLine{01027         \textcolor{keywordflow}{case} LWS\_CALLBACK\_CLIENT\_ESTABLISHED:}
\DoxyCodeLine{01028             \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}WebSocket connection established"{}});}
\DoxyCodeLine{01029             \mbox{\hyperlink{library_8c_a2f13308e49322d01e479cbe14da7b575}{set\_connection\_state}}(conn, \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991a88276a1a9f595735a2b242f0eab1524a}{OBSWS\_STATE\_CONNECTING}});}
\DoxyCodeLine{01030             \textcolor{keywordflow}{break};}
\DoxyCodeLine{01031             }
\DoxyCodeLine{01032         \textcolor{keywordflow}{case} LWS\_CALLBACK\_CLIENT\_RECEIVE:}
\DoxyCodeLine{01033             \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_a74838edd16f7d8d3d75c772f85d9f7df}{recv\_buffer\_used}} + len < conn-\/>recv\_buffer\_size) \{}
\DoxyCodeLine{01034                 memcpy(conn-\/>\mbox{\hyperlink{structobsws__connection_a89f2bbc96729ab308290da8959534d18}{recv\_buffer}} + conn-\/>\mbox{\hyperlink{structobsws__connection_a74838edd16f7d8d3d75c772f85d9f7df}{recv\_buffer\_used}}, in, len);}
\DoxyCodeLine{01035                 conn-\/>\mbox{\hyperlink{structobsws__connection_a74838edd16f7d8d3d75c772f85d9f7df}{recv\_buffer\_used}} += len;}
\DoxyCodeLine{01036                 }
\DoxyCodeLine{01037                 \textcolor{keywordflow}{if} (lws\_is\_final\_fragment(wsi)) \{}
\DoxyCodeLine{01038                     \mbox{\hyperlink{library_8c_a0672da971c7e38224df11c34ef612f02}{handle\_websocket\_message}}(conn, conn-\/>\mbox{\hyperlink{structobsws__connection_a89f2bbc96729ab308290da8959534d18}{recv\_buffer}}, conn-\/>\mbox{\hyperlink{structobsws__connection_a74838edd16f7d8d3d75c772f85d9f7df}{recv\_buffer\_used}});}
\DoxyCodeLine{01039                     conn-\/>\mbox{\hyperlink{structobsws__connection_a74838edd16f7d8d3d75c772f85d9f7df}{recv\_buffer\_used}} = 0;}
\DoxyCodeLine{01040                 \}}
\DoxyCodeLine{01041             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01042                 \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Receive buffer overflow"{}});}
\DoxyCodeLine{01043                 conn-\/>\mbox{\hyperlink{structobsws__connection_a74838edd16f7d8d3d75c772f85d9f7df}{recv\_buffer\_used}} = 0;}
\DoxyCodeLine{01044             \}}
\DoxyCodeLine{01045             \textcolor{keywordflow}{break};}
\DoxyCodeLine{01046             }
\DoxyCodeLine{01047         \textcolor{keywordflow}{case} LWS\_CALLBACK\_CLIENT\_WRITEABLE:}
\DoxyCodeLine{01048             \textcolor{comment}{/* Handle queued sends if needed */}}
\DoxyCodeLine{01049             \textcolor{keywordflow}{break};}
\DoxyCodeLine{01050             }
\DoxyCodeLine{01051         \textcolor{keywordflow}{case} LWS\_CALLBACK\_CLIENT\_CONNECTION\_ERROR:}
\DoxyCodeLine{01052             \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Connection error: \%s"{}}, in ? (\textcolor{keywordtype}{char} *)in : \textcolor{stringliteral}{"{}unknown"{}});}
\DoxyCodeLine{01053             \mbox{\hyperlink{library_8c_a2f13308e49322d01e479cbe14da7b575}{set\_connection\_state}}(conn, \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991ae13bce21841139a7510b1c8b10a694ac}{OBSWS\_STATE\_ERROR}});}
\DoxyCodeLine{01054             \textcolor{keywordflow}{break};}
\DoxyCodeLine{01055             }
\DoxyCodeLine{01056         \textcolor{keywordflow}{case} LWS\_CALLBACK\_CLIENT\_CLOSED:}
\DoxyCodeLine{01057             \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}WebSocket connection closed (reason in 'in' param)"{}});}
\DoxyCodeLine{01058             \textcolor{keywordflow}{if} (in \&\& len > 0) \{}
\DoxyCodeLine{01059                 \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}Close reason: \%.*s"{}}, (\textcolor{keywordtype}{int})len, (\textcolor{keywordtype}{char}*)in);}
\DoxyCodeLine{01060             \}}
\DoxyCodeLine{01061             \mbox{\hyperlink{library_8c_a2f13308e49322d01e479cbe14da7b575}{set\_connection\_state}}(conn, \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991af973d2b8b0a498d0bbffb40ccab1ef2d}{OBSWS\_STATE\_DISCONNECTED}});}
\DoxyCodeLine{01062             \textcolor{keywordflow}{break};}
\DoxyCodeLine{01063             }
\DoxyCodeLine{01064         \textcolor{keywordflow}{case} LWS\_CALLBACK\_WSI\_DESTROY:}
\DoxyCodeLine{01065             conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}} = NULL;}
\DoxyCodeLine{01066             \textcolor{keywordflow}{break};}
\DoxyCodeLine{01067             }
\DoxyCodeLine{01068         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01069             \textcolor{keywordflow}{break};}
\DoxyCodeLine{01070     \}}
\DoxyCodeLine{01071     }
\DoxyCodeLine{01072     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{01073 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_ac5c31c457dc3042f85a620d7998ebeee_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_ad3afe1c77e8b8f26a8281186379790a1}\label{library_8c_ad3afe1c77e8b8f26a8281186379790a1}} 
\index{library.c@{library.c}!obsws\_cleanup@{obsws\_cleanup}}
\index{obsws\_cleanup@{obsws\_cleanup}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_cleanup()}{obsws\_cleanup()}}
{\footnotesize\ttfamily void obsws\+\_\+cleanup (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Clean up library resources. 

Cleanup the OBS Web\+Socket library.

Call this when you\textquotesingle{}re done with the library to deallocate Open\+SSL resources. This is a counterpart to \mbox{\hyperlink{library_8h_aff3d6c035330741df84552800c0d0124}{obsws\+\_\+init()}}.

Important\+: Make sure all obsws\+\_\+connection\+\_\+t objects have been disconnected and freed via \mbox{\hyperlink{library_8h_aa8389ba6731e01a9426bd921180b7195}{obsws\+\_\+disconnect()}} before calling this. If not, you might have dangling references and resource leaks.

Thread safety\+: This function is thread-\/safe and idempotent (safe to call multiple times). It checks g\+\_\+library\+\_\+initialized before doing anything.

Note\+: This is optional on program exit because the OS will clean up memory anyway. But it\textquotesingle{}s good practice for\+:
\begin{DoxyItemize}
\item Library consumers that need clean shutdown
\item Memory leak detectors / Valgrind tests
\item Programs that unload the library
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_aff3d6c035330741df84552800c0d0124}{obsws\+\_\+init}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01237}{1237}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01237                          \{}
\DoxyCodeLine{01238     pthread\_mutex\_lock(\&\mbox{\hyperlink{library_8c_ad5f633670e2eea3285c1867570a33cbc}{g\_init\_mutex}});}
\DoxyCodeLine{01239     }
\DoxyCodeLine{01240     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}{g\_library\_initialized}}) \{}
\DoxyCodeLine{01241         pthread\_mutex\_unlock(\&\mbox{\hyperlink{library_8c_ad5f633670e2eea3285c1867570a33cbc}{g\_init\_mutex}});}
\DoxyCodeLine{01242         \textcolor{keywordflow}{return};}
\DoxyCodeLine{01243     \}}
\DoxyCodeLine{01244     }
\DoxyCodeLine{01245     EVP\_cleanup();}
\DoxyCodeLine{01246     \mbox{\hyperlink{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}{g\_library\_initialized}} = \textcolor{keyword}{false};}
\DoxyCodeLine{01247     }
\DoxyCodeLine{01248     pthread\_mutex\_unlock(\&\mbox{\hyperlink{library_8c_ad5f633670e2eea3285c1867570a33cbc}{g\_init\_mutex}});}
\DoxyCodeLine{01249 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a1f1c69172bbf706ac225b718797d30c6}\label{library_8c_a1f1c69172bbf706ac225b718797d30c6}} 
\index{library.c@{library.c}!obsws\_config\_init@{obsws\_config\_init}}
\index{obsws\_config\_init@{obsws\_config\_init}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_config\_init()}{obsws\_config\_init()}}
{\footnotesize\ttfamily void obsws\+\_\+config\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structobsws__config__t}{obsws\+\_\+config\+\_\+t}} $\ast$}]{config }\end{DoxyParamCaption})}



Initialize a connection configuration structure with safe defaults. 

Create a default configuration structure with reasonable defaults.

Before calling \mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect()}}, you create an \mbox{\hyperlink{structobsws__config__t}{obsws\+\_\+config\+\_\+t}} structure with the connection parameters. This function initializes that structure with sensible defaults so you only need to change what\textquotesingle{}s different for your use case.

Default values set\+:
\begin{DoxyItemize}
\item port\+: 4455 (OBS Web\+Socket v5 default port)
\item use\+\_\+ssl\+: false (OBS uses ws\+://, not wss\+://)
\item connect\+\_\+timeout\+\_\+ms\+: 5000 (5 seconds to connect)
\item recv\+\_\+timeout\+\_\+ms\+: 5000 (5 seconds to receive each message)
\item send\+\_\+timeout\+\_\+ms\+: 5000 (5 seconds to send each message)
\item ping\+\_\+interval\+\_\+ms\+: 10000 (send ping every 10 seconds)
\item ping\+\_\+timeout\+\_\+ms\+: 5000 (expect pong within 5 seconds)
\item auto\+\_\+reconnect\+: true (reconnect automatically if connection drops)
\item reconnect\+\_\+delay\+\_\+ms\+: 1000 (start with 1 second delay)
\item max\+\_\+reconnect\+\_\+delay\+\_\+ms\+: 30000 (max wait is 30 seconds)
\item max\+\_\+reconnect\+\_\+attempts\+: 0 (infinite attempts)
\end{DoxyItemize}

After calling this, you typically set\+:
\begin{DoxyItemize}
\item config.\+host = \char`\"{}localhost\char`\"{} (where OBS is running)
\item config.\+password = \char`\"{}your\+\_\+password\char`\"{} (if OBS has auth enabled)
\item config.\+event\+\_\+callback = your\+\_\+callback\+\_\+func (to receive events)
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em config} & Pointer to structure to initialize (must not be NULL)\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01367}{1367}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01367                                                \{}
\DoxyCodeLine{01368     memset(config, 0, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structobsws__config__t}{obsws\_config\_t}}));}
\DoxyCodeLine{01369     }
\DoxyCodeLine{01370     config-\/>\mbox{\hyperlink{structobsws__config__t_a7355cf2fb949f6d4391b6c2c605c9073}{port}} = 4455;}
\DoxyCodeLine{01371     config-\/>\mbox{\hyperlink{structobsws__config__t_a1070992d75f19a3fd4567754d37b9290}{use\_ssl}} = \textcolor{keyword}{false};}
\DoxyCodeLine{01372     config-\/>\mbox{\hyperlink{structobsws__config__t_ab7ca748ce58419a7c8b6b6dc440d3387}{connect\_timeout\_ms}} = 5000;}
\DoxyCodeLine{01373     config-\/>\mbox{\hyperlink{structobsws__config__t_a6439a4274026273ba5fb9786c90daa93}{recv\_timeout\_ms}} = 5000;}
\DoxyCodeLine{01374     config-\/>\mbox{\hyperlink{structobsws__config__t_a5e99af1526aaa66f76b71c3948b5b294}{send\_timeout\_ms}} = 5000;}
\DoxyCodeLine{01375     config-\/>\mbox{\hyperlink{structobsws__config__t_a74ee702373489ff1ea1289e87d50e469}{ping\_interval\_ms}} = 10000;}
\DoxyCodeLine{01376     config-\/>\mbox{\hyperlink{structobsws__config__t_a806599d35ea8d3fc9c7140e76adf1c1a}{ping\_timeout\_ms}} = 5000;}
\DoxyCodeLine{01377     config-\/>\mbox{\hyperlink{structobsws__config__t_a5be1729ffbc28b3e036315f06e80a7a8}{auto\_reconnect}} = \textcolor{keyword}{true};}
\DoxyCodeLine{01378     config-\/>\mbox{\hyperlink{structobsws__config__t_a5ccd3a828a3fcad6d6ebedc0324c4aee}{reconnect\_delay\_ms}} = 1000;}
\DoxyCodeLine{01379     config-\/>\mbox{\hyperlink{structobsws__config__t_ae4f46d4b683af271b1ba69e335fb7e3c}{max\_reconnect\_delay\_ms}} = 30000;}
\DoxyCodeLine{01380     config-\/>\mbox{\hyperlink{structobsws__config__t_a1aff4f0ff9ac25c5d63772eb91d443ac}{max\_reconnect\_attempts}} = 0; \textcolor{comment}{/* Infinite */}}
\DoxyCodeLine{01381 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a7ed7225961f0989acb31ebbd9c099626}\label{library_8c_a7ed7225961f0989acb31ebbd9c099626}} 
\index{library.c@{library.c}!obsws\_connect@{obsws\_connect}}
\index{obsws\_connect@{obsws\_connect}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_connect()}{obsws\_connect()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$ obsws\+\_\+connect (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structobsws__config__t}{obsws\+\_\+config\+\_\+t}} $\ast$}]{config }\end{DoxyParamCaption})}



Establish a connection to OBS. 

This is the main entry point for using the library. You provide a configuration structure (initialized with obsws\+\_\+config\+\_\+init and then customized), and this function connects to OBS, authenticates if needed, and spawns a background thread to handle incoming messages and events.

The function returns immediately -\/ it doesn\textquotesingle{}t wait for the connection to complete. Instead, it\+:
\begin{DoxyEnumerate}
\item Creates a connection structure with the provided config
\item Allocates buffers for sending and receiving messages
\item Creates a libwebsockets context and connects to OBS
\item Spawns a background event\+\_\+thread to process Web\+Socket messages
\item Returns the connection handle
\end{DoxyEnumerate}

Connection states\+: The connection progresses through states\+:
\begin{DoxyItemize}
\item DISCONNECTED -\/\texorpdfstring{$>$}{>} CONNECTING (TCP handshake, Web\+Socket upgrade)
\item CONNECTING -\/\texorpdfstring{$>$}{>} AUTHENTICATING (receive HELLO, send IDENTIFY)
\item AUTHENTICATING -\/\texorpdfstring{$>$}{>} CONNECTED (receive IDENTIFIED)
\end{DoxyItemize}

You don\textquotesingle{}t have to wait for CONNECTED state before calling obsws\+\_\+send\+\_\+request, but requests sent while not connected will return OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED.

Memory ownership\+: The connection structure is allocated and owned by this function. You must free it by calling \mbox{\hyperlink{library_8c_aa8389ba6731e01a9426bd921180b7195}{obsws\+\_\+disconnect()}}. Don\textquotesingle{}t free it directly with free() -\/ that will cause memory leaks (threads won\textquotesingle{}t be cleaned up properly).

Error cases\+:
\begin{DoxyItemize}
\item NULL config or config-\/\texorpdfstring{$>$}{>}host\+: Returns NULL
\item libwebsockets context creation fails\+: Returns NULL and logs error
\item Network connection fails\+: Returns valid pointer but connection stays in ERROR state
\item Bad password\+: Returns valid pointer but stays in AUTHENTICATING (never reaches CONNECTED)
\end{DoxyItemize}

Note\+: This function calls \mbox{\hyperlink{library_8c_aff3d6c035330741df84552800c0d0124}{obsws\+\_\+init()}} automatically if the library isn\textquotesingle{}t already initialized.


\begin{DoxyParams}{Parameters}
{\em config} & Pointer to initialized \mbox{\hyperlink{structobsws__config__t}{obsws\+\_\+config\+\_\+t}} with connection parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to new connection handle, or NULL if creation failed
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8c_aa8389ba6731e01a9426bd921180b7195}{obsws\+\_\+disconnect}}, \mbox{\hyperlink{library_8c_a61a10e31041532a9da0c1c1993f84a79}{obsws\+\_\+get\+\_\+state}}, \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01425}{1425}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01425                                                                 \{}
\DoxyCodeLine{01426     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}{g\_library\_initialized}}) \{}
\DoxyCodeLine{01427         \mbox{\hyperlink{library_8c_aff3d6c035330741df84552800c0d0124}{obsws\_init}}();}
\DoxyCodeLine{01428     \}}
\DoxyCodeLine{01429     }
\DoxyCodeLine{01430     \textcolor{keywordflow}{if} (!config || !config-\/>\mbox{\hyperlink{structobsws__config__t_af632161e8b6cf2d7c1baf7fc80859d48}{host}}) \{}
\DoxyCodeLine{01431         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{01432     \}}
\DoxyCodeLine{01433     }
\DoxyCodeLine{01434     \mbox{\hyperlink{structobsws__connection}{obsws\_connection\_t}} *conn = calloc(1, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structobsws__connection}{obsws\_connection\_t}}));}
\DoxyCodeLine{01435     \textcolor{keywordflow}{if} (!conn) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{01436     }
\DoxyCodeLine{01437     \textcolor{comment}{/* Copy configuration */}}
\DoxyCodeLine{01438     memcpy(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}, config, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structobsws__config__t}{obsws\_config\_t}}));}
\DoxyCodeLine{01439     \textcolor{keywordflow}{if} (config-\/>\mbox{\hyperlink{structobsws__config__t_af632161e8b6cf2d7c1baf7fc80859d48}{host}}) conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_af632161e8b6cf2d7c1baf7fc80859d48}{host}} = strdup(config-\/>\mbox{\hyperlink{structobsws__config__t_af632161e8b6cf2d7c1baf7fc80859d48}{host}});}
\DoxyCodeLine{01440     \textcolor{keywordflow}{if} (config-\/>\mbox{\hyperlink{structobsws__config__t_a53ed762a113bb2a27b3ffab06a5c02ee}{password}}) conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a53ed762a113bb2a27b3ffab06a5c02ee}{password}} = strdup(config-\/>\mbox{\hyperlink{structobsws__config__t_a53ed762a113bb2a27b3ffab06a5c02ee}{password}});}
\DoxyCodeLine{01441     }
\DoxyCodeLine{01442     \textcolor{comment}{/* Initialize mutexes */}}
\DoxyCodeLine{01443     pthread\_mutex\_init(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}}, NULL);}
\DoxyCodeLine{01444     pthread\_mutex\_init(\&conn-\/>\mbox{\hyperlink{structobsws__connection_afc665d5d6864f038f551e4e7d4aae679}{send\_mutex}}, NULL);}
\DoxyCodeLine{01445     pthread\_mutex\_init(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}}, NULL);}
\DoxyCodeLine{01446     pthread\_mutex\_init(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}}, NULL);}
\DoxyCodeLine{01447     pthread\_mutex\_init(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}}, NULL);}
\DoxyCodeLine{01448     }
\DoxyCodeLine{01449     \textcolor{comment}{/* Allocate buffers */}}
\DoxyCodeLine{01450     conn-\/>\mbox{\hyperlink{structobsws__connection_ac3cdc6c4de9ae6aed16d3aac13effe78}{recv\_buffer\_size}} = \mbox{\hyperlink{library_8c_a665c5272405e81329a26d2db1a7d5d97}{OBSWS\_DEFAULT\_BUFFER\_SIZE}};}
\DoxyCodeLine{01451     conn-\/>\mbox{\hyperlink{structobsws__connection_a89f2bbc96729ab308290da8959534d18}{recv\_buffer}} = malloc(conn-\/>\mbox{\hyperlink{structobsws__connection_ac3cdc6c4de9ae6aed16d3aac13effe78}{recv\_buffer\_size}});}
\DoxyCodeLine{01452     conn-\/>\mbox{\hyperlink{structobsws__connection_a60f4507eac7295e16ece7c2a97c910d6}{send\_buffer\_size}} = \mbox{\hyperlink{library_8c_a665c5272405e81329a26d2db1a7d5d97}{OBSWS\_DEFAULT\_BUFFER\_SIZE}};}
\DoxyCodeLine{01453     conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}} = malloc(conn-\/>\mbox{\hyperlink{structobsws__connection_a60f4507eac7295e16ece7c2a97c910d6}{send\_buffer\_size}});}
\DoxyCodeLine{01454     }
\DoxyCodeLine{01455     conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}} = \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991af973d2b8b0a498d0bbffb40ccab1ef2d}{OBSWS\_STATE\_DISCONNECTED}};}
\DoxyCodeLine{01456     conn-\/>\mbox{\hyperlink{structobsws__connection_a32b971d76cdd4c2b166ff19135601776}{current\_reconnect\_delay}} = config-\/>\mbox{\hyperlink{structobsws__config__t_a5ccd3a828a3fcad6d6ebedc0324c4aee}{reconnect\_delay\_ms}};}
\DoxyCodeLine{01457     }
\DoxyCodeLine{01458     \textcolor{comment}{/* Create libwebsockets context */}}
\DoxyCodeLine{01459     \textcolor{keyword}{struct }lws\_context\_creation\_info info;}
\DoxyCodeLine{01460     memset(\&info, 0, \textcolor{keyword}{sizeof}(info));}
\DoxyCodeLine{01461     }
\DoxyCodeLine{01462     info.port = CONTEXT\_PORT\_NO\_LISTEN;}
\DoxyCodeLine{01463     info.protocols = \mbox{\hyperlink{library_8c_ad34f3c7a416fe0d9311efdc5715410e1}{protocols}};}
\DoxyCodeLine{01464     info.gid = -\/1;}
\DoxyCodeLine{01465     info.uid = -\/1;}
\DoxyCodeLine{01466     info.options = LWS\_SERVER\_OPTION\_DO\_SSL\_GLOBAL\_INIT;}
\DoxyCodeLine{01467     }
\DoxyCodeLine{01468     conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}} = lws\_create\_context(\&info);}
\DoxyCodeLine{01469     \textcolor{keywordflow}{if} (!conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}}) \{}
\DoxyCodeLine{01470         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Failed to create libwebsockets context"{}});}
\DoxyCodeLine{01471         free(conn-\/>\mbox{\hyperlink{structobsws__connection_a89f2bbc96729ab308290da8959534d18}{recv\_buffer}});}
\DoxyCodeLine{01472         free(conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}});}
\DoxyCodeLine{01473         free(conn);}
\DoxyCodeLine{01474         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{01475     \}}
\DoxyCodeLine{01476     }
\DoxyCodeLine{01477     \textcolor{comment}{/* Connect to OBS */}}
\DoxyCodeLine{01478     \textcolor{keyword}{struct }lws\_client\_connect\_info ccinfo;}
\DoxyCodeLine{01479     memset(\&ccinfo, 0, \textcolor{keyword}{sizeof}(ccinfo));}
\DoxyCodeLine{01480     }
\DoxyCodeLine{01481     ccinfo.context = conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}};}
\DoxyCodeLine{01482     ccinfo.address = conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_af632161e8b6cf2d7c1baf7fc80859d48}{host}};}
\DoxyCodeLine{01483     ccinfo.port = conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a7355cf2fb949f6d4391b6c2c605c9073}{port}};}
\DoxyCodeLine{01484     ccinfo.path = \textcolor{stringliteral}{"{}/"{}};}
\DoxyCodeLine{01485     ccinfo.host = ccinfo.address;}
\DoxyCodeLine{01486     ccinfo.origin = ccinfo.address;}
\DoxyCodeLine{01487     ccinfo.protocol = \mbox{\hyperlink{library_8c_ad34f3c7a416fe0d9311efdc5715410e1}{protocols}}[0].name;}
\DoxyCodeLine{01488     ccinfo.userdata = conn;}
\DoxyCodeLine{01489     }
\DoxyCodeLine{01490     \textcolor{keywordflow}{if} (config-\/>\mbox{\hyperlink{structobsws__config__t_a1070992d75f19a3fd4567754d37b9290}{use\_ssl}}) \{}
\DoxyCodeLine{01491         ccinfo.ssl\_connection = LCCSCF\_USE\_SSL;}
\DoxyCodeLine{01492     \}}
\DoxyCodeLine{01493     }
\DoxyCodeLine{01494     conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}} = lws\_client\_connect\_via\_info(\&ccinfo);}
\DoxyCodeLine{01495     \textcolor{keywordflow}{if} (!conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}}) \{}
\DoxyCodeLine{01496         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9a6a2a374e4af0446011df30bfd09e329e}{OBSWS\_LOG\_ERROR}}, \textcolor{stringliteral}{"{}Failed to initiate connection"{}});}
\DoxyCodeLine{01497         lws\_context\_destroy(conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}});}
\DoxyCodeLine{01498         free(conn-\/>\mbox{\hyperlink{structobsws__connection_a89f2bbc96729ab308290da8959534d18}{recv\_buffer}});}
\DoxyCodeLine{01499         free(conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}});}
\DoxyCodeLine{01500         free(conn);}
\DoxyCodeLine{01501         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{01502     \}}
\DoxyCodeLine{01503     }
\DoxyCodeLine{01504     \textcolor{comment}{/* Start event thread -\/ protect flags with mutex */}}
\DoxyCodeLine{01505     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01506     conn-\/>\mbox{\hyperlink{structobsws__connection_afbc2be09cbcbbe17561e400babd084e2}{thread\_running}} = \textcolor{keyword}{true};}
\DoxyCodeLine{01507     conn-\/>\mbox{\hyperlink{structobsws__connection_a6aa5a0ce7b42fc1cd72385181ca43454}{should\_exit}} = \textcolor{keyword}{false};}
\DoxyCodeLine{01508     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01509     }
\DoxyCodeLine{01510     pthread\_create(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a160a7f93e6caf0da1bc2f4dbe48fbb41}{event\_thread}}, NULL, \mbox{\hyperlink{library_8c_a27739efcea1287611c82ff3e8c88d7b7}{event\_thread\_func}}, conn);}
\DoxyCodeLine{01511     }
\DoxyCodeLine{01512     \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}Connecting to OBS at \%s:\%d"{}}, config-\/>\mbox{\hyperlink{structobsws__config__t_af632161e8b6cf2d7c1baf7fc80859d48}{host}}, config-\/>\mbox{\hyperlink{structobsws__config__t_a7355cf2fb949f6d4391b6c2c605c9073}{port}});}
\DoxyCodeLine{01513     }
\DoxyCodeLine{01514     \textcolor{keywordflow}{return} conn;}
\DoxyCodeLine{01515 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a7ed7225961f0989acb31ebbd9c099626_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a3682ffd7f6175dbc796f5750172c99bf}\label{library_8c_a3682ffd7f6175dbc796f5750172c99bf}} 
\index{library.c@{library.c}!obsws\_debug@{obsws\_debug}}
\index{obsws\_debug@{obsws\_debug}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_debug()}{obsws\_debug()}}
{\footnotesize\ttfamily static void obsws\+\_\+debug (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}}}]{min\+\_\+level,  }\item[{const char $\ast$}]{format,  }\item[{}]{... }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00302}{302}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00302                                                                                                           \{}
\DoxyCodeLine{00303     \textcolor{comment}{/* Only output if global debug level is at or above the minimum for this message */}}
\DoxyCodeLine{00304     \textcolor{keywordflow}{if} (\mbox{\hyperlink{library_8c_abf3a9f2c8c4082f1e6b67daddd8a5931}{g\_debug\_level}} < min\_level) \{}
\DoxyCodeLine{00305         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00306     \}}
\DoxyCodeLine{00307     }
\DoxyCodeLine{00308     \textcolor{comment}{/* Format with a larger buffer for JSON and other verbose output */}}
\DoxyCodeLine{00309     \textcolor{keywordtype}{char} message[4096];}
\DoxyCodeLine{00310     va\_list args;}
\DoxyCodeLine{00311     va\_start(args, format);}
\DoxyCodeLine{00312     vsnprintf(message, \textcolor{keyword}{sizeof}(message), format, args);}
\DoxyCodeLine{00313     va\_end(args);}
\DoxyCodeLine{00314     }
\DoxyCodeLine{00315     \textcolor{comment}{/* Route through the callback as DEBUG-\/level logs */}}
\DoxyCodeLine{00316     \textcolor{keywordflow}{if} (conn \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a14b921ef2d0ad722bd6020da6a708136}{log\_callback}}) \{}
\DoxyCodeLine{00317         conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a14b921ef2d0ad722bd6020da6a708136}{log\_callback}}(\mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9aa69cfac4b3acbd5968bfab9ef5759cd2}{OBSWS\_LOG\_DEBUG}}, message, conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_af272f38a8f4ca535939766cebacf0b8f}{user\_data}});}
\DoxyCodeLine{00318     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00319         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *debug\_level\_str[] = \{\textcolor{stringliteral}{"{}NONE"{}}, \textcolor{stringliteral}{"{}LOW"{}}, \textcolor{stringliteral}{"{}MED"{}}, \textcolor{stringliteral}{"{}HIGH"{}}\};}
\DoxyCodeLine{00320         fprintf(stderr, \textcolor{stringliteral}{"{}[DEBUG-\/\%s] \%s\(\backslash\)n"{}}, debug\_level\_str[min\_level], message);}
\DoxyCodeLine{00321     \}}
\DoxyCodeLine{00322 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a3682ffd7f6175dbc796f5750172c99bf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_aa8389ba6731e01a9426bd921180b7195}\label{library_8c_aa8389ba6731e01a9426bd921180b7195}} 
\index{library.c@{library.c}!obsws\_disconnect@{obsws\_disconnect}}
\index{obsws\_disconnect@{obsws\_disconnect}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_disconnect()}{obsws\_disconnect()}}
{\footnotesize\ttfamily void obsws\+\_\+disconnect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn }\end{DoxyParamCaption})}



Disconnect from OBS and clean up connection resources. 

Disconnect and destroy a connection.

This is the counterpart to \mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect()}}. It cleanly shuts down the connection, stops the background event thread, and frees all allocated resources.

The function performs these steps\+:
\begin{DoxyEnumerate}
\item Signal the event\+\_\+thread to stop by setting should\+\_\+exit flag
\item Wait for the event\+\_\+thread to actually exit using pthread\+\_\+join()
\item Send a normal Web\+Socket close frame to OBS (if connected)
\item Destroy the libwebsockets context
\item Free all pending requests (they won\textquotesingle{}t get responses now, but don\textquotesingle{}t leak memory)
\item Free buffers, config, authentication data
\item Destroy all mutexes and condition variables
\item Free the connection structure
\end{DoxyEnumerate}

After calling this, the connection pointer is invalid. Don\textquotesingle{}t use it again.

Safe to call multiple times\+: If you call it twice, the second call will be a no-\/op (because conn will be NULL).

Safe to call even if connection never fully established\+: If you disconnect while in CONNECTING or AUTHENTICATING state, everything is still cleaned up.

Important\+: This function blocks until the event\+\_\+thread exits. If you have a callback that\textquotesingle{}s blocked, this will deadlock. Make sure your callbacks don\textquotesingle{}t block!


\begin{DoxyParams}{Parameters}
{\em conn} & The connection to close (can be NULL -\/ safe to call)\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01549}{1549}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01549                                                 \{}
\DoxyCodeLine{01550     \textcolor{keywordflow}{if} (!conn) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01551     }
\DoxyCodeLine{01552     \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}Disconnecting from OBS"{}});}
\DoxyCodeLine{01553     }
\DoxyCodeLine{01554     \textcolor{comment}{/* Stop event thread -\/ protect flag with mutex */}}
\DoxyCodeLine{01555     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01556     conn-\/>\mbox{\hyperlink{structobsws__connection_a6aa5a0ce7b42fc1cd72385181ca43454}{should\_exit}} = \textcolor{keyword}{true};}
\DoxyCodeLine{01557     \textcolor{keywordtype}{bool} thread\_was\_running = conn-\/>\mbox{\hyperlink{structobsws__connection_afbc2be09cbcbbe17561e400babd084e2}{thread\_running}};}
\DoxyCodeLine{01558     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01559     }
\DoxyCodeLine{01560     \textcolor{keywordflow}{if} (thread\_was\_running) \{}
\DoxyCodeLine{01561         pthread\_join(conn-\/>\mbox{\hyperlink{structobsws__connection_a160a7f93e6caf0da1bc2f4dbe48fbb41}{event\_thread}}, NULL);}
\DoxyCodeLine{01562     \}}
\DoxyCodeLine{01563     }
\DoxyCodeLine{01564     \textcolor{comment}{/* Close WebSocket -\/ only if connected */}}
\DoxyCodeLine{01565     \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}} \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}} == \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991adbaae08035175b470fb9f543414672b8}{OBSWS\_STATE\_CONNECTED}}) \{}
\DoxyCodeLine{01566         lws\_close\_reason(conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}}, LWS\_CLOSE\_STATUS\_NORMAL, NULL, 0);}
\DoxyCodeLine{01567     \}}
\DoxyCodeLine{01568     }
\DoxyCodeLine{01569     \textcolor{comment}{/* Cleanup libwebsockets */}}
\DoxyCodeLine{01570     \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}}) \{}
\DoxyCodeLine{01571         lws\_context\_destroy(conn-\/>\mbox{\hyperlink{structobsws__connection_a2f876a0ab0ad0e5e012444a806aa3490}{lws\_context}});}
\DoxyCodeLine{01572     \}}
\DoxyCodeLine{01573     }
\DoxyCodeLine{01574     \textcolor{comment}{/* Free pending requests */}}
\DoxyCodeLine{01575     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{01576     \mbox{\hyperlink{structpending__request}{pending\_request\_t}} *req = conn-\/>\mbox{\hyperlink{structobsws__connection_acc0664cafa773ffe211ffe993c6ac8af}{pending\_requests}};}
\DoxyCodeLine{01577     \textcolor{keywordflow}{while} (req) \{}
\DoxyCodeLine{01578         \mbox{\hyperlink{structpending__request}{pending\_request\_t}} *next = req-\/>\mbox{\hyperlink{structpending__request_a49161e43ef29129c11fe643e85338df2}{next}};}
\DoxyCodeLine{01579         \textcolor{keywordflow}{if} (req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}}) \{}
\DoxyCodeLine{01580             \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\_response\_free}}(req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}});}
\DoxyCodeLine{01581         \}}
\DoxyCodeLine{01582         pthread\_mutex\_destroy(\&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{01583         pthread\_cond\_destroy(\&req-\/>\mbox{\hyperlink{structpending__request_a619500d05293ec1f654ea803139941de}{cond}});}
\DoxyCodeLine{01584         free(req);}
\DoxyCodeLine{01585         req = next;}
\DoxyCodeLine{01586     \}}
\DoxyCodeLine{01587     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{01588     }
\DoxyCodeLine{01589     \textcolor{comment}{/* Free resources */}}
\DoxyCodeLine{01590     free(conn-\/>\mbox{\hyperlink{structobsws__connection_a89f2bbc96729ab308290da8959534d18}{recv\_buffer}});}
\DoxyCodeLine{01591     free(conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}});}
\DoxyCodeLine{01592     free((\textcolor{keywordtype}{char} *)conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_af632161e8b6cf2d7c1baf7fc80859d48}{host}});}
\DoxyCodeLine{01593     free((\textcolor{keywordtype}{char} *)conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a53ed762a113bb2a27b3ffab06a5c02ee}{password}});}
\DoxyCodeLine{01594     free(conn-\/>\mbox{\hyperlink{structobsws__connection_a99dd8596f842d976297c91a7e101b9f4}{challenge}});}
\DoxyCodeLine{01595     free(conn-\/>\mbox{\hyperlink{structobsws__connection_a172b9304975dc52f9c962e0592f20330}{salt}});}
\DoxyCodeLine{01596     free(conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}});}
\DoxyCodeLine{01597     }
\DoxyCodeLine{01598     \textcolor{comment}{/* Destroy mutexes */}}
\DoxyCodeLine{01599     pthread\_mutex\_destroy(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01600     pthread\_mutex\_destroy(\&conn-\/>\mbox{\hyperlink{structobsws__connection_afc665d5d6864f038f551e4e7d4aae679}{send\_mutex}});}
\DoxyCodeLine{01601     pthread\_mutex\_destroy(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{01602     pthread\_mutex\_destroy(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{01603     pthread\_mutex\_destroy(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{01604     }
\DoxyCodeLine{01605     free(conn);}
\DoxyCodeLine{01606 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=343pt]{d5/d27/library_8c_aa8389ba6731e01a9426bd921180b7195_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a39534944f30eaed9a0f2d7de19be0c3e}\label{library_8c_a39534944f30eaed9a0f2d7de19be0c3e}} 
\index{library.c@{library.c}!obsws\_error\_string@{obsws\_error\_string}}
\index{obsws\_error\_string@{obsws\_error\_string}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_error\_string()}{obsws\_error\_string()}}
{\footnotesize\ttfamily const char $\ast$ obsws\+\_\+error\+\_\+string (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}}}]{error }\end{DoxyParamCaption})}



Convert an error code to a human-\/readable string. 

Utility function for error reporting and logging. Returns a brief English description of each error code.

{\bfseries{Never returns NULL}} Unknown error codes return \char`\"{}\+Unknown error\char`\"{}, so it\textquotesingle{}s always safe to use the returned pointer without NULL checks.

{\bfseries{Example usage\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\_error\_t}} err = \mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(...);}
\DoxyCodeLine{\textcolor{keywordflow}{if} (err != \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}}) \{}
\DoxyCodeLine{    fprintf(stderr, \textcolor{stringliteral}{"{}Error: \%s\(\backslash\)\(\backslash\)n"{}}, \mbox{\hyperlink{library_8h_a39534944f30eaed9a0f2d7de19be0c3e}{obsws\_error\_string}}(err));}
\DoxyCodeLine{\}}

\end{DoxyCode}


{\bfseries{Strings are constants}} Returned strings are statically allocated -\/ do not modify or free them.


\begin{DoxyParams}{Parameters}
{\em error} & The error code to describe \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to a static string describing the error
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02229}{2229}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02229                                                     \{}
\DoxyCodeLine{02230     \textcolor{keywordflow}{switch} (error) \{}
\DoxyCodeLine{02231         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Success"{}};}
\DoxyCodeLine{02232         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a8944fe1379e71d22a82399c21107ebf6}{OBSWS\_ERROR\_INVALID\_PARAM}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Invalid parameter"{}};}
\DoxyCodeLine{02233         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa99054291b32e3476d521ea9efeb83a2}{OBSWS\_ERROR\_CONNECTION\_FAILED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Connection failed"{}};}
\DoxyCodeLine{02234         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a3132520f4e5efcd0e07668b4afcd5c4c}{OBSWS\_ERROR\_AUTH\_FAILED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Authentication failed"{}};}
\DoxyCodeLine{02235         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a852a5a13d07531a60aedc6e3cc1ae86d}{OBSWS\_ERROR\_TIMEOUT}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Timeout"{}};}
\DoxyCodeLine{02236         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6abab3c6691cc119a7b875d967f0fc565f}{OBSWS\_ERROR\_SEND\_FAILED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Send failed"{}};}
\DoxyCodeLine{02237         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a312613cd84331a653e2c1de24b94c52b}{OBSWS\_ERROR\_RECV\_FAILED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Receive failed"{}};}
\DoxyCodeLine{02238         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a72ca999664bea413857d7901acf2d598}{OBSWS\_ERROR\_PARSE\_FAILED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Parse failed"{}};}
\DoxyCodeLine{02239         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6ace2eb9908cf7d65109788a2593582982}{OBSWS\_ERROR\_NOT\_CONNECTED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Not connected"{}};}
\DoxyCodeLine{02240         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a6b4348384a97af637d6361e38a5de052}{OBSWS\_ERROR\_ALREADY\_CONNECTED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Already connected"{}};}
\DoxyCodeLine{02241         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a976f03f9cfc1de7d7172732454829e15}{OBSWS\_ERROR\_OUT\_OF\_MEMORY}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Out of memory"{}};}
\DoxyCodeLine{02242         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aea7cb95255efa1d01e6761d676ab599c}{OBSWS\_ERROR\_SSL\_FAILED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}SSL failed"{}};}
\DoxyCodeLine{02243         \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Unknown error"{}};}
\DoxyCodeLine{02244     \}}
\DoxyCodeLine{02245 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a91bd5ceb5878431131513cb4624e935a}\label{library_8c_a91bd5ceb5878431131513cb4624e935a}} 
\index{library.c@{library.c}!obsws\_get\_current\_scene@{obsws\_get\_current\_scene}}
\index{obsws\_get\_current\_scene@{obsws\_get\_current\_scene}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_get\_current\_scene()}{obsws\_get\_current\_scene()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+get\+\_\+current\+\_\+scene (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{char $\ast$}]{scene\+\_\+name,  }\item[{size\+\_\+t}]{buffer\+\_\+size }\end{DoxyParamCaption})}



Query the currently active scene in OBS. 

This function queries OBS for the active scene name and returns it in the provided buffer. It also updates the local scene cache to keep it synchronized.

{\bfseries{Cache Synchronization}} This function always queries the OBS server (doesn\textquotesingle{}t use cached value). When the response arrives, it updates the cache. This ensures the library\textquotesingle{}s cached scene name stays in sync with the actual OBS state.

{\bfseries{Buffer Management}} The caller provides a buffer. If the scene name is longer than buffer\+\_\+size-\/1, it will be truncated and null-\/terminated. Always check the returned buffer length if you need the full name.

{\bfseries{Thread-\/safety}} The scene\+\_\+mutex protects the cache update, so this is safe to call from any thread. Multiple concurrent calls are safe but will all query OBS (no deduplication).

{\bfseries{Example usage\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{char} scene[256];}
\DoxyCodeLine{\textcolor{keywordflow}{if} (\mbox{\hyperlink{library_8h_a91bd5ceb5878431131513cb4624e935a}{obsws\_get\_current\_scene}}(conn, scene, \textcolor{keyword}{sizeof}(scene)) == \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}}) \{}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}Current scene: \%s\(\backslash\)\(\backslash\)n"{}}, scene);}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (must be in CONNECTED state) \\
\hline
{\em scene\+\_\+name} & Buffer to receive the scene name (must not be NULL) \\
\hline
{\em buffer\+\_\+size} & Size of scene\+\_\+name buffer (must be \texorpdfstring{$>$}{>} 0)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK if scene name retrieved successfully 

OBSWS\+\_\+\+ERROR\+\_\+\+INVALID\+\_\+\+PARAM if conn, scene\+\_\+name is NULL or buffer\+\_\+size is 0 

OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED if connection not ready 

OBSWS\+\_\+\+ERROR\+\_\+\+TIMEOUT if OBS doesn\textquotesingle{}t respond 

OBSWS\+\_\+\+ERROR\+\_\+\+PARSE\+\_\+\+FAILED if response can\textquotesingle{}t be parsed
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8c_a7cb91bbce42b458f267f79b9a7b293bf}{obsws\+\_\+set\+\_\+current\+\_\+scene}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02022}{2022}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02022                                                                                                       \{}
\DoxyCodeLine{02023     \textcolor{keywordflow}{if} (!conn || !scene\_name || buffer\_size == 0) \{}
\DoxyCodeLine{02024         \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a8944fe1379e71d22a82399c21107ebf6}{OBSWS\_ERROR\_INVALID\_PARAM}};}
\DoxyCodeLine{02025     \}}
\DoxyCodeLine{02026     }
\DoxyCodeLine{02027     \mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}} *response = NULL;}
\DoxyCodeLine{02028     \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\_error\_t}} result = \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(conn, \textcolor{stringliteral}{"{}GetCurrentProgramScene"{}}, NULL, \&response, 0);}
\DoxyCodeLine{02029     }
\DoxyCodeLine{02030     \textcolor{keywordflow}{if} (result == \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}} \&\& response \&\& response-\/>\mbox{\hyperlink{structobsws__response__t_abbf2e99faa8fdef1c94bbd174470c821}{success}} \&\& response-\/>\mbox{\hyperlink{structobsws__response__t_a696a1179e1d40c6c31136999846d5902}{response\_data}}) \{}
\DoxyCodeLine{02031         cJSON *data = cJSON\_Parse(response-\/>\mbox{\hyperlink{structobsws__response__t_a696a1179e1d40c6c31136999846d5902}{response\_data}});}
\DoxyCodeLine{02032         \textcolor{keywordflow}{if} (data) \{}
\DoxyCodeLine{02033             cJSON *name = cJSON\_GetObjectItem(data, \textcolor{stringliteral}{"{}currentProgramSceneName"{}});}
\DoxyCodeLine{02034             \textcolor{keywordflow}{if} (name \&\& name-\/>valuestring) \{}
\DoxyCodeLine{02035                 strncpy(scene\_name, name-\/>valuestring, buffer\_size -\/ 1);}
\DoxyCodeLine{02036                 scene\_name[buffer\_size -\/ 1] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{02037                 }
\DoxyCodeLine{02038                 \textcolor{comment}{/* Update cache */}}
\DoxyCodeLine{02039                 pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{02040                 free(conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}});}
\DoxyCodeLine{02041                 conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}} = strdup(name-\/>valuestring);}
\DoxyCodeLine{02042                 pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{02043             \}}
\DoxyCodeLine{02044             cJSON\_Delete(data);}
\DoxyCodeLine{02045         \}}
\DoxyCodeLine{02046     \}}
\DoxyCodeLine{02047     }
\DoxyCodeLine{02048     \textcolor{keywordflow}{if} (response) \{}
\DoxyCodeLine{02049         \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\_response\_free}}(response);}
\DoxyCodeLine{02050     \}}
\DoxyCodeLine{02051     }
\DoxyCodeLine{02052     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{02053 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a91bd5ceb5878431131513cb4624e935a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a17d68299d8070c22f5cb04e2c4af28a1}\label{library_8c_a17d68299d8070c22f5cb04e2c4af28a1}} 
\index{library.c@{library.c}!obsws\_get\_debug\_level@{obsws\_get\_debug\_level}}
\index{obsws\_get\_debug\_level@{obsws\_get\_debug\_level}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_get\_debug\_level()}{obsws\_get\_debug\_level()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}} obsws\+\_\+get\+\_\+debug\+\_\+level (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Get the current debug level. 

Get the current global debug level.

This is a read-\/only query -\/ it doesn\textquotesingle{}t change anything, just returns the current global debug level that was set by \mbox{\hyperlink{library_8h_adde8bcb270d34f560ae99047e0524a1d}{obsws\+\_\+set\+\_\+debug\+\_\+level()}}.

Useful for conditional logging in your application, e.\+g.\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordflow}{if} (\mbox{\hyperlink{library_8h_a17d68299d8070c22f5cb04e2c4af28a1}{obsws\_get\_debug\_level}}() >= \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aa6c8d9d070b4d69beeadf605bc03eee1}{OBSWS\_DEBUG\_MEDIUM}}) \{}
\DoxyCodeLine{    \textcolor{comment}{// do expensive trace operation}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\begin{DoxyReturn}{Returns}
The currently active debug level 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_adde8bcb270d34f560ae99047e0524a1d}{obsws\+\_\+set\+\_\+debug\+\_\+level}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01333}{1333}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01333                                                 \{}
\DoxyCodeLine{01334     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8c_abf3a9f2c8c4082f1e6b67daddd8a5931}{g\_debug\_level}};}
\DoxyCodeLine{01335 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a61a10e31041532a9da0c1c1993f84a79}\label{library_8c_a61a10e31041532a9da0c1c1993f84a79}} 
\index{library.c@{library.c}!obsws\_get\_state@{obsws\_get\_state}}
\index{obsws\_get\_state@{obsws\_get\_state}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_get\_state()}{obsws\_get\_state()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\+\_\+state\+\_\+t}} obsws\+\_\+get\+\_\+state (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn }\end{DoxyParamCaption})}



Get the current connection state. 

Get the detailed current connection state.

Returns one of the connection states\+:
\begin{DoxyItemize}
\item OBSWS\+\_\+\+STATE\+\_\+\+DISCONNECTED\+: Not connected, idle
\item OBSWS\+\_\+\+STATE\+\_\+\+CONNECTING\+: TCP connection established, waiting for Web\+Socket handshake
\item OBSWS\+\_\+\+STATE\+\_\+\+AUTHENTICATING\+: Web\+Socket established, waiting for auth response
\item OBSWS\+\_\+\+STATE\+\_\+\+CONNECTED\+: Connected and ready for requests
\item OBSWS\+\_\+\+STATE\+\_\+\+ERROR\+: Connection encountered an error
\end{DoxyItemize}

State transitions normally follow this flow\+: DISCONNECTED -\/\texorpdfstring{$>$}{>} CONNECTING -\/\texorpdfstring{$>$}{>} AUTHENTICATING -\/\texorpdfstring{$>$}{>} CONNECTED

But with errors, you can also have\+: (any state) -\/\texorpdfstring{$>$}{>} ERROR

You don\textquotesingle{}t usually need to call this -\/ just try to send requests and check the error code. But it\textquotesingle{}s useful for monitoring and debugging.

Thread-\/safe\+: This function locks the state\+\_\+mutex, so it\textquotesingle{}s safe to call from any thread.


\begin{DoxyParams}{Parameters}
{\em conn} & The connection to check (NULL is safe -\/ returns DISCONNECTED) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The current connection state
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_ad9894e72ee8510f4eaf7d42feaf0cf9a}{obsws\+\_\+is\+\_\+connected}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01663}{1663}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01663                                                               \{}
\DoxyCodeLine{01664     \textcolor{keywordflow}{if} (!conn) \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991af973d2b8b0a498d0bbffb40ccab1ef2d}{OBSWS\_STATE\_DISCONNECTED}};}
\DoxyCodeLine{01665     }
\DoxyCodeLine{01666     pthread\_mutex\_lock((pthread\_mutex\_t *)\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01667     \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\_state\_t}} state = conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}};}
\DoxyCodeLine{01668     pthread\_mutex\_unlock((pthread\_mutex\_t *)\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01669     }
\DoxyCodeLine{01670     \textcolor{keywordflow}{return} state;}
\DoxyCodeLine{01671 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a5cce41cb6c70229eaab8b1b3afba57a9}\label{library_8c_a5cce41cb6c70229eaab8b1b3afba57a9}} 
\index{library.c@{library.c}!obsws\_get\_stats@{obsws\_get\_stats}}
\index{obsws\_get\_stats@{obsws\_get\_stats}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_get\_stats()}{obsws\_get\_stats()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+get\+\_\+stats (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{structobsws__stats__t}{obsws\+\_\+stats\+\_\+t}} $\ast$}]{stats }\end{DoxyParamCaption})}



Retrieve performance and connectivity statistics. 

Get connection statistics and performance metrics.

The library maintains statistics about the connection\+:
\begin{DoxyItemize}
\item messages\+\_\+sent / messages\+\_\+received\+: Count of Web\+Socket messages
\item bytes\+\_\+sent / bytes\+\_\+received\+: Total bytes transmitted/received
\item connected\+\_\+since\+: Timestamp of when we reached CONNECTED state
\item reconnect\+\_\+count\+: How many times we\textquotesingle{}ve reconnected (0 if never disconnected)
\end{DoxyItemize}

These can be useful for\+:
\begin{DoxyItemize}
\item Monitoring connection health
\item Detecting stalled connections (if bytes\+\_\+received stops increasing)
\item Debugging and performance profiling
\item Health dashboards or logging
\end{DoxyItemize}

Thread-\/safe\+: This function acquires stats\+\_\+mutex and copies the entire stats structure, so it\textquotesingle{}s safe to call from any thread. The copy operation is atomic from the caller\textquotesingle{}s perspective.

Example usage\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{structobsws__stats__t}{obsws\_stats\_t}} stats;}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a5cce41cb6c70229eaab8b1b3afba57a9}{obsws\_get\_stats}}(conn, \&stats);}
\DoxyCodeLine{printf(\textcolor{stringliteral}{"{}Received \%zu messages, \%zu bytes\(\backslash\)\(\backslash\)n"{}}, }
\DoxyCodeLine{       stats.\mbox{\hyperlink{structobsws__stats__t_acbd2023849f8049c705c4cbff567119b}{messages\_received}}, stats.\mbox{\hyperlink{structobsws__stats__t_ae29f4f06b24960c6802aefd3f1627b4f}{bytes\_received}});}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em conn} & The connection to query (NULL returns error) \\
\hline
{\em stats} & Pointer to stats structure to fill (must not be NULL) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK on success, OBSWS\+\_\+\+ERROR\+\_\+\+INVALID\+\_\+\+PARAM if conn or stats is NULL
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structobsws__stats__t}{obsws\+\_\+stats\+\_\+t}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01706}{1706}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01706                                                                                     \{}
\DoxyCodeLine{01707     \textcolor{keywordflow}{if} (!conn || !stats) \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a8944fe1379e71d22a82399c21107ebf6}{OBSWS\_ERROR\_INVALID\_PARAM}};}
\DoxyCodeLine{01708     }
\DoxyCodeLine{01709     pthread\_mutex\_lock((pthread\_mutex\_t *)\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{01710     memcpy(stats, \&conn-\/>\mbox{\hyperlink{structobsws__connection_a10b9da03b3a1cb3a6ee0e72387915740}{stats}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structobsws__stats__t}{obsws\_stats\_t}}));}
\DoxyCodeLine{01711     pthread\_mutex\_unlock((pthread\_mutex\_t *)\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{01712     }
\DoxyCodeLine{01713     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}};}
\DoxyCodeLine{01714 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_aff3d6c035330741df84552800c0d0124}\label{library_8c_aff3d6c035330741df84552800c0d0124}} 
\index{library.c@{library.c}!obsws\_init@{obsws\_init}}
\index{obsws\_init@{obsws\_init}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_init()}{obsws\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize the libwsv5 library. 

Initialize the OBS Web\+Socket library.

This function must be called before creating any connections. It\+:
\begin{DoxyEnumerate}
\item Initializes Open\+SSL (EVP library for hashing)
\item Seeds the random number generator for UUID generation
\item Sets the global g\+\_\+library\+\_\+initialized flag
\end{DoxyEnumerate}

Thread safety\+: This function is thread-\/safe. Multiple threads can call it simultaneously, and only one will actually do the initialization (protected by g\+\_\+init\+\_\+mutex). Subsequent calls are no-\/ops.

Note\+: \mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect()}} will call this automatically if you forget, so you don\textquotesingle{}t {\itshape have} to call it explicitly. But doing so allows you to initialize in a controlled way, separate from connection creation.

Cleanup\+: When you\textquotesingle{}re done with the library, call \mbox{\hyperlink{library_8h_ad3afe1c77e8b8f26a8281186379790a1}{obsws\+\_\+cleanup()}} to deallocate resources. This is technically optional on program exit (the OS cleans up anyway), but good practice for testing and library shutdown.

\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK always (initialization cannot fail in the current design)
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_ad3afe1c77e8b8f26a8281186379790a1}{obsws\+\_\+cleanup}}, \mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01196}{1196}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01196                                \{}
\DoxyCodeLine{01197     pthread\_mutex\_lock(\&\mbox{\hyperlink{library_8c_ad5f633670e2eea3285c1867570a33cbc}{g\_init\_mutex}});}
\DoxyCodeLine{01198     }
\DoxyCodeLine{01199     \textcolor{keywordflow}{if} (\mbox{\hyperlink{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}{g\_library\_initialized}}) \{}
\DoxyCodeLine{01200         pthread\_mutex\_unlock(\&\mbox{\hyperlink{library_8c_ad5f633670e2eea3285c1867570a33cbc}{g\_init\_mutex}});}
\DoxyCodeLine{01201         \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}};}
\DoxyCodeLine{01202     \}}
\DoxyCodeLine{01203     }
\DoxyCodeLine{01204     \textcolor{comment}{/* Initialize OpenSSL */}}
\DoxyCodeLine{01205     OpenSSL\_add\_all\_algorithms();}
\DoxyCodeLine{01206     }
\DoxyCodeLine{01207     \textcolor{comment}{/* Seed random number generator */}}
\DoxyCodeLine{01208     srand(time(NULL));}
\DoxyCodeLine{01209     }
\DoxyCodeLine{01210     \mbox{\hyperlink{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}{g\_library\_initialized}} = \textcolor{keyword}{true};}
\DoxyCodeLine{01211     pthread\_mutex\_unlock(\&\mbox{\hyperlink{library_8c_ad5f633670e2eea3285c1867570a33cbc}{g\_init\_mutex}});}
\DoxyCodeLine{01212     }
\DoxyCodeLine{01213     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}};}
\DoxyCodeLine{01214 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{d5/d27/library_8c_aff3d6c035330741df84552800c0d0124_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_ad9894e72ee8510f4eaf7d42feaf0cf9a}\label{library_8c_ad9894e72ee8510f4eaf7d42feaf0cf9a}} 
\index{library.c@{library.c}!obsws\_is\_connected@{obsws\_is\_connected}}
\index{obsws\_is\_connected@{obsws\_is\_connected}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_is\_connected()}{obsws\_is\_connected()}}
{\footnotesize\ttfamily bool obsws\+\_\+is\+\_\+connected (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn }\end{DoxyParamCaption})}



Check if a connection is actively connected to OBS. 

Check if connection is currently authenticated and ready to use.

Convenience function that returns true if the connection is in CONNECTED state and false otherwise. Useful for checking before sending requests.

Thread-\/safe\+: This function locks the state\+\_\+mutex before checking, so it\textquotesingle{}s safe to call from any thread.

Return value\+: The connection must be in OBSWS\+\_\+\+STATE\+\_\+\+CONNECTED to return true. If it\textquotesingle{}s CONNECTING, AUTHENTICATING, ERROR, or DISCONNECTED, this returns false.


\begin{DoxyParams}{Parameters}
{\em conn} & The connection to check (NULL is safe -\/ returns false) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if connected, false otherwise
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a61a10e31041532a9da0c1c1993f84a79}{obsws\+\_\+get\+\_\+state}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01625}{1625}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01625                                                         \{}
\DoxyCodeLine{01626     \textcolor{keywordflow}{if} (!conn) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01627     }
\DoxyCodeLine{01628     \textcolor{comment}{/* Thread-\/safe state check */}}
\DoxyCodeLine{01629     pthread\_mutex\_lock((pthread\_mutex\_t *)\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01630     \textcolor{keywordtype}{bool} connected = (conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}} == \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991adbaae08035175b470fb9f543414672b8}{OBSWS\_STATE\_CONNECTED}});}
\DoxyCodeLine{01631     pthread\_mutex\_unlock((pthread\_mutex\_t *)\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{01632     }
\DoxyCodeLine{01633     \textcolor{keywordflow}{return} connected;}
\DoxyCodeLine{01634 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a1d8529feb33753ebb45d896c4c125642}\label{library_8c_a1d8529feb33753ebb45d896c4c125642}} 
\index{library.c@{library.c}!obsws\_log@{obsws\_log}}
\index{obsws\_log@{obsws\_log}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_log()}{obsws\_log()}}
{\footnotesize\ttfamily static void obsws\+\_\+log (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9}{obsws\+\_\+log\+\_\+level\+\_\+t}}}]{level,  }\item[{const char $\ast$}]{format,  }\item[{}]{... }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00270}{270}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00270                                                                                                   \{}
\DoxyCodeLine{00271     \textcolor{comment}{/* Early exit if this message is too verbose */}}
\DoxyCodeLine{00272     \textcolor{keywordflow}{if} (level > \mbox{\hyperlink{library_8c_abaccf3944be55af2f72ebbb713c77706}{g\_log\_level}}) \{}
\DoxyCodeLine{00273         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00274     \}}
\DoxyCodeLine{00275     }
\DoxyCodeLine{00276     \textcolor{comment}{/* Format the message using printf-\/style arguments */}}
\DoxyCodeLine{00277     \textcolor{keywordtype}{char} message[1024];}
\DoxyCodeLine{00278     va\_list args;}
\DoxyCodeLine{00279     va\_start(args, format);}
\DoxyCodeLine{00280     vsnprintf(message, \textcolor{keyword}{sizeof}(message), format, args);}
\DoxyCodeLine{00281     va\_end(args);}
\DoxyCodeLine{00282     }
\DoxyCodeLine{00283     \textcolor{comment}{/* Route to user callback or stderr. The callback lets the user handle logging}}
\DoxyCodeLine{00284 \textcolor{comment}{       however they want -\/ write to file, send to logging service, etc. */}}
\DoxyCodeLine{00285     \textcolor{keywordflow}{if} (conn \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a14b921ef2d0ad722bd6020da6a708136}{log\_callback}}) \{}
\DoxyCodeLine{00286         conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a14b921ef2d0ad722bd6020da6a708136}{log\_callback}}(level, message, conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_af272f38a8f4ca535939766cebacf0b8f}{user\_data}});}
\DoxyCodeLine{00287     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00288         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *level\_str[] = \{\textcolor{stringliteral}{"{}NONE"{}}, \textcolor{stringliteral}{"{}ERROR"{}}, \textcolor{stringliteral}{"{}WARN"{}}, \textcolor{stringliteral}{"{}INFO"{}}, \textcolor{stringliteral}{"{}DEBUG"{}}\};}
\DoxyCodeLine{00289         fprintf(stderr, \textcolor{stringliteral}{"{}[OBSWS-\/\%s] \%s\(\backslash\)n"{}}, level\_str[level], message);}
\DoxyCodeLine{00290     \}}
\DoxyCodeLine{00291 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a1d8529feb33753ebb45d896c4c125642_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_abe53062a781ca1cd537f799c075b3e2e}\label{library_8c_abe53062a781ca1cd537f799c075b3e2e}} 
\index{library.c@{library.c}!obsws\_process\_events@{obsws\_process\_events}}
\index{obsws\_process\_events@{obsws\_process\_events}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_process\_events()}{obsws\_process\_events()}}
{\footnotesize\ttfamily int obsws\+\_\+process\+\_\+events (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{uint32\+\_\+t}]{timeout\+\_\+ms }\end{DoxyParamCaption})}



Process pending Web\+Socket events (compatibility function). 

Process pending events from the Web\+Socket connection.

This function is provided for API compatibility with single-\/threaded applications. However, the libwsv5 library uses a background event\+\_\+thread by default, so this function is usually not needed -\/ events are processed automatically in the background.

{\bfseries{Background Event Processing\+:}} By design, all Web\+Socket messages (events, responses, etc.) are processed by the background event\+\_\+thread. This thread\+:
\begin{DoxyItemize}
\item Continuously calls lws\+\_\+service() to pump Web\+Socket events
\item Receives incoming messages from OBS
\item Routes responses to waiting callers via condition variables
\item Calls event callbacks for real-\/time events
\item Maintains keep-\/alive pings
\end{DoxyItemize}

Applications don\textquotesingle{}t need to call this function -\/ the thread handles everything.

{\bfseries{What this function does\+:}} Currently, this is mainly for API compatibility. It\+:
\begin{DoxyItemize}
\item Validates the connection object
\item If timeout\+\_\+ms \texorpdfstring{$>$}{>} 0, sleeps for that duration
\item Returns 0 (success)
\end{DoxyItemize}

{\bfseries{When to use\+:}}
\begin{DoxyItemize}
\item Most applications\+: Don\textquotesingle{}t call this -\/ use background thread
\item If you disable background thread\+: Call this in your main loop
\end{DoxyItemize}

{\bfseries{Example (not typical -\/ background thread is recommended)\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{// Not recommended -\/ background thread is better}}
\DoxyCodeLine{\textcolor{keywordflow}{while} (app\_running) \{}
\DoxyCodeLine{    \mbox{\hyperlink{library_8h_abe53062a781ca1cd537f799c075b3e2e}{obsws\_process\_events}}(conn, 100);  \textcolor{comment}{// Check every 100ms}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Better approach -\/ let background thread handle it\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\_connect}}(conn, \textcolor{stringliteral}{"{}localhost"{}}, 4455, \textcolor{stringliteral}{"{}password"{}});}
\DoxyCodeLine{\textcolor{comment}{// Background thread processes events automatically}}
\DoxyCodeLine{\textcolor{keywordflow}{while} (app\_running) \{}
\DoxyCodeLine{    \textcolor{comment}{// Your application code -\/ no need to call process\_events}}
\DoxyCodeLine{\}}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_aa8389ba6731e01a9426bd921180b7195}{obsws\_disconnect}}(conn);}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (can be NULL -\/ returns error) \\
\hline
{\em timeout\+\_\+ms} & Sleep duration in milliseconds (0 = don\textquotesingle{}t sleep)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 

OBSWS\+\_\+\+ERROR\+\_\+\+INVALID\+\_\+\+PARAM if conn is NULL
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a7ed7225961f0989acb31ebbd9c099626}{obsws\+\_\+connect}}, \mbox{\hyperlink{library_8h_aa8389ba6731e01a9426bd921180b7195}{obsws\+\_\+disconnect}}, \mbox{\hyperlink{library_8c_a27739efcea1287611c82ff3e8c88d7b7}{event\+\_\+thread\+\_\+func}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02347}{2347}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02347                                                                         \{}
\DoxyCodeLine{02348     \textcolor{keywordflow}{if} (!conn) \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a8944fe1379e71d22a82399c21107ebf6}{OBSWS\_ERROR\_INVALID\_PARAM}};}
\DoxyCodeLine{02349     }
\DoxyCodeLine{02350     \textcolor{comment}{/* Events are processed in the background thread */}}
\DoxyCodeLine{02351     \textcolor{comment}{/* This function is provided for API compatibility */}}
\DoxyCodeLine{02352     \textcolor{keywordflow}{if} (timeout\_ms > 0) \{}
\DoxyCodeLine{02353         \textcolor{keyword}{struct }timespec ts;}
\DoxyCodeLine{02354         ts.tv\_sec = timeout\_ms / 1000;}
\DoxyCodeLine{02355         ts.tv\_nsec = (timeout\_ms \% 1000) * 1000000;}
\DoxyCodeLine{02356         nanosleep(\&ts, NULL);}
\DoxyCodeLine{02357     \}}
\DoxyCodeLine{02358     }
\DoxyCodeLine{02359     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{02360 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}\label{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}} 
\index{library.c@{library.c}!obsws\_response\_free@{obsws\_response\_free}}
\index{obsws\_response\_free@{obsws\_response\_free}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_response\_free()}{obsws\_response\_free()}}
{\footnotesize\ttfamily void obsws\+\_\+response\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$}]{response }\end{DoxyParamCaption})}



Free a response object previously allocated by \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}}. 

Free a response structure and all its allocated memory.

This function safely deallocates all memory associated with a response\+:
\begin{DoxyItemize}
\item The error\+\_\+message string (if present)
\item The response\+\_\+data JSON string (if present) ~\newline

\item The response structure itself
\end{DoxyItemize}

{\bfseries{Safe to call with NULL}} Calling with NULL is safe and does nothing -\/ no crash or error. This allows for simpler cleanup\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}} *resp = NULL;}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(..., \&resp, ...);}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\_response\_free}}(resp);  \textcolor{comment}{// Safe even if send\_request failed}}

\end{DoxyCode}


{\bfseries{Memory ownership}}
\begin{DoxyItemize}
\item \mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}} allocates the response -\/ you must free it
\item High-\/level functions like \mbox{\hyperlink{library_8h_a7cb91bbce42b458f267f79b9a7b293bf}{obsws\+\_\+set\+\_\+current\+\_\+scene()}} can optionally take response ownership or free internally based on parameters
\end{DoxyItemize}

{\bfseries{NOT thread-\/safe}} Each response should only be accessed/freed by one thread. If multiple threads need the response, use higher-\/level synchronization.


\begin{DoxyParams}{Parameters}
{\em response} & Response to free. Can be NULL (does nothing if so).\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request}}, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02195}{2195}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02195                                                      \{}
\DoxyCodeLine{02196     \textcolor{keywordflow}{if} (!response) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02197     }
\DoxyCodeLine{02198     free(response-\/>\mbox{\hyperlink{structobsws__response__t_ab2b3055a84989889d3de28c2ccfd0dac}{error\_message}});}
\DoxyCodeLine{02199     free(response-\/>\mbox{\hyperlink{structobsws__response__t_a696a1179e1d40c6c31136999846d5902}{response\_data}});}
\DoxyCodeLine{02200     free(response);}
\DoxyCodeLine{02201 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a53067e61dc0ddcf1134d46b275d7ce6b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}\label{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}} 
\index{library.c@{library.c}!obsws\_send\_request@{obsws\_send\_request}}
\index{obsws\_send\_request@{obsws\_send\_request}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_send\_request()}{obsws\_send\_request()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+send\+\_\+request (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{const char $\ast$}]{request\+\_\+type,  }\item[{const char $\ast$}]{request\+\_\+data,  }\item[{\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$}]{response,  }\item[{uint32\+\_\+t}]{timeout\+\_\+ms }\end{DoxyParamCaption})}



Send a synchronous request to OBS and wait for the response. 

This is the core function for all OBS operations. It implements the asynchronous request-\/response pattern of the OBS Web\+Socket v5 protocol\+:

{\bfseries{Protocol Flow\+:}}
\begin{DoxyEnumerate}
\item Generate a unique UUID for this request (used to match responses)
\item Create a pending\+\_\+request\+\_\+t to track the in-\/flight operation
\item Build the request JSON with opcode 6 (REQUEST)
\item Send the message via lws\+\_\+write()
\item Block the caller with pthread\+\_\+cond\+\_\+timedwait() until response arrives
\item Return the response to caller (who owns it and must free with obsws\+\_\+response\+\_\+free)
\end{DoxyEnumerate}

{\bfseries{Why synchronous from caller\textquotesingle{}s perspective?}} Although Web\+Socket messages are async at the protocol level, we provide a synchronous API -\/ the caller sends a request and blocks until the response arrives. This is simpler for application code than callback-\/based async APIs.

Behind the scenes, the background event\+\_\+thread continuously processes Web\+Socket messages. When a REQUEST\+\_\+\+RESPONSE (opcode 7) arrives matching a pending request ID, it signals the waiting condition variable, waking up the blocked caller.

{\bfseries{Performance implications\+:}}
\begin{DoxyItemize}
\item Thread-\/safe\+: The main app thread can be blocked in \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}} while the background event\+\_\+thread processes other messages
\item No polling\+: Uses condition variables, not CPU-\/wasting polling loops
\item Can make multiple simultaneous requests from different threads (up to OBSWS\+\_\+\+MAX\+\_\+\+PENDING\+\_\+\+REQUESTS = 256)
\end{DoxyItemize}

{\bfseries{Example usage\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}} *response = NULL;}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\_error\_t}} err = \mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(conn, \textcolor{stringliteral}{"{}SetCurrentProgramScene"{}},}
\DoxyCodeLine{                                       \textcolor{stringliteral}{"{}\{\(\backslash\)"{}sceneName\(\backslash\)"{}: \(\backslash\)"{}Scene1\(\backslash\)"{}\}"{}}, }
\DoxyCodeLine{                                       \&response, 0);}
\DoxyCodeLine{\textcolor{keywordflow}{if} (err == \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}} \&\& response \&\& response-\/>\mbox{\hyperlink{structobsws__response__t_abbf2e99faa8fdef1c94bbd174470c821}{success}}) \{}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}Scene switched successfully\(\backslash\)\(\backslash\)n"{}});}
\DoxyCodeLine{\}}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\_response\_free}}(response);}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (must be in CONNECTED state) \\
\hline
{\em request\+\_\+type} & OBS request type like \char`\"{}\+Get\+Current\+Program\+Scene\char`\"{}, \char`\"{}\+Set\+Current\+Program\+Scene\char`\"{}, etc. \\
\hline
{\em request\+\_\+data} & Optional JSON string with request parameters. NULL for no parameters. Example\+: \char`\"{}\{\textbackslash{}\char`\"{}scene\+Name\textbackslash{}\char`\"{}\+: \textbackslash{}\char`\"{}\+Scene1\textbackslash{}\char`\"{}\}\char`\"{} \\
\hline
{\em response} & Output pointer for the response. Will be allocated by this function. Caller must free with \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free()}}. Can be NULL if caller doesn\textquotesingle{}t need the response (but response is still consumed from server). \\
\hline
{\em timeout\+\_\+ms} & Timeout in milliseconds (0 = use config-\/\texorpdfstring{$>$}{>}recv\+\_\+timeout\+\_\+ms, typically 30000ms)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK if response received (check response-\/\texorpdfstring{$>$}{>}success for operation success) 

OBSWS\+\_\+\+ERROR\+\_\+\+INVALID\+\_\+\+PARAM if conn, request\+\_\+type, or response pointer is NULL 

OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED if connection is not in CONNECTED state 

OBSWS\+\_\+\+ERROR\+\_\+\+OUT\+\_\+\+OF\+\_\+\+MEMORY if pending request allocation fails 

OBSWS\+\_\+\+ERROR\+\_\+\+SEND\+\_\+\+FAILED if message send fails (buffer too small, invalid wsi, etc) 

OBSWS\+\_\+\+ERROR\+\_\+\+TIMEOUT if no response received within timeout\+\_\+ms
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}}, \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free}}, \mbox{\hyperlink{library_8c_a39534944f30eaed9a0f2d7de19be0c3e}{obsws\+\_\+error\+\_\+string}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01776}{1776}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01777                                                                                                              \{}
\DoxyCodeLine{01778     \textcolor{keywordflow}{if} (!conn || !request\_type || !response) \{}
\DoxyCodeLine{01779         \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a8944fe1379e71d22a82399c21107ebf6}{OBSWS\_ERROR\_INVALID\_PARAM}};}
\DoxyCodeLine{01780     \}}
\DoxyCodeLine{01781     }
\DoxyCodeLine{01782     \textcolor{keywordflow}{if} (conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}} != \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991adbaae08035175b470fb9f543414672b8}{OBSWS\_STATE\_CONNECTED}}) \{}
\DoxyCodeLine{01783         \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6ace2eb9908cf7d65109788a2593582982}{OBSWS\_ERROR\_NOT\_CONNECTED}};}
\DoxyCodeLine{01784     \}}
\DoxyCodeLine{01785     }
\DoxyCodeLine{01786     \textcolor{comment}{/* Generate request ID */}}
\DoxyCodeLine{01787     \textcolor{keywordtype}{char} request\_id[\mbox{\hyperlink{library_8c_a25b13264018fd1dc7b1f2bbd93bdc7cc}{OBSWS\_UUID\_LENGTH}}];}
\DoxyCodeLine{01788     \mbox{\hyperlink{library_8c_af79be0fed07182761c923170f4211089}{generate\_uuid}}(request\_id);}
\DoxyCodeLine{01789     }
\DoxyCodeLine{01790     \textcolor{comment}{/* Create pending request */}}
\DoxyCodeLine{01791     \mbox{\hyperlink{structpending__request}{pending\_request\_t}} *req = \mbox{\hyperlink{library_8c_aafc3d1ce3debddcb8e3888c9806e044a}{create\_pending\_request}}(conn, request\_id);}
\DoxyCodeLine{01792     \textcolor{keywordflow}{if} (!req) \{}
\DoxyCodeLine{01793         \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a976f03f9cfc1de7d7172732454829e15}{OBSWS\_ERROR\_OUT\_OF\_MEMORY}};}
\DoxyCodeLine{01794     \}}
\DoxyCodeLine{01795     }
\DoxyCodeLine{01796     \textcolor{comment}{/* Build request JSON */}}
\DoxyCodeLine{01797     cJSON *request = cJSON\_CreateObject();}
\DoxyCodeLine{01798     cJSON\_AddNumberToObject(request, \textcolor{stringliteral}{"{}op"{}}, \mbox{\hyperlink{library_8c_a6c2c324c3b2c49b7febe0b376d6c1045}{OBSWS\_OPCODE\_REQUEST}});}
\DoxyCodeLine{01799     }
\DoxyCodeLine{01800     cJSON *d = cJSON\_CreateObject();}
\DoxyCodeLine{01801     cJSON\_AddStringToObject(d, \textcolor{stringliteral}{"{}requestType"{}}, request\_type);}
\DoxyCodeLine{01802     cJSON\_AddStringToObject(d, \textcolor{stringliteral}{"{}requestId"{}}, request\_id);}
\DoxyCodeLine{01803     }
\DoxyCodeLine{01804     \textcolor{keywordflow}{if} (request\_data) \{}
\DoxyCodeLine{01805         cJSON *data = cJSON\_Parse(request\_data);}
\DoxyCodeLine{01806         \textcolor{keywordflow}{if} (data) \{}
\DoxyCodeLine{01807             cJSON\_AddItemToObject(d, \textcolor{stringliteral}{"{}requestData"{}}, data);}
\DoxyCodeLine{01808         \}}
\DoxyCodeLine{01809     \}}
\DoxyCodeLine{01810     }
\DoxyCodeLine{01811     cJSON\_AddItemToObject(request, \textcolor{stringliteral}{"{}d"{}}, d);}
\DoxyCodeLine{01812     }
\DoxyCodeLine{01813     \textcolor{keywordtype}{char} *message = cJSON\_PrintUnformatted(request);}
\DoxyCodeLine{01814     cJSON\_Delete(request);}
\DoxyCodeLine{01815     }
\DoxyCodeLine{01816     \textcolor{comment}{/* DEBUG\_HIGH: Show request being sent */}}
\DoxyCodeLine{01817     \mbox{\hyperlink{library_8c_a3682ffd7f6175dbc796f5750172c99bf}{obsws\_debug}}(conn, \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668aceb0431d743cdecf0848564f388d51bd}{OBSWS\_DEBUG\_HIGH}}, \textcolor{stringliteral}{"{}Sending request (ID: \%s): \%s"{}}, request\_id, message);}
\DoxyCodeLine{01818     }
\DoxyCodeLine{01819     \textcolor{comment}{/* Send request */}}
\DoxyCodeLine{01820     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_afc665d5d6864f038f551e4e7d4aae679}{send\_mutex}});}
\DoxyCodeLine{01821     \textcolor{keywordtype}{size\_t} len = strlen(message);}
\DoxyCodeLine{01822     \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\_error\_t}} result = \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}};}
\DoxyCodeLine{01823     }
\DoxyCodeLine{01824     \textcolor{keywordflow}{if} (len < conn-\/>send\_buffer\_size -\/ LWS\_PRE \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}}) \{}
\DoxyCodeLine{01825         memcpy(conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}} + LWS\_PRE, message, len);}
\DoxyCodeLine{01826         \textcolor{keywordtype}{int} written = lws\_write(conn-\/>\mbox{\hyperlink{structobsws__connection_aaf49ac1578fc794ee4b01ccbf9edc35a}{wsi}}, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)(conn-\/>\mbox{\hyperlink{structobsws__connection_a14a61d0e27a8cac772ce173dd31d4fb7}{send\_buffer}} + LWS\_PRE), len, LWS\_WRITE\_TEXT);}
\DoxyCodeLine{01827         }
\DoxyCodeLine{01828         \textcolor{keywordflow}{if} (written < 0) \{}
\DoxyCodeLine{01829             result = \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6abab3c6691cc119a7b875d967f0fc565f}{OBSWS\_ERROR\_SEND\_FAILED}};}
\DoxyCodeLine{01830         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01831             pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{01832             conn-\/>\mbox{\hyperlink{structobsws__connection_a10b9da03b3a1cb3a6ee0e72387915740}{stats}}.\mbox{\hyperlink{structobsws__stats__t_a8fcaddd7c5934bcf0a44225bc9a23fa5}{messages\_sent}}++;}
\DoxyCodeLine{01833             conn-\/>\mbox{\hyperlink{structobsws__connection_a10b9da03b3a1cb3a6ee0e72387915740}{stats}}.\mbox{\hyperlink{structobsws__stats__t_a79582a623821723ea9bf86930eb32db2}{bytes\_sent}} += len;}
\DoxyCodeLine{01834             pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_ab29e2a357e95b536a2c79b0990614bc5}{stats\_mutex}});}
\DoxyCodeLine{01835         \}}
\DoxyCodeLine{01836     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01837         result = \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6abab3c6691cc119a7b875d967f0fc565f}{OBSWS\_ERROR\_SEND\_FAILED}};}
\DoxyCodeLine{01838     \}}
\DoxyCodeLine{01839     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_afc665d5d6864f038f551e4e7d4aae679}{send\_mutex}});}
\DoxyCodeLine{01840     }
\DoxyCodeLine{01841     free(message);}
\DoxyCodeLine{01842     }
\DoxyCodeLine{01843     \textcolor{keywordflow}{if} (result != \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}}) \{}
\DoxyCodeLine{01844         \mbox{\hyperlink{library_8c_a700c8a9baa87a3827b399776e811f328}{remove\_pending\_request}}(conn, req);}
\DoxyCodeLine{01845         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{01846     \}}
\DoxyCodeLine{01847     }
\DoxyCodeLine{01848     \textcolor{comment}{/* Wait for response */}}
\DoxyCodeLine{01849     \textcolor{keywordflow}{if} (timeout\_ms == 0) \{}
\DoxyCodeLine{01850         timeout\_ms = conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a6439a4274026273ba5fb9786c90daa93}{recv\_timeout\_ms}};}
\DoxyCodeLine{01851     \}}
\DoxyCodeLine{01852     }
\DoxyCodeLine{01853     \textcolor{keyword}{struct }timespec ts;}
\DoxyCodeLine{01854     clock\_gettime(CLOCK\_REALTIME, \&ts);}
\DoxyCodeLine{01855     ts.tv\_sec += timeout\_ms / 1000;}
\DoxyCodeLine{01856     ts.tv\_nsec += (timeout\_ms \% 1000) * 1000000;}
\DoxyCodeLine{01857     \textcolor{keywordflow}{if} (ts.tv\_nsec >= 1000000000) \{}
\DoxyCodeLine{01858         ts.tv\_sec++;}
\DoxyCodeLine{01859         ts.tv\_nsec -\/= 1000000000;}
\DoxyCodeLine{01860     \}}
\DoxyCodeLine{01861     }
\DoxyCodeLine{01862     pthread\_mutex\_lock(\&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{01863     \textcolor{keywordflow}{while} (!req-\/>\mbox{\hyperlink{structpending__request_af74dd3c97a064175b9dcf3dbfe3665cc}{completed}}) \{}
\DoxyCodeLine{01864         \textcolor{keywordtype}{int} wait\_result = pthread\_cond\_timedwait(\&req-\/>\mbox{\hyperlink{structpending__request_a619500d05293ec1f654ea803139941de}{cond}}, \&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}}, \&ts);}
\DoxyCodeLine{01865         \textcolor{keywordflow}{if} (wait\_result == ETIMEDOUT) \{}
\DoxyCodeLine{01866             pthread\_mutex\_unlock(\&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{01867             \mbox{\hyperlink{library_8c_a700c8a9baa87a3827b399776e811f328}{remove\_pending\_request}}(conn, req);}
\DoxyCodeLine{01868             \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a852a5a13d07531a60aedc6e3cc1ae86d}{OBSWS\_ERROR\_TIMEOUT}};}
\DoxyCodeLine{01869         \}}
\DoxyCodeLine{01870     \}}
\DoxyCodeLine{01871     }
\DoxyCodeLine{01872     *response = req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}};}
\DoxyCodeLine{01873     req-\/>\mbox{\hyperlink{structpending__request_a4b37104673cb81e3f2825c8f6df372ba}{response}} = NULL; \textcolor{comment}{/* Transfer ownership */}}
\DoxyCodeLine{01874     pthread\_mutex\_unlock(\&req-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{01875     }
\DoxyCodeLine{01876     \mbox{\hyperlink{library_8c_a700c8a9baa87a3827b399776e811f328}{remove\_pending\_request}}(conn, req);}
\DoxyCodeLine{01877     }
\DoxyCodeLine{01878     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}};}
\DoxyCodeLine{01879 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_af2fd7f8dd928e03b38a3e2c5b5745417_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_af2fd7f8dd928e03b38a3e2c5b5745417_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a7cb91bbce42b458f267f79b9a7b293bf}\label{library_8c_a7cb91bbce42b458f267f79b9a7b293bf}} 
\index{library.c@{library.c}!obsws\_set\_current\_scene@{obsws\_set\_current\_scene}}
\index{obsws\_set\_current\_scene@{obsws\_set\_current\_scene}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_set\_current\_scene()}{obsws\_set\_current\_scene()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+set\+\_\+current\+\_\+scene (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{const char $\ast$}]{scene\+\_\+name,  }\item[{\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$}]{response }\end{DoxyParamCaption})}



Switch OBS to a specific scene. 

This is a high-\/level convenience function for scene switching. It demonstrates several important design patterns in the library\+:

{\bfseries{Optimization\+: Scene Cache}} Before sending a request to OBS, this function checks the cached current scene. If the requested scene is already active, it returns immediately without network overhead. The cache is maintained by the event thread when Scene\+Changed events arrive.

{\bfseries{Memory Ownership}} If the caller provides response pointer, they receive ownership and must call \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free()}}. If response is NULL, the function frees the response internally. This flexibility allows three usage patterns\+:
\begin{DoxyEnumerate}
\item Check response\+: {\ttfamily obsws\+\_\+set\+\_\+current\+\_\+scene(conn, name, \&resp); if (resp-\/\texorpdfstring{$>$}{>}success) ...}
\item Ignore response\+: {\ttfamily obsws\+\_\+set\+\_\+current\+\_\+scene(conn, name, NULL);} (response is freed internally)
\item Just check error\+: {\ttfamily if (obsws\+\_\+send\+\_\+request(...) != OBSWS\+\_\+\+OK) ...}
\end{DoxyEnumerate}

{\bfseries{Example usage\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{// Pattern 1: Check response details}}
\DoxyCodeLine{\mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}} *response = NULL;}
\DoxyCodeLine{\textcolor{keywordflow}{if} (\mbox{\hyperlink{library_8h_a7cb91bbce42b458f267f79b9a7b293bf}{obsws\_set\_current\_scene}}(conn, \textcolor{stringliteral}{"{}Scene1"{}}, \&response) == \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}} \&\&}
\DoxyCodeLine{    response \&\& response-\/>\mbox{\hyperlink{structobsws__response__t_abbf2e99faa8fdef1c94bbd174470c821}{success}}) \{}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}Switched successfully\(\backslash\)\(\backslash\)n"{}});}
\DoxyCodeLine{\} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}Switch failed: \%s\(\backslash\)\(\backslash\)n"{}}, response ? response-\/>\mbox{\hyperlink{structobsws__response__t_ab2b3055a84989889d3de28c2ccfd0dac}{error\_message}} : \textcolor{stringliteral}{"{}unknown"{}});}
\DoxyCodeLine{\}}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\_response\_free}}(response);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Pattern 2: Ignore response (simpler)}}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a7cb91bbce42b458f267f79b9a7b293bf}{obsws\_set\_current\_scene}}(conn, \textcolor{stringliteral}{"{}Scene1"{}}, NULL);}

\end{DoxyCode}


{\bfseries{Thread-\/safety\+:}}
\begin{DoxyItemize}
\item Scene cache is protected by scene\+\_\+mutex
\item Safe to call from any thread
\item Multiple calls can happen simultaneously (each uses send\+\_\+mutex)
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (must be in CONNECTED state) \\
\hline
{\em scene\+\_\+name} & Name of the scene to switch to. Must not be NULL. \\
\hline
{\em response} & Optional output for response details. If provided, caller owns it and must free with \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free()}}. If NULL, response is freed internally.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK if request sent and response received (check response-\/\texorpdfstring{$>$}{>}success for whether the scene switch actually succeeded in OBS) 

OBSWS\+\_\+\+ERROR\+\_\+\+INVALID\+\_\+\+PARAM if conn or scene\+\_\+name is NULL 

OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED if connection not ready 

OBSWS\+\_\+\+ERROR\+\_\+\+TIMEOUT if no response from OBS
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8c_a91bd5ceb5878431131513cb4624e935a}{obsws\+\_\+get\+\_\+current\+\_\+scene}}, \mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}}, \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01935}{1935}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01935                                                                                                                      \{}
\DoxyCodeLine{01936     \textcolor{keywordflow}{if} (!conn || !scene\_name) \{}
\DoxyCodeLine{01937         \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6a8944fe1379e71d22a82399c21107ebf6}{OBSWS\_ERROR\_INVALID\_PARAM}};}
\DoxyCodeLine{01938     \}}
\DoxyCodeLine{01939     }
\DoxyCodeLine{01940     \textcolor{comment}{/* Check cache to avoid redundant switches */}}
\DoxyCodeLine{01941     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{01942     \textcolor{keywordtype}{bool} already\_current = (conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}} \&\& strcmp(conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}}, scene\_name) == 0);}
\DoxyCodeLine{01943     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{01944     }
\DoxyCodeLine{01945     \textcolor{keywordflow}{if} (already\_current) \{}
\DoxyCodeLine{01946         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9aa69cfac4b3acbd5968bfab9ef5759cd2}{OBSWS\_LOG\_DEBUG}}, \textcolor{stringliteral}{"{}Already on scene: \%s"{}}, scene\_name);}
\DoxyCodeLine{01947         \textcolor{keywordflow}{if} (response) \{}
\DoxyCodeLine{01948             *response = calloc(1, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}}));}
\DoxyCodeLine{01949             (*response)-\/>success = \textcolor{keyword}{true};}
\DoxyCodeLine{01950         \}}
\DoxyCodeLine{01951         \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}};}
\DoxyCodeLine{01952     \}}
\DoxyCodeLine{01953     }
\DoxyCodeLine{01954     cJSON *request\_data = cJSON\_CreateObject();}
\DoxyCodeLine{01955     cJSON\_AddStringToObject(request\_data, \textcolor{stringliteral}{"{}sceneName"{}}, scene\_name);}
\DoxyCodeLine{01956     }
\DoxyCodeLine{01957     \textcolor{keywordtype}{char} *data\_str = cJSON\_PrintUnformatted(request\_data);}
\DoxyCodeLine{01958     cJSON\_Delete(request\_data);}
\DoxyCodeLine{01959     }
\DoxyCodeLine{01960     \mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}} *resp = NULL;}
\DoxyCodeLine{01961     \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\_error\_t}} result = \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(conn, \textcolor{stringliteral}{"{}SetCurrentProgramScene"{}}, data\_str, \&resp, 0);}
\DoxyCodeLine{01962     free(data\_str);}
\DoxyCodeLine{01963     }
\DoxyCodeLine{01964     \textcolor{keywordflow}{if} (result == \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}} \&\& resp \&\& resp-\/>\mbox{\hyperlink{structobsws__response__t_abbf2e99faa8fdef1c94bbd174470c821}{success}}) \{}
\DoxyCodeLine{01965         pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{01966         free(conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}});}
\DoxyCodeLine{01967         conn-\/>\mbox{\hyperlink{structobsws__connection_a887874891a0026e6ad2a2ee2c3c7390a}{current\_scene}} = strdup(scene\_name);}
\DoxyCodeLine{01968         pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a4343875c5de5530580e13fb1b528cf35}{scene\_mutex}});}
\DoxyCodeLine{01969         }
\DoxyCodeLine{01970         \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}Switched to scene: \%s"{}}, scene\_name);}
\DoxyCodeLine{01971     \}}
\DoxyCodeLine{01972     }
\DoxyCodeLine{01973     \textcolor{keywordflow}{if} (response) \{}
\DoxyCodeLine{01974         *response = resp;}
\DoxyCodeLine{01975     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (resp) \{}
\DoxyCodeLine{01976         \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\_response\_free}}(resp);}
\DoxyCodeLine{01977     \}}
\DoxyCodeLine{01978     }
\DoxyCodeLine{01979     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{01980 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a7cb91bbce42b458f267f79b9a7b293bf_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_adde8bcb270d34f560ae99047e0524a1d}\label{library_8c_adde8bcb270d34f560ae99047e0524a1d}} 
\index{library.c@{library.c}!obsws\_set\_debug\_level@{obsws\_set\_debug\_level}}
\index{obsws\_set\_debug\_level@{obsws\_set\_debug\_level}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_set\_debug\_level()}{obsws\_set\_debug\_level()}}
{\footnotesize\ttfamily void obsws\+\_\+set\+\_\+debug\+\_\+level (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}}}]{level }\end{DoxyParamCaption})}



Set the global debug level. 

Set the global debug level for the library.

Debug logging is separate from regular logging. It provides extremely detailed trace information about the Web\+Socket protocol, message parsing, authentication, etc. This is useful during development and troubleshooting.

Debug levels\+:
\begin{DoxyItemize}
\item OBSWS\+\_\+\+DEBUG\+\_\+\+NONE\+: No debug output (fastest)
\item OBSWS\+\_\+\+DEBUG\+\_\+\+LOW\+: Major state transitions and connection events
\item OBSWS\+\_\+\+DEBUG\+\_\+\+MEDIUM\+: Message types and handlers invoked
\item OBSWS\+\_\+\+DEBUG\+\_\+\+HIGH\+: Full message content and every operation
\end{DoxyItemize}

Debug logging is independent of log level. You can have OBSWS\+\_\+\+LOG\+\_\+\+ERROR set (hide non-\/error logs) but still see OBSWS\+\_\+\+DEBUG\+\_\+\+HIGH output.

Performance warning\+: OBSWS\+\_\+\+DEBUG\+\_\+\+HIGH produces enormous output and will slow down the library significantly. Only use during debugging!

Thread safety\+: Same as obsws\+\_\+set\+\_\+log\+\_\+level (modifies global without locking).


\begin{DoxyParams}{Parameters}
{\em level} & The debug verbosity level \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a6720460e577d2afe3c0691a2d6e055e9}{obsws\+\_\+set\+\_\+log\+\_\+level}}, \mbox{\hyperlink{library_8h_a17d68299d8070c22f5cb04e2c4af28a1}{obsws\+\_\+get\+\_\+debug\+\_\+level}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01313}{1313}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01313                                                       \{}
\DoxyCodeLine{01314     \mbox{\hyperlink{library_8c_abf3a9f2c8c4082f1e6b67daddd8a5931}{g\_debug\_level}} = level;}
\DoxyCodeLine{01315 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a6720460e577d2afe3c0691a2d6e055e9}\label{library_8c_a6720460e577d2afe3c0691a2d6e055e9}} 
\index{library.c@{library.c}!obsws\_set\_log\_level@{obsws\_set\_log\_level}}
\index{obsws\_set\_log\_level@{obsws\_set\_log\_level}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_set\_log\_level()}{obsws\_set\_log\_level()}}
{\footnotesize\ttfamily void obsws\+\_\+set\+\_\+log\+\_\+level (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9}{obsws\+\_\+log\+\_\+level\+\_\+t}}}]{level }\end{DoxyParamCaption})}



Set the global log level threshold. 

Set the global log level for the library.

The library logs various messages during operation. This function sets which messages are displayed. All messages at the specified level and higher severity are shown; lower severity messages are hidden.

Levels in increasing severity\+:
\begin{DoxyItemize}
\item OBSWS\+\_\+\+LOG\+\_\+\+DEBUG\+: Low-\/level diagnostic info (too verbose for production)
\item OBSWS\+\_\+\+LOG\+\_\+\+INFO\+: General informational messages (usual choice)
\item OBSWS\+\_\+\+LOG\+\_\+\+WARNING\+: Potentially problematic situations (degraded but working)
\item OBSWS\+\_\+\+LOG\+\_\+\+ERROR\+: Error conditions that need attention
\end{DoxyItemize}

Example\+: If you call obsws\+\_\+set\+\_\+log\+\_\+level(\+OBSWS\+\_\+\+LOG\+\_\+\+WARNING), you\textquotesingle{}ll see only WARNING and ERROR messages, but not INFO or DEBUG messages.

Thread safety\+: This modifies a global variable without locking, so if you might call this from multiple threads, use synchronization externally.


\begin{DoxyParams}{Parameters}
{\em level} & The minimum severity level to display \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_adde8bcb270d34f560ae99047e0524a1d}{obsws\+\_\+set\+\_\+debug\+\_\+level}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l01285}{1285}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01285                                                   \{}
\DoxyCodeLine{01286     \mbox{\hyperlink{library_8c_abaccf3944be55af2f72ebbb713c77706}{g\_log\_level}} = level;}
\DoxyCodeLine{01287 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a8643e2027afb1907122ce4d3bfe65c6e}\label{library_8c_a8643e2027afb1907122ce4d3bfe65c6e}} 
\index{library.c@{library.c}!obsws\_start\_recording@{obsws\_start\_recording}}
\index{obsws\_start\_recording@{obsws\_start\_recording}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_start\_recording()}{obsws\_start\_recording()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+start\+\_\+recording (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$}]{response }\end{DoxyParamCaption})}



Start recording in OBS. 

Tells OBS to begin recording the current scene composition to disk. The recording path and format are determined by OBS settings, not by this library.

This is a convenience wrapper around \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}} using the OBS \char`\"{}\+Start\+Record\char`\"{} request type.

{\bfseries{Return value interpretation\+:}}
\begin{DoxyItemize}
\item OBSWS\+\_\+\+OK\+: Request was sent and OBS responded (check response-\/\texorpdfstring{$>$}{>}success)
\item Other errors\+: Network/connection problem
\end{DoxyItemize}

{\bfseries{Example usage\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{structobsws__response__t}{obsws\_response\_t}} *resp = NULL;}
\DoxyCodeLine{\textcolor{keywordflow}{if} (\mbox{\hyperlink{library_8h_a8643e2027afb1907122ce4d3bfe65c6e}{obsws\_start\_recording}}(conn, \&resp) == \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}} \&\& resp \&\& resp-\/>\mbox{\hyperlink{structobsws__response__t_abbf2e99faa8fdef1c94bbd174470c821}{success}}) \{}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}Recording started\(\backslash\)\(\backslash\)n"{}});}
\DoxyCodeLine{\}}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\_response\_free}}(resp);}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (must be in CONNECTED state) \\
\hline
{\em response} & Optional output for response. Caller owns if provided, must free.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK if response received (check response-\/\texorpdfstring{$>$}{>}success for success) 

OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED if connection not ready 

OBSWS\+\_\+\+ERROR\+\_\+\+TIMEOUT if OBS doesn\textquotesingle{}t respond
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8c_a30001811f4cf8501e006ca46bcb8b329}{obsws\+\_\+stop\+\_\+recording}}, \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request}}, \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02086}{2086}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02086                                                                                            \{}
\DoxyCodeLine{02087     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(conn, \textcolor{stringliteral}{"{}StartRecord"{}}, NULL, response, 0);}
\DoxyCodeLine{02088 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a8643e2027afb1907122ce4d3bfe65c6e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a86a35ee2d7aef7a0569b4111bd663d22}\label{library_8c_a86a35ee2d7aef7a0569b4111bd663d22}} 
\index{library.c@{library.c}!obsws\_start\_streaming@{obsws\_start\_streaming}}
\index{obsws\_start\_streaming@{obsws\_start\_streaming}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_start\_streaming()}{obsws\_start\_streaming()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+start\+\_\+streaming (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$}]{response }\end{DoxyParamCaption})}



Start streaming in OBS. 

Tells OBS to begin streaming to the configured destination (Twitch, You\+Tube, etc). The stream settings (URL, key, bitrate, etc) are determined by OBS settings.

This is a convenience wrapper around \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}} using the OBS \char`\"{}\+Start\+Stream\char`\"{} request type.

{\bfseries{Thread-\/safe\+:}} Safe to call from any thread while connected.


\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (must be in CONNECTED state) \\
\hline
{\em response} & Optional output for response. Caller owns if provided, must free.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK if response received (check response-\/\texorpdfstring{$>$}{>}success for success) 

OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED if connection not ready 

OBSWS\+\_\+\+ERROR\+\_\+\+TIMEOUT if OBS doesn\textquotesingle{}t respond
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8c_a2cfe9b46f435aa7986b5e772b99c464e}{obsws\+\_\+stop\+\_\+streaming}}, \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request}}, \mbox{\hyperlink{library_8c_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02139}{2139}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02139                                                                                            \{}
\DoxyCodeLine{02140     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(conn, \textcolor{stringliteral}{"{}StartStream"{}}, NULL, response, 0);}
\DoxyCodeLine{02141 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a86a35ee2d7aef7a0569b4111bd663d22_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a69f8fcc1732533a2ebe573ac65effa04}\label{library_8c_a69f8fcc1732533a2ebe573ac65effa04}} 
\index{library.c@{library.c}!obsws\_state\_string@{obsws\_state\_string}}
\index{obsws\_state\_string@{obsws\_state\_string}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_state\_string()}{obsws\_state\_string()}}
{\footnotesize\ttfamily const char $\ast$ obsws\+\_\+state\+\_\+string (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\+\_\+state\+\_\+t}}}]{state }\end{DoxyParamCaption})}



Convert a connection state to a human-\/readable string. 

Utility function for logging and debugging. Returns a brief English description of each connection state.

{\bfseries{State Transitions\+:}}
\begin{DoxyItemize}
\item DISCONNECTED\+: Initial state or after disconnect()
\item CONNECTING\+: connect() called, establishing TCP connection
\item AUTHENTICATING\+: TCP connected, performing challenge-\/response auth
\item CONNECTED\+: Auth succeeded, ready for requests
\item ERROR\+: Network error or protocol failure, should reconnect
\end{DoxyItemize}

{\bfseries{Valid transitions\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{DISCONNECTED -\/> CONNECTING -\/> AUTHENTICATING -\/> CONNECTED}
\DoxyCodeLine{CONNECTED -\/> DISCONNECTED (on \textcolor{keyword}{explicit} disconnect)}
\DoxyCodeLine{CONNECTED -\/> ERROR (on network failure)}
\DoxyCodeLine{ERROR -\/> CONNECTING (on reconnect attempt)}

\end{DoxyCode}


{\bfseries{Example usage\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\_state\_t}} state = \mbox{\hyperlink{library_8h_a61a10e31041532a9da0c1c1993f84a79}{obsws\_get\_state}}(conn);}
\DoxyCodeLine{printf(\textcolor{stringliteral}{"{}Connection state: \%s\(\backslash\)\(\backslash\)n"{}}, \mbox{\hyperlink{library_8h_a69f8fcc1732533a2ebe573ac65effa04}{obsws\_state\_string}}(state));}

\end{DoxyCode}


Never returns NULL -\/ unknown states return \char`\"{}\+Unknown\char`\"{}. Returned strings are static -\/ do not modify or free.


\begin{DoxyParams}{Parameters}
{\em state} & The connection state to describe \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to a static string describing the state
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8c_a61a10e31041532a9da0c1c1993f84a79}{obsws\+\_\+get\+\_\+state}}, \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\+\_\+state\+\_\+t}}, \mbox{\hyperlink{library_8c_ad9894e72ee8510f4eaf7d42feaf0cf9a}{obsws\+\_\+is\+\_\+connected}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02282}{2282}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02282                                                     \{}
\DoxyCodeLine{02283     \textcolor{keywordflow}{switch} (state) \{}
\DoxyCodeLine{02284         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991af973d2b8b0a498d0bbffb40ccab1ef2d}{OBSWS\_STATE\_DISCONNECTED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Disconnected"{}};}
\DoxyCodeLine{02285         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991a88276a1a9f595735a2b242f0eab1524a}{OBSWS\_STATE\_CONNECTING}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Connecting"{}};}
\DoxyCodeLine{02286         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991ac9c5d9c3aab50d7e6d1d38b1bb7d6d0f}{OBSWS\_STATE\_AUTHENTICATING}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Authenticating"{}};}
\DoxyCodeLine{02287         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991adbaae08035175b470fb9f543414672b8}{OBSWS\_STATE\_CONNECTED}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Connected"{}};}
\DoxyCodeLine{02288         \textcolor{keywordflow}{case} \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991ae13bce21841139a7510b1c8b10a694ac}{OBSWS\_STATE\_ERROR}}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Error"{}};}
\DoxyCodeLine{02289         \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Unknown"{}};}
\DoxyCodeLine{02290     \}}
\DoxyCodeLine{02291 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a69f8fcc1732533a2ebe573ac65effa04_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a30001811f4cf8501e006ca46bcb8b329}\label{library_8c_a30001811f4cf8501e006ca46bcb8b329}} 
\index{library.c@{library.c}!obsws\_stop\_recording@{obsws\_stop\_recording}}
\index{obsws\_stop\_recording@{obsws\_stop\_recording}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_stop\_recording()}{obsws\_stop\_recording()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+stop\+\_\+recording (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$}]{response }\end{DoxyParamCaption})}



Stop recording in OBS. 

Stop recording.

Tells OBS to stop the currently active recording. If no recording is in progress, OBS returns success anyway (idempotent operation).

This is a convenience wrapper around \mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}} using the OBS \char`\"{}\+Stop\+Record\char`\"{} request type.

{\bfseries{Example usage\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordflow}{if} (\mbox{\hyperlink{library_8h_a30001811f4cf8501e006ca46bcb8b329}{obsws\_stop\_recording}}(conn, NULL) != \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6aa43b9a59f39db094a477cb25a638e5a1}{OBSWS\_OK}}) \{}
\DoxyCodeLine{    fprintf(stderr, \textcolor{stringliteral}{"{}Failed to stop recording\(\backslash\)\(\backslash\)n"{}});}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (must be in CONNECTED state) \\
\hline
{\em response} & Optional output for response. Caller owns if provided, must free.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK if response received (check response-\/\texorpdfstring{$>$}{>}success for success) 

OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED if connection not ready 

OBSWS\+\_\+\+ERROR\+\_\+\+TIMEOUT if OBS doesn\textquotesingle{}t respond
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a8643e2027afb1907122ce4d3bfe65c6e}{obsws\+\_\+start\+\_\+recording}}, \mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request}}, \mbox{\hyperlink{library_8h_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02115}{2115}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02115                                                                                           \{}
\DoxyCodeLine{02116     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(conn, \textcolor{stringliteral}{"{}StopRecord"{}}, NULL, response, 0);}
\DoxyCodeLine{02117 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a30001811f4cf8501e006ca46bcb8b329_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a2cfe9b46f435aa7986b5e772b99c464e}\label{library_8c_a2cfe9b46f435aa7986b5e772b99c464e}} 
\index{library.c@{library.c}!obsws\_stop\_streaming@{obsws\_stop\_streaming}}
\index{obsws\_stop\_streaming@{obsws\_stop\_streaming}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_stop\_streaming()}{obsws\_stop\_streaming()}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a4820ea98988736a81d6695a51f74acd6}{obsws\+\_\+error\+\_\+t}} obsws\+\_\+stop\+\_\+streaming (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{structobsws__response__t}{obsws\+\_\+response\+\_\+t}} $\ast$$\ast$}]{response }\end{DoxyParamCaption})}



Stop streaming in OBS. 

Stop streaming.

Tells OBS to stop the active stream. If not currently streaming, OBS returns success anyway (idempotent operation).

This is a convenience wrapper around \mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request()}} using the OBS \char`\"{}\+Stop\+Stream\char`\"{} request type.


\begin{DoxyParams}{Parameters}
{\em conn} & Connection object (must be in CONNECTED state) \\
\hline
{\em response} & Optional output for response. Caller owns if provided, must free.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
OBSWS\+\_\+\+OK if response received (check response-\/\texorpdfstring{$>$}{>}success for success) 

OBSWS\+\_\+\+ERROR\+\_\+\+NOT\+\_\+\+CONNECTED if connection not ready 

OBSWS\+\_\+\+ERROR\+\_\+\+TIMEOUT if OBS doesn\textquotesingle{}t respond
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{library_8h_a86a35ee2d7aef7a0569b4111bd663d22}{obsws\+\_\+start\+\_\+streaming}}, \mbox{\hyperlink{library_8h_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\+\_\+send\+\_\+request}}, \mbox{\hyperlink{library_8h_a53067e61dc0ddcf1134d46b275d7ce6b}{obsws\+\_\+response\+\_\+free}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{library_8c_source_l02161}{2161}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02161                                                                                           \{}
\DoxyCodeLine{02162     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8c_af2fd7f8dd928e03b38a3e2c5b5745417}{obsws\_send\_request}}(conn, \textcolor{stringliteral}{"{}StopStream"{}}, NULL, response, 0);}
\DoxyCodeLine{02163 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a2cfe9b46f435aa7986b5e772b99c464e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_af3afc203f99395c187faf3fba0477bf9}\label{library_8c_af3afc203f99395c187faf3fba0477bf9}} 
\index{library.c@{library.c}!obsws\_version@{obsws\_version}}
\index{obsws\_version@{obsws\_version}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{obsws\_version()}{obsws\_version()}}
{\footnotesize\ttfamily const char $\ast$ obsws\+\_\+version (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Get the library version string. 

Returns a semantic version string like \char`\"{}1.\+0.\+0\char`\"{} that identifies which version of libwsv5 is being used. Useful for debugging and logging.

\begin{DoxyReturn}{Returns}
Pointer to static version string (don\textquotesingle{}t free) 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{library_8c_source_l01259}{1259}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01259                                 \{}
\DoxyCodeLine{01260     \textcolor{keywordflow}{return} \mbox{\hyperlink{library_8c_ad27c3919151c76f6e69c502c7ece4065}{OBSWS\_VERSION}};}
\DoxyCodeLine{01261 \}}

\end{DoxyCode}
\mbox{\Hypertarget{library_8c_a700c8a9baa87a3827b399776e811f328}\label{library_8c_a700c8a9baa87a3827b399776e811f328}} 
\index{library.c@{library.c}!remove\_pending\_request@{remove\_pending\_request}}
\index{remove\_pending\_request@{remove\_pending\_request}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{remove\_pending\_request()}{remove\_pending\_request()}}
{\footnotesize\ttfamily static void remove\+\_\+pending\+\_\+request (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{library_8c_ac1fd81bac0d2473d54e2c9a03e393453}{pending\+\_\+request\+\_\+t}} $\ast$}]{target }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00549}{549}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00549                                                                                         \{}
\DoxyCodeLine{00550     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00551     \mbox{\hyperlink{structpending__request}{pending\_request\_t}} **req = \&conn-\/>\mbox{\hyperlink{structobsws__connection_acc0664cafa773ffe211ffe993c6ac8af}{pending\_requests}};}
\DoxyCodeLine{00552     }
\DoxyCodeLine{00553     \textcolor{comment}{/* Find and remove from linked list */}}
\DoxyCodeLine{00554     \textcolor{keywordflow}{while} (*req) \{}
\DoxyCodeLine{00555         \textcolor{keywordflow}{if} (*req == target) \{}
\DoxyCodeLine{00556             *req = target-\/>\mbox{\hyperlink{structpending__request_a49161e43ef29129c11fe643e85338df2}{next}};}
\DoxyCodeLine{00557             pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00558             }
\DoxyCodeLine{00559             \textcolor{comment}{/* Clean up request resources */}}
\DoxyCodeLine{00560             pthread\_mutex\_destroy(\&target-\/>\mbox{\hyperlink{structpending__request_a30b4636ccd06e4f775ee0dcc29ba3a69}{mutex}});}
\DoxyCodeLine{00561             pthread\_cond\_destroy(\&target-\/>\mbox{\hyperlink{structpending__request_a619500d05293ec1f654ea803139941de}{cond}});}
\DoxyCodeLine{00562             free(target);}
\DoxyCodeLine{00563             \textcolor{keywordflow}{return};}
\DoxyCodeLine{00564         \}}
\DoxyCodeLine{00565         req = \&(*req)-\/>\mbox{\hyperlink{structpending__request_a49161e43ef29129c11fe643e85338df2}{next}};}
\DoxyCodeLine{00566     \}}
\DoxyCodeLine{00567     }
\DoxyCodeLine{00568     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_a5be49ce76c72f09948fdf9c520eb133c}{requests\_mutex}});}
\DoxyCodeLine{00569 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a700c8a9baa87a3827b399776e811f328_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_a2f13308e49322d01e479cbe14da7b575}\label{library_8c_a2f13308e49322d01e479cbe14da7b575}} 
\index{library.c@{library.c}!set\_connection\_state@{set\_connection\_state}}
\index{set\_connection\_state@{set\_connection\_state}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{set\_connection\_state()}{set\_connection\_state()}}
{\footnotesize\ttfamily static void set\+\_\+connection\+\_\+state (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{library_8h_a81ecb6b2403c8155af2e4edb4716c141}{obsws\+\_\+connection\+\_\+t}} $\ast$}]{conn,  }\item[{\mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\+\_\+state\+\_\+t}}}]{new\+\_\+state }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00477}{477}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00477                                                                                     \{}
\DoxyCodeLine{00478     \textcolor{comment}{/* Acquire lock, save old state, set new state, release lock */}}
\DoxyCodeLine{00479     pthread\_mutex\_lock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{00480     \mbox{\hyperlink{library_8h_a2fb4e7d7196f39a5ce0e9c71b2d78991}{obsws\_state\_t}} old\_state = conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}};}
\DoxyCodeLine{00481     conn-\/>\mbox{\hyperlink{structobsws__connection_adad7d0fb4880543b1f5b5e897010d814}{state}} = new\_state;}
\DoxyCodeLine{00482     pthread\_mutex\_unlock(\&conn-\/>\mbox{\hyperlink{structobsws__connection_aa2752abaf5b201277fae73b42c78c8e6}{state\_mutex}});}
\DoxyCodeLine{00483     }
\DoxyCodeLine{00484     \textcolor{comment}{/* Call callback only if state actually changed (not a duplicate) */}}
\DoxyCodeLine{00485     \textcolor{keywordflow}{if} (old\_state != new\_state \&\& conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a580a2daf514e79022b6d488c4933845e}{state\_callback}}) \{}
\DoxyCodeLine{00486         conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_a580a2daf514e79022b6d488c4933845e}{state\_callback}}(conn, old\_state, new\_state, conn-\/>\mbox{\hyperlink{structobsws__connection_aaa5cf000b991e623632977c379314d89}{config}}.\mbox{\hyperlink{structobsws__config__t_af272f38a8f4ca535939766cebacf0b8f}{user\_data}});}
\DoxyCodeLine{00487     \}}
\DoxyCodeLine{00488     }
\DoxyCodeLine{00489     \textcolor{comment}{/* Log the transition for debugging/monitoring */}}
\DoxyCodeLine{00490     \mbox{\hyperlink{library_8c_a1d8529feb33753ebb45d896c4c125642}{obsws\_log}}(conn, \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\_LOG\_INFO}}, \textcolor{stringliteral}{"{}State changed: \%s -\/> \%s"{}}, }
\DoxyCodeLine{00491               \mbox{\hyperlink{library_8c_a69f8fcc1732533a2ebe573ac65effa04}{obsws\_state\_string}}(old\_state), \mbox{\hyperlink{library_8c_a69f8fcc1732533a2ebe573ac65effa04}{obsws\_state\_string}}(new\_state));}
\DoxyCodeLine{00492 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{d5/d27/library_8c_a2f13308e49322d01e479cbe14da7b575_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_a2f13308e49322d01e479cbe14da7b575_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{library_8c_aaaa872a3d93d0ce3d5d4346f4b1c763e}\label{library_8c_aaaa872a3d93d0ce3d5d4346f4b1c763e}} 
\index{library.c@{library.c}!sha256\_hash@{sha256\_hash}}
\index{sha256\_hash@{sha256\_hash}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{sha256\_hash()}{sha256\_hash()}}
{\footnotesize\ttfamily static void sha256\+\_\+hash (\begin{DoxyParamCaption}\item[{const char $\ast$}]{input,  }\item[{unsigned char $\ast$}]{output }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00411}{411}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00411                                                                   \{}
\DoxyCodeLine{00412     EVP\_MD\_CTX *ctx = EVP\_MD\_CTX\_new();}
\DoxyCodeLine{00413     EVP\_DigestInit\_ex(ctx, EVP\_sha256(), NULL);}
\DoxyCodeLine{00414     EVP\_DigestUpdate(ctx, input, strlen(input));}
\DoxyCodeLine{00415     EVP\_DigestFinal\_ex(ctx, output, NULL);}
\DoxyCodeLine{00416     EVP\_MD\_CTX\_free(ctx);}
\DoxyCodeLine{00417 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d27/library_8c_aaaa872a3d93d0ce3d5d4346f4b1c763e_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{library_8c_abf3a9f2c8c4082f1e6b67daddd8a5931}\label{library_8c_abf3a9f2c8c4082f1e6b67daddd8a5931}} 
\index{library.c@{library.c}!g\_debug\_level@{g\_debug\_level}}
\index{g\_debug\_level@{g\_debug\_level}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{g\_debug\_level}{g\_debug\_level}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668}{obsws\+\_\+debug\+\_\+level\+\_\+t}} g\+\_\+debug\+\_\+level = \mbox{\hyperlink{library_8h_a1997a985daa6bfb4117e885d9bb81668a0f96dd454f8efb9a755ebda2e81919aa}{OBSWS\+\_\+\+DEBUG\+\_\+\+NONE}}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00253}{253}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_ad5f633670e2eea3285c1867570a33cbc}\label{library_8c_ad5f633670e2eea3285c1867570a33cbc}} 
\index{library.c@{library.c}!g\_init\_mutex@{g\_init\_mutex}}
\index{g\_init\_mutex@{g\_init\_mutex}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{g\_init\_mutex}{g\_init\_mutex}}
{\footnotesize\ttfamily pthread\+\_\+mutex\+\_\+t g\+\_\+init\+\_\+mutex = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00254}{254}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}\label{library_8c_a5c573cf80a65ed908b966420c4a5d7d2}} 
\index{library.c@{library.c}!g\_library\_initialized@{g\_library\_initialized}}
\index{g\_library\_initialized@{g\_library\_initialized}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{g\_library\_initialized}{g\_library\_initialized}}
{\footnotesize\ttfamily bool g\+\_\+library\+\_\+initialized = false\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00251}{251}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_abaccf3944be55af2f72ebbb713c77706}\label{library_8c_abaccf3944be55af2f72ebbb713c77706}} 
\index{library.c@{library.c}!g\_log\_level@{g\_log\_level}}
\index{g\_log\_level@{g\_log\_level}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{g\_log\_level}{g\_log\_level}}
{\footnotesize\ttfamily \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9}{obsws\+\_\+log\+\_\+level\+\_\+t}} g\+\_\+log\+\_\+level = \mbox{\hyperlink{library_8h_afbee3b6b991e705309ea19fd5fb0bff9ae48017bf78390a3df8cd87a24782c421}{OBSWS\+\_\+\+LOG\+\_\+\+INFO}}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{library_8c_source_l00252}{252}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

\mbox{\Hypertarget{library_8c_ad34f3c7a416fe0d9311efdc5715410e1}\label{library_8c_ad34f3c7a416fe0d9311efdc5715410e1}} 
\index{library.c@{library.c}!protocols@{protocols}}
\index{protocols@{protocols}!library.c@{library.c}}
\doxysubsubsection{\texorpdfstring{protocols}{protocols}}
{\footnotesize\ttfamily const struct lws\+\_\+protocols protocols\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \textcolor{stringliteral}{"{}obs-\/websocket"{}},}
\DoxyCodeLine{        \mbox{\hyperlink{library_8c_ac5c31c457dc3042f85a620d7998ebeee}{lws\_callback}},}
\DoxyCodeLine{        0,}
\DoxyCodeLine{        \mbox{\hyperlink{library_8c_a665c5272405e81329a26d2db1a7d5d97}{OBSWS\_DEFAULT\_BUFFER\_SIZE}},}
\DoxyCodeLine{        0, }
\DoxyCodeLine{        NULL, }
\DoxyCodeLine{        0 }
\DoxyCodeLine{    \},}
\DoxyCodeLine{    \{ NULL, NULL, 0, 0, 0, NULL, 0 \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{library_8c_source_l01075}{1075}} of file \mbox{\hyperlink{library_8c_source}{library.\+c}}.

